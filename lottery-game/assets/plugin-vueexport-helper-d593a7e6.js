import{c as z,E as X,U as ae,V as j,W as se,r as S,X as q,Y as ie,Z as J,y as le,q as ce,_ as ue,$ as L,P as fe,a0 as pe}from"./index-466d9322.js";function Q(e){var t;const r=j(e);return(t=r==null?void 0:r.$el)!=null?t:r}const ne=se?window:void 0;function de(){const e=S(!1);return le()&&ce(()=>{e.value=!0}),e}function he(e){const t=de();return z(()=>(t.value,!!e()))}var ee=Object.getOwnPropertySymbols,ve=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable,be=(e,t)=>{var r={};for(var a in e)ve.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&ee)for(var a of ee(e))t.indexOf(a)<0&&ye.call(e,a)&&(r[a]=e[a]);return r};function ge(e,t,r={}){const a=r,{window:c=ne}=a,s=be(a,["window"]);let n;const b=he(()=>c&&"ResizeObserver"in c),f=()=>{n&&(n.disconnect(),n=void 0)},d=z(()=>Array.isArray(e)?e.map(_=>Q(_)):[Q(e)]),m=X(d,_=>{if(f(),b.value&&c){n=new ResizeObserver(t);for(const w of _)w&&n.observe(w,s)}},{immediate:!0,flush:"post",deep:!0}),h=()=>{f(),m()};return ae(h),{isSupported:b,stop:h}}var me=Object.defineProperty,Oe=Object.defineProperties,Fe=Object.getOwnPropertyDescriptors,te=Object.getOwnPropertySymbols,_e=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable,re=(e,t,r)=>t in e?me(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,o=(e,t)=>{for(var r in t||(t={}))_e.call(t,r)&&re(e,r,t[r]);if(te)for(var r of te(t))we.call(t,r)&&re(e,r,t[r]);return e},y=(e,t)=>Oe(e,Fe(t));const Pe={json:"application/json",text:"text/plain"};function M(e){return e&&ue(e,"immediate","refetch","initialData","timeout","beforeFetch","afterFetch","onFetchError","fetch")}function Ee(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function A(e){return typeof Headers<"u"&&e instanceof Headers?Object.fromEntries([...e.entries()]):e}function E(e,...t){return e==="overwrite"?async r=>{const a=t[t.length-1];return a?o(o({},r),await a(r)):r}:async r=>{for(const a of t)a&&(r=o(o({},r),await a(r)));return r}}function De(e={}){const t=e.combination||"chain",r=e.options||{},a=e.fetchOptions||{};function c(s,...n){const b=z(()=>{const m=j(e.baseUrl),h=j(s);return m&&!Ee(h)?$e(m,h):h});let f=r,d=a;return n.length>0&&(M(n[0])?f=y(o(o({},f),n[0]),{beforeFetch:E(t,r.beforeFetch,n[0].beforeFetch),afterFetch:E(t,r.afterFetch,n[0].afterFetch),onFetchError:E(t,r.onFetchError,n[0].onFetchError)}):d=y(o(o({},d),n[0]),{headers:o(o({},A(d.headers)||{}),A(n[0].headers)||{})})),n.length>1&&M(n[1])&&(f=y(o(o({},f),n[1]),{beforeFetch:E(t,r.beforeFetch,n[1].beforeFetch),afterFetch:E(t,r.afterFetch,n[1].afterFetch),onFetchError:E(t,r.onFetchError,n[1].onFetchError)})),je(b,d,f)}return c}function je(e,...t){var r;const a=typeof AbortController=="function";let c={},s={immediate:!0,refetch:!1,timeout:0};const n={method:"GET",type:"text",payload:void 0};t.length>0&&(M(t[0])?s=o(o({},s),t[0]):c=t[0]),t.length>1&&M(t[1])&&(s=o(o({},s),t[1]));const{fetch:b=(r=ne)==null?void 0:r.fetch,initialData:f,timeout:d}=s,m=L(),h=L(),_=L(),w=S(!1),$=S(!1),H=S(!1),W=S(null),B=q(null),N=q(null),V=q(f||null),oe=z(()=>a&&$.value);let T,g;const k=()=>{a&&(T==null||T.abort(),T=new AbortController,T.signal.onabort=()=>H.value=!0,c=y(o({},c),{signal:T.signal}))},G=i=>{$.value=i,w.value=!i};d&&(g=ie(k,d,{immediate:!1}));const C=async(i=!1)=>{var p;k(),G(!0),N.value=null,W.value=null,H.value=!1;const u={method:n.method,headers:{}};if(n.payload){const x=A(u.headers);n.payloadType&&(x["Content-Type"]=(p=Pe[n.payloadType])!=null?p:n.payloadType);const I=j(n.payload);u.body=n.payloadType==="json"?JSON.stringify(I):I}let P=!1;const v={url:j(e),options:o(o({},u),c),cancel:()=>{P=!0}};if(s.beforeFetch&&Object.assign(v,await s.beforeFetch(v)),P||!b)return G(!1),Promise.resolve(null);let F=null;return g&&g.start(),new Promise((x,I)=>{var Z;b(v.url,y(o(o({},u),v.options),{headers:o(o({},A(u.headers)),A((Z=v.options)==null?void 0:Z.headers))})).then(async l=>{if(B.value=l,W.value=l.status,F=await l[n.type](),!l.ok)throw V.value=f||null,new Error(l.statusText);return s.afterFetch&&({data:F}=await s.afterFetch({data:F,response:l})),V.value=F,m.trigger(l),x(l)}).catch(async l=>{let K=l.message||l.name;return s.onFetchError&&({error:K}=await s.onFetchError({data:F,error:l,response:B.value})),N.value=K,h.trigger(l),i?I(l):x(null)}).finally(()=>{G(!1),g&&g.stop(),_.trigger(null)})})},Y=J(s.refetch);X([Y,J(e)],([i])=>i&&C(),{deep:!0});const U={isFinished:w,statusCode:W,response:B,error:N,data:V,isFetching:$,canAbort:oe,aborted:H,abort:k,execute:C,onFetchResponse:m.on,onFetchError:h.on,onFetchFinally:_.on,get:O("GET"),put:O("PUT"),post:O("POST"),delete:O("DELETE"),patch:O("PATCH"),head:O("HEAD"),options:O("OPTIONS"),json:D("json"),text:D("text"),blob:D("blob"),arrayBuffer:D("arrayBuffer"),formData:D("formData")};function O(i){return(p,u)=>{if(!$.value){n.method=i,n.payload=p,n.payloadType=u,fe(n.payload)&&X([Y,J(n.payload)],([v])=>v&&C(),{deep:!0});const P=j(n.payload);return!u&&P&&Object.getPrototypeOf(P)===Object.prototype&&!(P instanceof FormData)&&(n.payloadType="json"),y(o({},U),{then(v,F){return R().then(v,F)}})}}}function R(){return new Promise((i,p)=>{pe(w).toBe(!0).then(()=>i(U)).catch(u=>p(u))})}function D(i){return()=>{if(!$.value)return n.type=i,y(o({},U),{then(p,u){return R().then(p,u)}})}}return s.immediate&&Promise.resolve().then(()=>C()),y(o({},U),{then(i,p){return R().then(i,p)}})}function $e(e,t){return!e.endsWith("/")&&!t.startsWith("/")?`${e}/${t}`:`${e}${t}`}const Se=(e,t)=>{const r=e.__vccOpts||e;for(const[a,c]of t)r[a]=c;return r};export{Se as _,De as c,ge as u};
