import{H as ce,z as O,m as j,r as m,s as H,v as ie,d as E,c as d,T as U,D as X,E as F,y as re,A as ue,g as V,B as de,C as fe,I as ve,F as me,G as D,J as ye,K as he,x as Ce}from"./index-4e7ac486.js";import{M as ke,N as we,e as g,n as p,t as S,J as A,o as Oe,O as ge,p as G,c as _,f as J,d as Ie,C as N,w as R,m as P,P as be,Q as Se,I as Z,K as Pe,R as pe,L as xe,i as Te,S as ze}from"./index-138f1f56.js";function Be(e,{args:t=[],done:o,canceled:a}){if(e){const n=e.apply(null,t);ke(n)?n.then(l=>{l?o():a&&a()}).catch(we):n?o():a&&a()}else o()}const q=Symbol();function at(e){const t=ce(q,null);t&&O(t,o=>{o&&e()})}function Q(e){const t=j();t&&g(t.proxy,e)}const Ae={show:Boolean,zIndex:p,overlay:S,duration:p,teleport:[String,Object],lockScroll:S,lazyRender:S,beforeClose:Function,overlayStyle:Object,overlayClass:A,transitionAppear:Boolean,closeOnClickOverlay:S};function Le(e,t){return e>t?"horizontal":t>e?"vertical":""}function Ee(){const e=m(0),t=m(0),o=m(0),a=m(0),n=m(0),l=m(0),s=m(""),u=()=>s.value==="vertical",h=()=>s.value==="horizontal",f=()=>{o.value=0,a.value=0,n.value=0,l.value=0,s.value=""};return{move:c=>{const v=c.touches[0];o.value=(v.clientX<0?0:v.clientX)-e.value,a.value=v.clientY-t.value,n.value=Math.abs(o.value),l.value=Math.abs(a.value);const C=10;(!s.value||n.value<C&&l.value<C)&&(s.value=Le(n.value,l.value))},start:c=>{f(),e.value=c.touches[0].clientX,t.value=c.touches[0].clientY},reset:f,startX:e,startY:t,deltaX:o,deltaY:a,offsetX:n,offsetY:l,direction:s,isVertical:u,isHorizontal:h}}let x=0;const $="van-overflow-hidden";function De(e,t){const o=Ee(),a="01",n="10",l=y=>{o.move(y);const i=o.deltaY.value>0?n:a,c=ge(y.target,e.value),{scrollHeight:v,offsetHeight:C,scrollTop:I}=c;let w="11";I===0?w=C>=v?"00":"01":I+C>=v&&(w="10"),w!=="11"&&o.isVertical()&&!(parseInt(w,2)&parseInt(i,2))&&G(y,!0)},s=()=>{document.addEventListener("touchstart",o.start),document.addEventListener("touchmove",l,{passive:!1}),x||document.body.classList.add($),x++},u=()=>{x&&(document.removeEventListener("touchstart",o.start),document.removeEventListener("touchmove",l),x--,x||document.body.classList.remove($))},h=()=>t()&&s(),f=()=>t()&&u();Oe(h),H(f),ie(f),O(t,y=>{y?s():u()})}function W(e){const t=m(!1);return O(e,o=>{o&&(t.value=o)},{immediate:!0}),o=>()=>t.value?o():null}const[_e,Ne]=_("overlay"),Re={show:Boolean,zIndex:p,duration:p,className:A,lockScroll:S,lazyRender:S,customStyle:Object};var Me=E({name:_e,props:Re,setup(e,{slots:t}){const o=m(),a=W(()=>e.show||!e.lazyRender),n=s=>{e.lockScroll&&G(s,!0)},l=a(()=>{var s;const u=g(Ie(e.zIndex),e.customStyle);return N(e.duration)&&(u.animationDuration=`${e.duration}s`),X(d("div",{ref:o,style:u,class:[Ne(),e.className]},[(s=t.default)==null?void 0:s.call(t)]),[[F,e.show]])});return J("touchmove",n,{target:o}),()=>d(U,{name:"van-fade",appear:!0},{default:l})}});const $e=R(Me),Ke=g({},Ae,{round:Boolean,position:P("center"),closeIcon:P("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:P("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[Ye,K]=_("popup");var je=E({name:Ye,inheritAttrs:!1,props:Ke,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:o,slots:a}){let n,l;const s=m(),u=m(),h=W(()=>e.show||!e.lazyRender),f=re(()=>{const r={zIndex:s.value};if(N(e.duration)){const k=e.position==="center"?"animationDuration":"transitionDuration";r[k]=`${e.duration}s`}return r}),y=()=>{n||(n=!0,s.value=e.zIndex!==void 0?+e.zIndex:be(),t("open"))},i=()=>{n&&Be(e.beforeClose,{done(){n=!1,t("close"),t("update:show",!1)}})},c=r=>{t("clickOverlay",r),e.closeOnClickOverlay&&i()},v=()=>{if(e.overlay)return d($e,{show:e.show,class:e.overlayClass,zIndex:s.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0,onClick:c},{default:a["overlay-content"]})},C=r=>{t("clickCloseIcon",r),i()},I=()=>{if(e.closeable)return d(Z,{role:"button",tabindex:0,name:e.closeIcon,class:[K("close-icon",e.closeIconPosition),Se],classPrefix:e.iconPrefix,onClick:C},null)},w=()=>t("opened"),ne=()=>t("closed"),ae=r=>t("keydown",r),se=h(()=>{var r;const{round:k,position:z,safeAreaInsetTop:L,safeAreaInsetBottom:le}=e;return X(d("div",D({ref:u,style:f.value,role:"dialog",tabindex:0,class:[K({round:k,[z]:z}),{"van-safe-area-top":L,"van-safe-area-bottom":le}],onKeydown:ae},o),[(r=a.default)==null?void 0:r.call(a),I()]),[[F,e.show]])}),M=()=>{const{position:r,transition:k,transitionAppear:z}=e,L=r==="center"?"van-fade":`van-popup-slide-${r}`;return d(U,{name:k||L,appear:z,onAfterEnter:w,onAfterLeave:ne},{default:se})};return O(()=>e.show,r=>{r&&!n&&(y(),o.tabindex===0&&ue(()=>{var k;(k=u.value)==null||k.focus()})),!r&&n&&(n=!1,t("close"))}),Q({popupRef:u}),De(u,()=>e.show&&e.lockScroll),J("popstate",()=>{e.closeOnPopstate&&(i(),l=!1)}),V(()=>{e.show&&y()}),de(()=>{l&&(t("update:show",!0),l=!1)}),H(()=>{e.show&&e.teleport&&(i(),l=!0)}),fe(q,()=>e.show),()=>e.teleport?d(ve,{to:e.teleport},{default:()=>[v(),M()]}):d(me,null,[v(),M()])}});const He=R(je);let T=0;function Ue(e){e?(T||document.body.classList.add("van-toast--unclickable"),T++):T&&(T--,T||document.body.classList.remove("van-toast--unclickable"))}const[Xe,b]=_("toast"),Fe=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay"],Ve={icon:String,show:Boolean,type:P("text"),overlay:Boolean,message:p,iconSize:p,duration:pe(2e3),position:P("middle"),teleport:[String,Object],wordBreak:String,className:A,iconPrefix:String,transition:P("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:A,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean};var ee=E({name:Xe,props:Ve,emits:["update:show"],setup(e,{emit:t,slots:o}){let a,n=!1;const l=()=>{const i=e.show&&e.forbidClick;n!==i&&(n=i,Ue(n))},s=i=>t("update:show",i),u=()=>{e.closeOnClick&&s(!1)},h=()=>clearTimeout(a),f=()=>{const{icon:i,type:c,iconSize:v,iconPrefix:C,loadingType:I}=e;if(i||c==="success"||c==="fail")return d(Z,{name:i||c,size:v,class:b("icon"),classPrefix:C},null);if(c==="loading")return d(xe,{class:b("loading"),size:v,type:I},null)},y=()=>{const{type:i,message:c}=e;if(o.message)return d("div",{class:b("text")},[o.message()]);if(N(c)&&c!=="")return i==="html"?d("div",{key:0,class:b("text"),innerHTML:String(c)},null):d("div",{class:b("text")},[c])};return O(()=>[e.show,e.forbidClick],l),O(()=>[e.show,e.type,e.message,e.duration],()=>{h(),e.show&&e.duration>0&&(a=setTimeout(()=>{s(!1)},e.duration))}),V(l),ye(l),()=>d(He,D({class:[b([e.position,e.wordBreak==="normal"?"break-normal":e.wordBreak,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:u,onClosed:h,"onUpdate:show":s},Pe(e,Fe)),{default:()=>[f(),y()]})}});function Ge(){const e=Ce({show:!1}),t=n=>{e.show=n},o=n=>{g(e,n,{transitionAppear:!0}),t(!0)},a=()=>t(!1);return Q({open:o,close:a,toggle:t}),{open:o,close:a,state:e,toggle:t}}function Je(e){const t=he(e),o=document.createElement("div");return document.body.appendChild(o),{instance:t.mount(o),unmount(){t.unmount(),document.body.removeChild(o)}}}const Ze={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let B=[],qe=!1,Y=g({},Ze);const Qe=new Map;function te(e){return ze(e)?e:{message:e}}function We(){const{instance:e,unmount:t}=Je({setup(){const o=m(""),{open:a,state:n,close:l,toggle:s}=Ge(),u=()=>{},h=()=>d(ee,D(n,{onClosed:u,"onUpdate:show":s}),null);return O(o,f=>{n.message=f}),j().render=h,{open:a,close:l,message:o}}});return e}function et(){if(!B.length||qe){const e=We();B.push(e)}return B[B.length-1]}function tt(e={}){if(!Te)return{};const t=et(),o=te(e);return t.open(g({},Y,Qe.get(o.type||Y.type),o)),t}const oe=e=>t=>tt(g({type:e},te(t))),st=oe("success"),lt=oe("fail");R(ee);function ct(e=1e3){return new Promise(t=>{setTimeout(t,e)})}export{lt as a,ct as b,Q as c,Be as d,tt as e,at as o,st as s,Ee as u};
