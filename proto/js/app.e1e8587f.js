(function(t){function e(e){for(var i,r,c=e[0],s=e[1],u=e[2],d=0,p=[];d<c.length;d++)r=c[d],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&p.push(n[r][0]),n[r]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=s[i]);h&&h(e);while(p.length)p.shift()();return a.push.apply(a,u||[]),o()}function o(){for(var t,e=0;e<a.length;e++){for(var o=a[e],i=!0,c=1;c<o.length;c++){var s=o[c];0!==n[s]&&(i=!1)}i&&(a.splice(e--,1),t=r(r.s=o[0]))}return t}var i={},n={app:0},a=[];function r(e){if(i[e])return i[e].exports;var o=i[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=i,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(o,i,function(e){return t[e]}.bind(null,i));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/proto/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var h=s;a.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d76")},"113d":function(t,e,o){"use strict";var i=o("7eba"),n=o.n(i);n.a},2199:function(t,e,o){"use strict";var i=o("ec8e"),n=o.n(i);n.a},"56d76":function(t,e,o){"use strict";o.r(e);var i={};o.r(i),o.d(i,"rect",(function(){return Ne})),o.d(i,"circle",(function(){return Ue})),o.d(i,"text",(function(){return qe})),o.d(i,"group",(function(){return Ve})),o.d(i,"tempGroup",(function(){return Xe})),o.d(i,"line",(function(){return Ye}));o("81f2"),o("c9ae"),o("fe22"),o("f8b3");var n,a,r,c,s=o("e42f"),u=o("f0ce"),h=(o("7c49"),o("83d7"),o("5515"),o("83ad")),d=o("a016"),p=o.n(d),l=o("30bc"),f=new s["a"],_=p.a.div,m=p.a.a,v={components:{"sketch-picker":l["Sketch"]},data:function(){return{value:"#ffffff",isOpen:!1,left:0,top:0,onChange:function(){}}},methods:{open:function(t,e,o){this.value=t,this.onChange=o,this.left=e.left,this.top=e.top,this.isOpen=!0},close:function(){this.isOpen=!1}},created:function(){var t=this;f.$on("windowMouseDown",(function(){t.close()}))},render:function(t){p.a.h=t;var e=this,o={"class_sp-color-alert":!0,class_card:!0,style_left:this.left-260+"px",style_top:this.top+"px",on_click:function(t){t.stopPropagation()},on_mousedown:function(t){t.stopPropagation()}};this.isOpen||(o=Object(h["a"])({},o,{style_display:"none"}));var i=_(o,_(".card-header",m(".btn btn-clear float-right",{"attrs_aria-label":"Close",on_click:function(t){e.close(),t.stopPropagation()}}),_(".card-title","颜色设置")),_({"class_card-body":!0},p.a.bind("sketch-picker")({props_value:this.value,on_input:function(t){e.onChange(t)}})));return i}},g=function(t,e,o){if(!n){var i=s["a"].extend(v);n=new i,n.$mount(document.createElement("div")),document.body.appendChild(n.$el)}n.open(t,e,o)},b={name:"SpColor",props:{value:String,disabled:{type:Boolean,default:!1}},render:function(t){p.a.h=t;var e=this,o={"class_sp-color":!0,"style_background-color":this.value};return this.disabled||(o=Object(h["a"])({},o,{on_click:function(t){t.stopPropagation();var o=e.$el.getClientRects()[0];g(e.value,{left:o.x,top:o.y},(function(t){e.$emit("change",t)}))}})),_(o)}},y=b,R=y,I=(o("113d"),o("2d70")),k=Object(I["a"])(R,a,r,!1,null,null,null),j=k.exports,x=(o("11bc"),o("963d"),o("7787")),O=p.a.div,w=p.a.li,P=p.a.a,G={name:"SpContextMenu",props:{},data:function(){return{isOpen:!1,actions:[],e:{},height:0}},methods:{open:function(t,e,o){this.isOpen=!0,this.e=t,this.height=e,this.actions=o},close:function(){this.isOpen=!1},_renderDivider:function(){return w(".divider")},_renderItem:function(t){if(!t)return this._renderDivider();var e=t.checkF,o=t.doF,i=t.text,n=t.context,a={};return a=e.call(n)?{on_click:function(){o.call(n)}}:{"class_contextmenu-item-disalbed":!0},w(".menu-item",a,P({attrs_href:"javascript:;"},i))},_renderMain:function(){var t=this,e=this,o=window.innerWidth,i=window.innerHeight,n=180,a=this.height,r=this.e,c=r.clientX,s=r.clientY;c=Math.min(c,o-n-10),s=Math.min(s,i-a-10);var u=this.actions.map((function(e){return t._renderItem(e)})),d={style_left:c+"px",style_top:s+"px",key:"contextmenu",on_mousedown:function(t){t.stopPropagation()},on_click:function(){e.close()}};return this.isOpen||(d=Object(h["a"])({},d,{style_display:"none"})),O.apply(void 0,[".contextmenu menu",d].concat(Object(x["a"])(u)))}},created:function(){var t=this;f.$on("windowMouseDown",(function(){t.close()}))},render:function(t){return p.a.h=t,this._renderMain()}};s["a"].prototype.$contextmenu=function(){var t;if(!c){var e=s["a"].extend(G);c=new e,c.$mount(document.createElement("div")),document.body.appendChild(c.$el)}(t=c).open.apply(t,arguments)};var M,T,L,S,B=G,C=B,D=(o("2199"),Object(I["a"])(C,M,T,!1,null,null,null)),z=D.exports,E=[j,z],A=function(t){E.forEach((function(e){t.component(e.name,e)}))},F={install:A},H=(o("bcd0"),o("d0e5")),W=(o("4b47"),o("628b"),o("eca2"),o("34b9"),o("9b90"),o("481e"),o("c0b6"),o("ef52"),o("e7e4")),$=o("2799"),K=o("878e"),N=o("90a9"),U=o.n(N),V=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(W["a"])(this,t),this._ee=new U.a,this._changeRules=[],this._init(e)}return Object($["a"])(t,[{key:"_init",value:function(t){this.data=this._proxyDeep(t),this._changes=[],this._historys=[],this._cursor=-1,this._historyFlag=!1}},{key:"watch",value:function(t){return this._init(t),this}},{key:"on",value:function(t,e){return this._ee.on(t,e),this}},{key:"emit",value:function(t,e){return this._ee.emit(t,e),this}},{key:"getHistorys",value:function(){return Object(K["cloneDeep"])(this._historys)}},{key:"getChanges",value:function(){return Object(K["cloneDeep"])(this._changes)}},{key:"getCursor",value:function(){return this._cursor}},{key:"changeRule",value:function(t){return this._changeRules.push(t),this}},{key:"_checkAddChange",value:function(t){if(this._historyFlag)return!1;if(t.value===t.oldValue)return!1;var e=!0;return this._changeRules.every((function(o){if(!1===o(t))return e=!1,!1})),e}},{key:"_proxy",value:function(t,e){var o=this;return new Proxy(t,{get:function(t,e){return t[e]},set:function(t,i,n){var a=[].concat(Object(x["a"])(e),[i]),r=t[i],c={object:t,prop:i,value:n,oldValue:r,props:a};return o._checkAddChange(c)&&o._addchange(a.join("."),r,n),t[i]=Object(K["isPlainObject"])(n)?o._proxyDeep(n,a):n,!0}})}},{key:"_proxyDeep",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(Object(K["isPlainObject"])(t)){for(var o in t)Object(K["isPlainObject"])(t[o])&&(t[o]=this._proxyDeep(t[o],[].concat(Object(x["a"])(e),[o])));return this._proxy(t,e)}}},{key:"_addchange",value:function(t,e,o){e=Object(K["cloneDeep"])(e),o=Object(K["cloneDeep"])(o);var i=this._changes.findIndex((function(e){return e.longProp===t})),n=-1!==i;if(n){var a=this._changes[i];a.newValue=o,this._changes.splice(i,1),o!==a.oldValue&&this._changes.push(a)}else this._changes.push({longProp:t,oldValue:e,newValue:o})}},{key:"push",value:function(){if(this._changes.length){this.canGo()&&(this._historys=this._historys.slice(0,this._cursor+1));var t=this._changes;this._historys.push(t),this._changes=[],this._cursor++;var e=this.getChangeObjects(t);return this.emit("history",e),this.emit("push",e),this}}},{key:"back",value:function(){var t=this;if(this.canBack()){var e=this._historys[this._cursor--];Object(K["forEachRight"])(e,(function(e){var o=e.longProp,i=e.oldValue;t._setLongPropValue(o,i)}));var o=this.getChangeObjects(e,"left");return this.emit("history",o),this.emit("back",o),this}}},{key:"go",value:function(){var t=this;if(this.canGo()){var e=this._historys[++this._cursor];Object(K["forEach"])(e,(function(e){var o=e.longProp,i=e.newValue;t._setLongPropValue(o,i)}));var o=this.getChangeObjects(e);return this.emit("history",o),this.emit("go",o),this}}},{key:"canGo",value:function(){return this._cursor<this._historys.length-1}},{key:"canBack",value:function(){return this._cursor>-1}},{key:"_setLongPropValue",value:function(t,e){e=Object(K["cloneDeep"])(e),this._historyFlag=!0;var o=t.split("."),i=o.slice(-1)[0],n=this.data;o.slice(0,-1).forEach((function(t){n=n[t]})),n[i]=e,this._historyFlag=!1}},{key:"getChangeObjects",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"right";t=Object(K["cloneDeep"])(t);var o={},i="right"===e,n=i?K["forEach"]:K["forEachRight"];return n(t,(function(t){var e=t.longProp,n=t.oldValue,a=t.newValue,r=o,c=e.split("."),s=c.slice(-1)[0];c.slice(0,-1).forEach((function(t){t in r||(r[t]={}),r=r[t]})),r[s]=i?a:n})),o}},{key:"toString",value:function(){return JSON.stringify(this.data)}}]),t}(),X=V,q=new X,Y={methods:{_historyPush:function(){q.push()},_historyBack:function(){q.back()},_historyGo:function(){q.go()},_historyCanGo:function(){return q.canGo()},_historyCanBack:function(){return q.canBack()},_historyWatch:function(){var t=this;q.watch(this.$data).changeRule((function(e){var o="objects"===e.props[0];return!!o&&(!["isOpen","tempIndex","tempData","tempGroupId"].includes(e.prop)&&(!t._checkIsTempGroup(e.value)&&(!t._checkIsTempGroup(e.props[1])&&void 0)))})).on("history",(function(e){console.log("history change",e),t._dbSave(e.objects),t._updateCurrRectBySelected(),t.renderHook++}))}}},J=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rects",i=t[o];if(i.headId){if(!i.tailId){t[o]["tailId"]=e.id;var n=this.objects[i.headId],a=this.objects[i.tailId];return n.nextId=a.id,void(a.prevId=n.id)}var r=this.objects[i.tailId];t[o]["tailId"]=e.id,r.nextId=e.id,e.prevId=r.id}else t[o]["headId"]=e.id},Q=function(t,e,o){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rects",n=e.prevId,a=this.objects[n],r=t[i];n?(o.prevId=n,a.nextId=o.id):(t[i].headId=o.id,r.tailId||(t[i].tailId=e.id)),o.nextId=e.id,e.prevId=o.id},Z=function(t,e,o){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rects",n=e.nextId,a=this.objects[n];n?(o.nextId=n,a.prevId=o.id):t[i].tailId=o.id,o.prevId=e.id,e.nextId=o.id},tt=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rects",i=t[o],n=e.prevId,a=e.nextId;if(e.nextId="",e.prevId="",n){var r=this.objects[n];r.nextId=a}else t[o].headId=a;if(a){var c=this.objects[a];c.prevId=n}else t[o].tailId=n;i.tailId===i.headId&&(t[o].tailId="")},et=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rects",i=e.nextId;if(i){var n=this.objects[i];this._linkedListRemove(t,e,o),this._linkedListInsertAfter(t,n,e,o)}},ot=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rects",i=e.prevId;if(i){var n=this.objects[i];this._linkedListRemove(t,e,o),this._linkedListInsertBefore(t,n,e,o)}},it=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rects",i=t[o],n=i.tailId;if(n&&n!==e.id){var a=this.objects[n];this._linkedListRemove(t,e,o),this._linkedListInsertAfter(t,a,e,o)}},nt=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rects",i=t[o],n=i.headId;if(n!==e.id){var a=this.objects[n];this._linkedListRemove(t,e,o),this._linkedListInsertBefore(t,a,e,o)}},at=function(t){var e=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rects",i=arguments.length>2?arguments[2]:void 0,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=function t(a){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=e.objects[a[o].headId];while(c){i(c,r);var s=!1===c.data.isExpand;n&&!s&&c[o]&&c[o]["headId"]&&t(c,r+1),c=e.objects[c.nextId]}};a(t)},rt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rects",o=[],i=0;return this._linkedListWalk(t,e,(function(t){t.tempIndex=i++,o.push(t)})),o},ct=function(t,e){var o=t.id,i=e.parentId;while(i){if(i===o)return!0;i=this.objects[i].parentId}return!1},st={methods:{_linkedListInsertBefore:Q,_linkedListInsertAfter:Z,_linkedListRemove:tt,_linkedListAppend:J,_linkedListGetObjects:rt,_linkedListMoveUp:et,_linkedListMoveDown:ot,_linkedListMoveTop:it,_linkedListMoveBottom:nt,_linkedListWalk:at,_linkedListCheckIsParent:ct}},ut={data:function(){return{windowEventListener:{}}},methods:{windowEventAdd:function(t,e){window.addEventListener(t,e),t in this.windowEventListener||(this.windowEventListener[t]=[]),this.windowEventListener[t].push(e)}},beforeDestroy:function(){var t=this,e=function(e){t.windowEventListener[e].forEach((function(t){window.removeEventListener(e,t)}))};for(var o in this.windowEventListener)e(o)}},ht=(o("b4fc"),o("0b4e"),o("56d7"),o("3191")),dt=o("9e4d"),pt=o.n(dt),lt=o("b875"),ft=o.n(lt),_t={computed:{},methods:{_dbInit:function(){var t=this;return Object(ht["a"])(regeneratorRuntime.mark((function e(){var o,i,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!L){e.next=2;break}return e.abrupt("return");case 2:return o=ft()(),L=o.promise,S=pt.a.createInstance({name:"proto-design",storeName:"object"}),e.next=7,S.ready();case 7:return e.next=9,S.keys();case 9:if(i=e.sent,i.length){e.next=21;break}return console.log("database init"),n=t._createProjectBase(),a=t._createPageBase(n.id),n.pages.headId=a.id,n.currPageId=a.id,e.next=18,t._dbSaveItem(n.id,n);case 18:return e.next=20,t._dbSaveItem(a.id,a);case 20:console.log("database init over");case 21:o.resolve();case 22:case"end":return e.stop()}}),e)})))()},_dbSaveItem:function(t,e){return Object(ht["a"])(regeneratorRuntime.mark((function o(){var i,n;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return e=Object(K["cloneDeep"])(e),o.next=3,S.ready();case 3:if(e){o.next=8;break}return o.next=6,S.removeItem(t);case 6:o.next=18;break;case 8:return o.next=10,S.getItem(t);case 10:if(o.t0=o.sent,o.t0){o.next=13;break}o.t0={};case 13:if(i=o.t0,n=Object(K["merge"])(i,e),!n.type){o.next=18;break}return o.next=18,S.setItem(t,n);case 18:case"end":return o.stop()}}),o)})))()},_dbSave:function(t){var e=this;return Object(ht["a"])(regeneratorRuntime.mark((function o(){var i;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:o.t0=regeneratorRuntime.keys(t);case 1:if((o.t1=o.t0()).done){o.next=7;break}return i=o.t1.value,o.next=5,e._dbSaveItem(i,t[i]);case 5:o.next=1;break;case 7:case"end":return o.stop()}}),o)})))()},_dbAll:function(){var t=this;return Object(ht["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("加载所有数据..."),e.next=3,L;case 3:return e.next=5,S.iterate((function(e,o){t.objects[o]=e,"project"===e.type&&(t.currProjectId=e.id)}));case 5:t.currPageId=t.currProject.currPageId,t._historyWatch(),console.log("加载所有数据完毕");case 8:case"end":return e.stop()}}),e)})))()}},created:function(){this._dbInit(),this._dbAll()},mounted:function(){return Object(ht["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))()}},mt=o("ca5c"),vt=(o("4b08"),o("999e"),o("5c9e"),o("367d")),gt=54,bt=200,yt=16,Rt=200,It={a:gt,b:bt,c:yt,d:Rt},kt=window.getComputedStyle(document.body).font,jt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kt,o=xt.span;if(!o){o=xt.span=document.createElement("div"),o.style.display="inline-block";var i=document.createElement("div");i.style.display="block",i.style.position="absolute",i.style.top="-10000px",i.style.left="200px",i.style.width="100000px",i.appendChild(o),document.body.appendChild(i)}o.style.font=e,o.innerHTML=t;var n=window.getComputedStyle(o);return{width:Math.ceil(parseFloat(n.width)),height:Math.ceil(parseFloat(n.height))}},xt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kt;return jt(t,e).width},Ot=function(t,e){var o=[],i=t.ra,n=t.rb,a=t.rc,r=t.rd;[i,n,a,r].forEach((function(t){var i=St(t,e).xp;o.push(i)}));var c=Math.min.apply(null,o),s=Math.max.apply(null,o);return{start:c,end:s,length:s-c}},wt=function(t,e){var o=!0,i=[t.angle,t.angle+90,e.angle,e.angle+90];return i.some((function(i){var n=Ot(t,i),a=Ot(e,i);if(Math.max(n.end,a.end)-Math.min(n.start,a.start)>n.length+a.length)return o=!1,!0})),o},Pt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,o=Math.pow(10,e);return Math.round(t*o)/o},Gt=function(t){return t*(Math.PI/180)},Mt=function(t){return t/Math.PI*180},Tt=function(t,e,o){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];o=parseInt(o),i||(o=360-o);var n=Gt(o),a=e.left-t.left,r=t.top-e.top,c=Math.cos(n)*a+Math.sin(n)*r,s=Math.cos(n)*r-Math.sin(n)*a;return{left:Pt(c+t.left),top:Pt(t.top-s)}},Lt=function(t,e,o){if(o%180===0)return{left:t.left,top:e.top};var i=Gt(o),n=Gt(90-o),a=t.left+Math.tan(i)*t.top,r=e.left-Math.tan(n)*e.top,c=r+Math.cos(i)*Math.cos(i)*(a-r),s=Math.sin(i)*Math.cos(i)*(a-r);return{left:Pt(c),top:Pt(s)}},St=function(t,e){var o=Gt(e);return{xp:t.left+Math.tan(o)*t.top,yp:t.top-Math.tan(o)*t.left}},Bt=function(t,e){var o,i,n,a,r=Number.MAX_VALUE,c=r,s=-r,u=-c;return t.forEach((function(t){var h=St(t,e),d=h.xp,p=h.yp;d<r&&(r=d,o=t),d>=s&&(s=d,n=t),p<c&&(c=p,i=t),p>=u&&(u=p,a=t)})),{a:o,b:i,a2:n,b2:a}},Ct=function(t,e){var o=Math.abs(Pt(t.left)-Pt(e.left)),i=Math.abs(Pt(e.top)-Pt(t.top)),n=Mt(Math.atan(o/i)),a=t.left,r=t.top,c=e.left,s=e.top;return a>c&&r<=s||(a>=c&&r>s?n=180-n:a<c&&r>=s?n+=180:n=360-n),n%360},Dt=function(t){return t%360},zt=function(){return Object(vt["a"])()},Et=function(t){var e=window.getSelection(),o=document.createRange();o.selectNodeContents(t),e.removeAllRanges(),e.addRange(o)},At=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=t.left,i=t.top,n=t.width,a=t.height,r=t.angle;o*=e,i*=e,n*=e,a*=e;var c=o+n,s=i+a,u={left:Pt(o+n/2),top:Pt(i+a/2)},d={left:o,top:i},p=d,l={left:o,top:s},f=l,_={left:c,top:i},m=_,v={left:c,top:s},g=v,b={left:o,top:u.top},y={left:o+n,top:u.top},R=Tt(u,d,r),I=R,k=Tt(u,l,r),j=k,x=Tt(u,_,r),O=x,w=Tt(u,v,r),P=w,G=Tt(u,b,r),M=Tt(u,y,r),T=[I.left,O.left,P.left,j.left],L=[I.top,O.top,P.top,j.top],S=Math.min.apply(null,T),B=Math.max.apply(null,T),C=Math.min.apply(null,L),D=Math.max.apply(null,L);return Object(h["a"])({},t,{center:u,leftTop:d,leftBottom:l,rightTop:_,rightBottom:v,rotateRightTop:x,rotateLeftTop:R,rotateLeftBottom:k,rotateRightBottom:w,a:p,b:m,c:g,d:f,ra:I,rb:O,rc:P,rd:j,rad:G,rbc:M,right:c,bottom:s,left:o,top:i,width:n,height:a,minRotateLeft:S,maxRotateLeft:B,minRotateTop:C,maxRotateTop:D})},Ft=function(t,e){var o=[];t.forEach((function(t){var e=At(t.data);o=[].concat(Object(x["a"])(o),[e.rotateLeftTop,e.rotateRightTop,e.rotateLeftBottom,e.rotateRightBottom])}));var i=Bt(o,e),n=Lt(i.a,i.b,e),a=Lt(i.a2,i.b2,e),r={left:n.left+(a.left-n.left)/2,top:a.top-(a.top-n.top)/2},c=Tt(r,e>90&&e<=270?a:n,e,!1),s=2*Math.abs(r.left-c.left),u=2*Math.abs(r.top-c.top);return{left:Pt(c.left),top:Pt(c.top),width:Pt(s),height:Pt(u)}},Ht=function(t,e,o){return{left:(e.left-t.left)*o+t.left,top:(e.top-t.top)*o+t.top}},Wt=function(t,e){return{left:Pt(t.left+(e.left-t.left)/2),top:Pt(t.top+(e.top-t.top)/2)}},$t=function(t,e){return{width:2*Math.abs(e.left-t.left),height:2*Math.abs(e.top-t.top)}},Kt=It.b+It.c,Nt=It.a+It.c,Ut=function(t){return t+="",t.includes("%")||(t+="px"),t},Vt=function(t){return 3===t.which},Xt=function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return JSON.stringify(e)};["min","max","cos","sin","tan","atan","abs","ceil","pow","round"].forEach((function(t){Math[t]=Object(K["memoize"])(Math[t],Xt)})),jt=Object(K["memoize"])(jt,Xt),Ot=Object(K["memoize"])(Ot,Xt),wt=Object(K["memoize"])(wt,Xt),Pt=Object(K["memoize"])(Pt,Xt),Gt=Object(K["memoize"])(Gt,Xt),Mt=Object(K["memoize"])(Mt,Xt),Tt=Object(K["memoize"])(Tt,Xt),Lt=Object(K["memoize"])(Lt,Xt),St=Object(K["memoize"])(St,Xt),Bt=Object(K["memoize"])(Bt,Xt),Ct=Object(K["memoize"])(Ct,Xt),Dt=Object(K["memoize"])(Dt,Xt),At=Object(K["memoize"])(At,Xt),Ft=Object(K["memoize"])(Ft,Xt),Ht=Object(K["memoize"])(Ht,Xt),Wt=Object(K["memoize"])(Wt,Xt),$t=Object(K["memoize"])($t,Xt),Ut=Object(K["memoize"])(Ut,Xt);var qt,Yt,Jt=10,Qt=function(t,e){return t/e},Zt=function(t){var e=t.data,o=t.tempData,i=o.angle,n=Gt(i),a=o.width,r=o.height;return{data:e,tempInfo:o,angle:i,radian:n,tempWidth:a,tempHeight:r}},te=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Zt(t),n=i.tempInfo,a=i.angle,r=i.tempWidth,c=i.radian,s=-Math.cos(c)*e-Math.sin(c)*o,u=Math.max(s+r,Jt),h=Qt(u,r),d=n.rotateLeftTop,p=n.rotateRightBottom,l=Ht(p,d,h),f=Wt(l,p),_=Tt(f,l,a,!1),m=$t(_,f);return{size:{left:_.left,top:_.top,width:m.width,height:m.height},scale:h,fixedPoint:p}},ee=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Zt(t),n=i.tempInfo,a=i.angle,r=i.tempWidth,c=i.radian,s=Math.cos(c)*e+Math.sin(c)*o,u=Math.max(s+r,Jt),h=Qt(u,r),d=n.rotateRightTop,p=n.rotateLeftBottom,l=Ht(p,d,h),f=Wt(p,l),_=Tt(f,l,a,!1),m=$t(_,f),v={left:_.left-m.width,top:_.top};return{size:{left:v.left,top:v.top,width:m.width,height:m.height},scale:h,fixedPoint:p}},oe=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Zt(t),n=i.tempInfo,a=i.angle,r=i.tempWidth,c=i.radian,s=Math.cos(c)*e+Math.sin(c)*o,u=Math.max(s+r,Jt),h=Qt(u,r),d=n.rotateLeftTop,p=n.rotateRightBottom,l=Ht(d,p,h),f=Wt(d,l),_=Tt(f,d,a,!1),m=$t(_,f);return{size:{left:_.left,top:_.top,width:m.width,height:m.height},scale:h,fixedPoint:d}},ie=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Zt(t),n=i.tempInfo,a=i.angle,r=i.tempWidth,c=i.radian,s=-Math.cos(c)*e-Math.sin(c)*o,u=Math.max(s+r,Jt),h=Qt(u,r),d=n.rotateRightTop,p=n.rotateLeftBottom,l=Ht(d,p,h),f=Wt(d,l),_=Tt(f,d,a,!1),m=$t(_,f),v={left:_.left-m.width,top:_.top};return{size:{left:v.left,top:v.top,width:m.width,height:m.height},scale:h,fixedPoint:d}},ne=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Zt(t),n=i.tempInfo,a=i.angle,r=i.tempWidth,c=i.tempHeight,s=i.radian,u=n.rotateRightBottom,h=-Math.cos(s)*e-Math.sin(s)*o,d=Math.sin(s)*e-Math.cos(s)*o,p=Math.max(h+r,Jt),l=Math.max(d+c,Jt),f={left:0,top:0};f=0===a?{left:u.left-p,top:u.top-l}:90===a?{left:u.left+l,top:u.top-p}:180===a?{left:u.left+p,top:u.top+l}:270===a?{left:u.left-l,top:u.top+p}:{left:u.left-Math.cos(s)*(p-Math.tan(s)*l),top:u.top-(l/Math.cos(s)+Math.sin(s)*(p-Math.tan(s)*l))};var _=Wt(f,u),m=Tt(_,f,a,!1);return{size:{left:m.left,top:m.top,width:p,height:l},fixedPoint:u}},ae=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Zt(t),n=i.tempInfo,a=i.angle,r=i.tempHeight,c=i.radian,s=Math.sin(c)*e-Math.cos(c)*o,u=Math.max(r+s,Jt);s=u-r;var h=n.rotateLeftTop,d=n.rotateRightBottom,p={left:h.left+Math.sin(c)*s,top:h.top-Math.cos(c)*s},l=Wt(p,d),f=Tt(l,p,a,!1);return{size:{left:f.left,top:f.top,height:u},fixedPoint:d,scaleH:u/r}},re=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Zt(t),n=i.tempInfo,a=i.angle,r=i.tempWidth,c=i.tempHeight,s=i.radian,u=n.rotateLeftBottom,h=Math.cos(s)*e+Math.sin(s)*o,d=Math.sin(s)*e-Math.cos(s)*o,p=Math.max(h+r,Jt),l=Math.max(d+c,Jt),f={left:0,top:0};f=0===a?{left:u.left+p,top:u.top-l}:90===a?{left:u.left+l,top:u.top+p}:180===a?{left:u.left-p,top:u.top+l}:270===a?{left:u.left-l,top:u.top-p}:{left:u.left+p/Math.cos(s)+Math.sin(s)*(l-Math.tan(s)*p),top:u.top-Math.cos(s)*(l-Math.tan(s)*p)};var _=Wt(f,u),m=Tt(_,f,a,!1);return{size:{left:m.left-p,top:m.top,width:p,height:l},fixedPoint:u}},ce=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Zt(t),n=i.tempWidth,a=i.radian,r=Math.cos(a)*e+Math.sin(a)*o,c=Math.max(n+r,Jt);return ue(t,c)},se=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Zt(t),n=i.tempInfo,a=i.angle,r=i.tempWidth,c=i.tempHeight,s=i.radian,u=n.rotateLeftTop,h=Math.cos(s)*e+Math.sin(s)*o,d=-Math.sin(s)*e+Math.cos(s)*o,p=Math.max(h+r,Jt),l=Math.max(d+c,Jt),f={left:0,top:0};f=0===a?{left:u.left+p,top:u.top+l}:90===a?{left:u.left-l,top:u.top+p}:180===a?{left:u.left-p,top:u.top-l}:270===a?{left:u.left+l,top:u.top-p}:{left:u.left+Math.cos(s)*(p-Math.tan(s)*l),top:u.top+l/Math.cos(s)+Math.sin(s)*(p-Math.tan(s)*l)};var _=Wt(f,u),m=Tt(_,u,a,!1);return{size:{left:m.left,top:m.top,width:p,height:l},fixedPoint:u}},ue=function(t,e){var o=Zt(t),i=o.data,n=o.tempInfo,a=o.angle,r=o.tempWidth,c=o.tempHeight,s=o.radian,u=e-r,h=c,d=n.rotateLeftTop,p=n.rotateRightBottom,l={left:p.left+Math.cos(s)*u,top:p.top+Math.sin(s)*u},f=i.isSameRatio;if(f){var _=c/r*u;h+=_,l={left:l.left-Math.sin(s)*_,top:l.top+Math.cos(s)*_}}var m=Wt(d,l),v=Tt(m,d,a,!1);return{size:{left:v.left,top:v.top,width:e,height:h},fixedPoint:d,scaleW:e/r}},he=function(t,e){var o=Zt(t),i=o.tempInfo,n=o.angle,a=o.tempHeight,r=o.radian,c=e-a,s=i.rotateLeftTop,u=i.rotateRightBottom,h={left:u.left-Math.sin(r)*c,top:u.top+Math.cos(r)*c},d=Wt(s,h),p=Tt(d,s,n,!1);return{size:{left:p.left,top:p.top,height:e},fixedPoint:s,scaleW:e/a}},de=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Zt(t),n=i.tempHeight,a=i.radian,r=-Math.sin(a)*e+Math.cos(a)*o,c=Math.max(n+r,Jt);return he(t,c)},pe=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Zt(t),n=i.tempInfo,a=i.angle,r=i.tempWidth,c=i.tempHeight,s=i.radian,u=n.rotateRightTop,h=-Math.cos(s)*e-Math.sin(s)*o,d=-Math.sin(s)*e+Math.cos(s)*o,p=Math.max(h+r,Jt),l=Math.max(d+c,Jt),f={left:0,top:0};f=0===a?{left:u.left-p,top:u.top+l}:90===a?{left:u.left-l,top:u.top-p}:180===a?{left:u.left+p,top:u.top-l}:270===a?{left:u.left+l,top:u.top+p}:{left:u.left-(p/Math.cos(s)+Math.sin(s)*(l-Math.tan(s)*p)),top:u.top+Math.cos(s)*(l-Math.tan(s)*p)};var _=Wt(f,u),m=Tt(_,u,a,!1);return{size:{left:m.left-p,top:m.top,height:l,width:p},fixedPoint:u}},le=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Zt(t),n=i.tempInfo,a=i.angle,r=i.tempWidth,c=i.radian,s=-Math.cos(c)*e-Math.sin(c)*o,u=Math.max(r+s,Jt);s=u-r;var h=n.rotateLeftTop,d=n.rotateRightBottom,p={left:h.left-Math.cos(c)*s,top:h.top-Math.sin(c)*s},l=Wt(d,p),f=Tt(l,p,a,!1);return{size:{left:f.left,top:f.top,width:u},fixedPoint:d,scaleW:u/r}},fe=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=t.tempData,n=i.height,a=i.width,r=i.rbc,c=i.rad,s={left:c.left+e,top:c.top+o},u=Wt(s,r),d=parseInt(Ct(s,u)+90)%360,p=Tt(u,s,d,!1),l=Tt(u,r,d,!1),f=l.left-p.left,_={left:p.left,top:p.top-n/2};return{size:Object(h["a"])({},_,{width:f}),angle:d,fixedPoint:r,scaleW:f/a}},_e=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=t.tempData,n=i.height,a=i.width,r=i.rbc,c=i.rad,s={left:r.left+e,top:r.top+o},u=Wt(c,s),d=parseInt(Ct(c,u)+90)%360,p=Tt(u,c,d,!1),l=Tt(u,s,d,!1),f=l.left-p.left,_={left:p.left,top:p.top-n/2};return{size:Object(h["a"])({},_,{width:f}),angle:d,fixedPoint:c,scaleW:f/a}},me=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Zt(t),n=i.tempInfo,a=i.angle,r=i.radian,c=i.tempWidth,s=i.tempHeight,u=n.rbc,d=n.rad,p=-Math.cos(r)*e-Math.sin(r)*o,l=Math.max(p+c,Jt),f=Qt(l,c),_=Ht(u,d,f),m=Wt(u,_),v=Tt(m,_,a,!1),g={left:v.left,top:v.top-s/2};return{size:Object(h["a"])({},g,{width:l}),angle:a,fixedPoint:d,scale:f}},ve=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Zt(t),n=i.tempInfo,a=i.angle,r=i.radian,c=i.tempWidth,s=i.tempHeight,u=n.rbc,d=n.rad,p=Math.cos(r)*e+Math.sin(r)*o,l=Math.max(p+c,Jt),f=Qt(l,c),_=Ht(d,u,f),m=Wt(d,_),v=Tt(m,d,a,!1),g={left:v.left,top:v.top-s/2};return{size:Object(h["a"])({},g,{width:l}),angle:a,fixedPoint:d,scale:f}},ge={methods:{_resize:function(t,e){var o=this.objects[this.currRectId],i=this.mouse.resizerDir,n="rect-line"===o.type,a=this._checkGuideOnResize(o,i,t,e),r=Object(mt["a"])(a,2);t=r[0],e=r[1],this._checkIsGroupLike(o)?this._resizeGroup(o,i,t,e):n?this._resizeLine(o,i,t,e):this._resizeRect(o,i,t,e)},_resizeText:function(t,e){var o=t.data;e=e||o.text;var i="".concat(o.fontSize,"px ").concat(o.fontFamily),n=jt(e,i),a=n.width;this._resizeWidthTo(t,a);var r=n.height;this._resizeHeightTo(t,r)},_resizeLine:function(t,e,o,i){var n={ad:fe,bc:_e}[e];t.data.isAngleLock&&(n={ad:me,bc:ve}[e]);var a=n(t,o,i);t.data.angle=a.angle,this._updateRectData(t,a.size)},_scaleGroupRectR:function(t,e,o){var i=t.data,n=t.tempData,a=n.rotateLeftTop,r=n.rotateRightBottom,c=Ht(e,a,o),s=Ht(e,r,o),u=Wt(c,s),h=Tt(u,c,i.angle,!1),d=$t(h,u);this._updateRectData(t,{left:h.left,top:h.top,width:d.width,height:d.height},!1)},_scaleGroupRectWOrH:function(t,e,o,i){var n,a=t.data,r=t.tempData,c=a.angle,s=e.data,u=e.tempData,h=s.angle,d=Gt(c),p="left";"bc"===i?n=r.left:"ad"===i?n=r.left+r.width:"cd"===i?(n=r.top,p="top"):(n=r.top+r.height,p="top");var l=Math.abs(h-c),f=180===l,_=90===l,m=270===l,v=u.rotateLeftTop,g=u.rotateRightTop,b=u.rotateRightBottom,y=u.rotateLeftBottom;if(_)v=y,b=g;else if(f){var R=[b,v];v=R[0],b=R[1]}else m&&(v=g,b=y);var I=Tt(r.center,v,c,!1),k=I[p]-n,j=k*(o-1),x={left:v.left,top:v.top};"left"===p?(x.left+=Math.cos(d)*j,x.top+=Math.sin(d)*j):(x.left-=Math.sin(d)*j,x.top+=Math.cos(d)*j);var O=Tt(r.center,b,c,!1),w=O[p]-n,P=w*(o-1),G={left:b.left,top:b.top};"left"===p?(G.left+=Math.cos(d)*P,G.top+=Math.sin(d)*P):(G.left-=Math.sin(d)*P,G.top+=Math.cos(d)*P);var M=Wt(x,G),T=Tt(M,x,h,!1),L=$t(T,M),S={left:T.left,top:T.top,width:L.width,height:L.height};f?(S.left=s.left-S.width,S.top=s.top-S.height):_?S.top=s.top-S.height:m&&(S.left=s.left-S.width),this._updateRectData(e,S,!1)},_scaleGroupR:function(t,e,o){var i=this,n=function(t){var n=i._getRectById(t);i._scaleGroupRectR(n,e,o)};this._updateGroupState(t,n)},_resizeGroupWithRes:function(t,e,o){var i=this,n=e.fixedPoint,a=e.scaleW||e.scaleH,r=t.data,c=r.angle,s=function(e){var s=i._getRectById(e),u=s.data,h=u.angle,d=r.isSameRatio||u.isSameRatio,p=(h-c)%90!==0;d||p?i._scaleGroupRectR(s,n,a):i._scaleGroupRectWOrH(t,s,a,o)};return this._updateGroupState(t,s),this._getGroupSize(t)},_resizeGroup:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"c",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n={a:te,b:ee,c:oe,d:ie,ab:ae,bc:ce,cd:de,ad:le}[e],a=n(t,o,i),r={};if(["a","b","c","d"].includes(e)){var c=a.scale,s=a.fixedPoint;this._scaleGroupR(t,s,c),r=a.size}else r=this._resizeGroupWithRes(t,a,e);this._updateRectData(t,r)},_resizeRect:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bc",o=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,n={a:ne,b:re,c:se,d:pe,ab:ae,bc:ce,cd:de,ad:le}[e],a=this.mouse.e.shiftKey,r=t.data.isSameRatio;(a||r)&&(n={a:te,b:ee,c:oe,d:ie}[e]);var c=n(t,o,i);this._updateRectData(t,c.size)},_resizeTo:function(t){var e,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=this._checkIsGroupLike(t);if(null!==i&&(e=ue(t,i),o="bc"),null!==n&&(e=he(t,n),o="cd"),a){var r=this._resizeGroupWithRes(t,e,o);this._updateRectData(t,r)}else this._updateRectData(t,e.size)},_resizeWidthTo:function(t,e){this._resizeTo(t,e)},_resizeHeightTo:function(t,e){this._resizeTo(t,null,e)}}},be={methods:{_rotate:function(t){var e=this.objects[this.currRectId],o=At(e.data),i=e.tempData,n=i.angle,a=o.angle,r=this.scale,c=parseInt(Ct(t,{left:o.center.left*r,top:o.center.top*r})),s=c-n;s=this._checkGuideOnRotate(n,a,c,s),this._checkIsGroupLike(e)?this._rotateGroup(e,s):this._rotateRect(e,s)},_rotateTo:function(t,e){var o=t.tempData,i=e-o.angle;this._checkIsGroupLike(t)?this._rotateGroup(t,i):this._rotateRect(t,i)},_rotateRect:function(t,e){if(this._updateRectData(t,{angle:Dt(t.tempData.angle+e)},!1),t.groupId){var o=this._getRectById(t.groupId);this._updateGroupSize(o)}},_rotateGroup:function(t,e){var o=this,i=t.tempData,n=i.center,a=function(t){var i=o._getRectById(t),a=i.tempData,r=Tt(n,a.center,e),c=r.left-a.width/2,s=r.top-a.height/2;o._updateRectData(i,{left:c,top:s,angle:Dt(a.angle+e)},!1)};this._updateGroupState(t,a,!0)}}},ye={methods:{_move:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t=this._safeObject(t),i){var n=this._checkGuideOnMove(t,e,o),a=Object(mt["a"])(n,2);e=a[0],o=a[1]}var r=this.mouse.e.shiftKey;r&&(Math.abs(e)>Math.abs(o)?o=0:e=0),this._checkIsGroupLike(t)?this._moveGroup(t,e,o):this._moveRect(t,e,o)},_moveTo:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=t.tempData,n=0,a=0;null!==e&&(n=e-i.left),null!==o&&(a=o-i.top),this._move(t,n,a,!1)},_moveLeftTo:function(t,e){this._moveTo(t,e)},_moveTopTo:function(t,e){this._moveTo(t,null,e)},_moveRect:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=t.tempData;if(this._updateRectData(t,{left:i.left+e,top:i.top+o},!1),t.groupId){var n=this._getRectById(t.groupId);this._updateGroupSize(n)}},_moveGroup:function(t){var e=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=function(t){var n=e._getRectById(t),a=n.tempData;e._updateRectData(n,{left:a.left+o,top:a.top+i},!1)};this._updateGroupState(t,n)}}},Re=p.a.div,Ie=p.a.span,ke=p.a.input,je=p.a.select,xe=p.a.option,Oe=p.a.label,we=p.a.i,Pe=p.a.bind("sp-color"),Ge=function(){var t=this,e={"class_proto-setting":!0},o=this._safeObject(this.currRectId||this._getSelectedRects()[0]),i=[];if(o){var n=o.data,a=this._checkIsGroupLike(o),r=this._checkIsTempGroup(o),c="rect-line"===o.type,s="rect-text"===o.type,u=n.isAutoSize,d=n.isSameRatio,p=n.isLock,l=function(e){var i=n[e];"number"===typeof i&&(i=Pt(i,0));var a={"class_form-input":!0,"class_input-sm":!0,domProps_value:i,domProps_type:"number",props_value:i,domProps_disabled:p,props_disabled:p,key:e,on_blur:function(){},on_focus:function(){t._updateRectTempData(o)},on_change:function(i){var n=i.target.value;o.data[e]=n,t._historyPush(),["borderStyle"].includes(e)&&t._flashHandler()}};return["borderColor","color","backgroundColor"].includes(e)&&(a=Object(h["a"])({},a,{on_change:function(i){var n=i.hex8;o.data[e]=n,t._historyPush(),["borderColor"].includes(e)&&t._flashHandler()}})),a};if(r){var f=Re({"class_proto-setting-box-item":!0},Ie("对齐"),je({"class_form-select":!0,"class_select-sm":!0,domProps_value:"",on_change:function(e){var o=e.target.value,i={left:t._actionRectAlignLeft,leftRight:t._actionRectAlignLeftRight,right:t._actionRectAlignRight,top:t._actionRectAlignTop,topBottom:t._actionRectAlignTopBottom,bottom:t._actionRectAlignBottom,equalSpaceX:t._actionRectEqualSpaceX,equalSpaceY:t._actionRectEqualSpaceY}[o];i(),t._historyPush(),t.renderHook++}},xe({domProps_value:""},"选择对齐方式"),xe({domProps_value:"left"},"左对齐"),xe({domProps_value:"leftRight"},"左右居中"),xe({domProps_value:"right"},"右对齐"),xe({domProps_value:"top"},"上对齐"),xe({domProps_value:"topBottom"},"上下居中"),xe({domProps_value:"bottom"},"下对齐"),xe({domProps_disabled:!t._actionCanRectEqualSpace(),domProps_value:"equalSpaceX"},"水平等间距"),xe({domProps_disabled:!t._actionCanRectEqualSpace(),domProps_value:"equalSpaceY"},"垂直等间距")));i=[].concat(Object(x["a"])(i),[f])}var _=Re({"class_proto-setting-box-item":!0},Ie("X轴坐标"),ke(Object(h["a"])({},l("left"),{on_change:function(e){var i=e.target.value,n=parseInt(i);t._moveLeftTo(o,n),t._historyPush()}})));i=[].concat(Object(x["a"])(i),[_]);var m=Re({"class_proto-setting-box-item":!0},Ie("Y轴坐标"),ke(Object(h["a"])({},l("top"),{on_change:function(e){var i=e.target.value,n=parseInt(i);t._moveTopTo(o,n),t._historyPush()}})));i=[].concat(Object(x["a"])(i),[m]);var v=Re({"class_proto-setting-box-item":!0},Ie("宽度"),ke(Object(h["a"])({domProps_disabled:u},l("width"),{on_change:function(e){var i=e.target.value,n=Math.max(10,parseInt(i));t._resizeWidthTo(o,n),t._historyPush()}})));i=[].concat(Object(x["a"])(i),[v]);var g=Re({"class_proto-setting-box-item":!0},Ie("高度"),ke(Object(h["a"])({domProps_disabled:u||c||d},l("height"),{on_change:function(e){var i=e.target.value,n=Math.max(10,parseInt(i));t._resizeHeightTo(o,n),t._historyPush()}})));if(i=[].concat(Object(x["a"])(i),[g]),!r){var b=Re({"class_proto-setting-box-item":!0},Ie("角度"),ke(Object(h["a"])({},l("angle"),{on_change:function(e){var i=e.target.value,n=parseInt(i)%360;n<0&&(n+=360),t._rotateTo(o,n),t._historyPush()}})));i=[].concat(Object(x["a"])(i),[b])}if(!c){var y=Re({"class_proto-setting-box-item":!0},Ie("等比缩放"),Oe({"class_form-switch":!0},ke(Object(h["a"])({},l(),{key:"isSameRatio",domProps_type:"checkbox",domProps_checked:n["isSameRatio"],on_change:function(){var e=!n["isSameRatio"];o.data.isSameRatio=e,t._historyPush()}})),we({"class_form-icon":!0})));i=[].concat(Object(x["a"])(i),[y])}if(c){var R=Re({"class_proto-setting-box-item":!0},Ie("锁定角度"),Oe({"class_form-switch":!0},ke(Object(h["a"])({},l(),{key:"isAngleLock",domProps_type:"checkbox",domProps_checked:n["isAngleLock"],on_change:function(){var e=!n["isAngleLock"];o.data.isAngleLock=e,t._historyPush()}})),we({"class_form-icon":!0})));i=[].concat(Object(x["a"])(i),[R])}if(!a){if(!s){var I=Re({"class_proto-setting-box-item":!0},Ie("边框宽度"),ke(Object(h["a"])({},l("borderWidth"),{on_change:function(t){var e=t.target.value,i=Math.max(0,parseInt(e));o.data.borderWidth=i,c&&(o.data.height=i)}})));i=[].concat(Object(x["a"])(i),[I]);var k=Re({"class_proto-setting-box-item":!0},Ie("边框样式"),je(Object(h["a"])({},l("borderStyle"),{"class_form-select":!0,"class_select-sm":!0}),xe({domProps_value:"solid"},"solid"),xe({domProps_value:"dashed"},"dashed"),xe({domProps_value:"dotted"},"dotted")));i=[].concat(Object(x["a"])(i),[k]);var j=Re({"class_proto-setting-box-item":!0},Ie("边框颜色"),Pe(Object(h["a"])({},l("borderColor"))));i=[].concat(Object(x["a"])(i),[j])}if(!c){var O=Re({"class_proto-setting-box-item":!0},Ie("背景颜色"),Pe(Object(h["a"])({},l("backgroundColor"))));i=[].concat(Object(x["a"])(i),[O])}if(!c){var w=Re({"class_proto-setting-box-item":!0},Ie("文本颜色"),Pe(Object(h["a"])({},l("color"))));i=[].concat(Object(x["a"])(i),[w])}if(s){var P=Re({"class_proto-setting-box-item":!0},Ie("自适应尺寸"),Oe({"class_form-switch":!0},ke(Object(h["a"])({},l(),{key:"isAutoSize",domProps_checked:n["isAutoSize"],domProps_type:"checkbox",on_change:function(){var e=!n["isAutoSize"];t._updateRectTempData(o),o.data.isAutoSize=e,t._resizeText(o),t._historyPush()}})),we({"class_form-icon":!0})));i=[].concat(Object(x["a"])(i),[P])}var G=Re({"class_proto-setting-box-item":!0},Ie("文本大小"),ke(Object(h["a"])({},l("fontSize"),{domProps_min:12,on_change:function(e){var i=e.target.value;i=parseInt(i),o.data.fontSize=i,n.isAutoSize&&t._resizeText(o)}})));i=[].concat(Object(x["a"])(i),[G]);var M=Re({"class_proto-setting-box-item":!0},Ie("文本X轴对齐"),je(Object(h["a"])({},l("textAlignX"),{"class_form-select":!0,"class_select-sm":!0}),xe({domProps_value:"flex-start"},"左对齐"),xe({domProps_value:"center"},"居中对齐"),xe({domProps_value:"flex-end"},"右对齐")));i=[].concat(Object(x["a"])(i),[M]);var T=Re({"class_proto-setting-box-item":!0},Ie("文本Y轴对齐"),je(Object(h["a"])({},l("textAlignY"),{"class_form-select":!0,"class_select-sm":!0}),xe({domProps_value:"flex-start"},"上对齐"),xe({domProps_value:"center"},"居中对齐"),xe({domProps_value:"flex-end"},"下对齐")));i=[].concat(Object(x["a"])(i),[T])}var L=Re({"class_proto-setting-box-item":!0},Ie("不透明度"),ke(Object(h["a"])({},l("opacity"),{domProps_min:0,domProps_max:100,on_change:function(e){var o=e.target.value;o=parseInt(o),t._updateCurrRectOpacity(o),t._historyPush()}})),"%");i=[].concat(Object(x["a"])(i),[L])}return Re(Object(h["a"])({class_card:!0},e),Re(".card-header",Re(".card-title h6","样式")),Re.apply(void 0,[".card-body"].concat(Object(x["a"])(i))))},Me=p.a.div,Te=function(){var t=this,e=this.objects[this.currRectId];if(e){var o=e.data,i=o.isLock,n=this._checkIsTempGroup(e),a=this.mouse,r=function(o){t._updateRectTempData(e),o.stopPropagation(),f.$emit("windowMouseDown",o)},c={"class_proto-rect-resizer":!0},s=5,u="calc(50% - ".concat(s,"px)"),d=Me(Object(h["a"])({},c,{style_left:-s+"px",style_top:-s+"px",on_mousedown:function(t){a.resizerDir="a",a.eventType="resize",r(t)}})),p=Me(Object(h["a"])({},c,{style_left:u,style_top:-s+"px",on_mousedown:function(t){a.resizerDir="ab",a.eventType="resize",r(t)}})),l=Me(Object(h["a"])({},c,{style_right:-s+"px",style_top:-s+"px",on_mousedown:function(t){a.resizerDir="b",a.eventType="resize",r(t)}})),_=Me(Object(h["a"])({},c,{style_right:-s+"px",style_top:u,on_mousedown:function(t){a.resizerDir="bc",a.eventType="resize",r(t)}})),m=Me(Object(h["a"])({},c,{style_right:-s+"px",style_bottom:-s+"px",on_mousedown:function(t){a.resizerDir="c",a.eventType="resize",r(t)}})),v=Me(Object(h["a"])({},c,{style_left:u,style_bottom:-s+"px",on_mousedown:function(t){a.resizerDir="cd",a.eventType="resize",r(t)}})),g=Me(Object(h["a"])({},c,{style_left:-s+"px",style_bottom:-s+"px",on_mousedown:function(t){a.resizerDir="d",a.eventType="resize",r(t)}})),b=Me(Object(h["a"])({},c,{style_left:-s+"px",style_bottom:u,on_mousedown:function(t){a.resizerDir="ad",a.eventType="resize",r(t)}})),y=[],R="rect-line"===e.type,I=e.data.isSameRatio;R?y=[b,_]:(y=[d,l,m,g],I||(y=[].concat(Object(x["a"])(y),[p,_,v,b])));var k=Me({"class_proto-rect-rotater":!0,style_left:u,style_top:"-15px",on_mousedown:function(t){a.eventType="rotate",r(t)}}),j=Object(h["a"])({},this._getRectBaseJsxProps(e,this.scale),{"class_proto-rect-handler":!0,"class_proto-rect-handler-lock":i});this.handler.show||(j=Object(h["a"])({},j,{style_display:"none"}));var O=[];return n||(O=[k]),e.data.isAutoSize||(O=[].concat(Object(x["a"])(O),Object(x["a"])(y))),Me.apply(void 0,[j].concat(Object(x["a"])(O)))}},Le=(o("6c3c"),o("1481"),p.a.div),Se=function(){var t=this.scale;return[].concat(Object(x["a"])(Array.from(this.guide.show.top).map((function(e){return Le({"class_proto-guide":!0,"class_proto-guide-top":!0,style_top:e*t+"px"})}))),Object(x["a"])(Array.from(this.guide.show.left).map((function(e){return Le({"class_proto-guide":!0,"class_proto-guide-left":!0,style_left:e*t+"px"})}))))},Be=p.a.div,Ce=p.a.span,De=p.a.button,ze=p.a.select,Ee=p.a.option,Ae={class_btn:!0,"class_btn-sm":!0},Fe=p.a.bind("v-icon"),He=function(t,e){var o=this,i=this._actionGet(t),n=i.checkF,a=i.doF,r=i.text,c=Object(h["a"])({},Ae,{domProps_disabled:!n.call(this),on_click:function(){a.call(o)}}),s=[Ce(r)];return e&&(s=[Fe({props_name:e})].concat(Object(x["a"])(s))),De.apply(void 0,[c].concat(Object(x["a"])(s)))},We=function(){var t=this;return Be(".proto-tools",Be(".btn-group",He.call(this,"sys-撤销","undo-alt"),He.call(this,"sys-重做","redo-alt")),Be(".btn-group",He.call(this,"rect-组合","object-group"),He.call(this,"rect-打散","object-ungroup")),Be(".btn-group",He.call(this,"rect-复制","copy"),He.call(this,"rect-粘贴","paste"),He.call(this,"rect-删除","trash-alt"),He.call(this,"rect-剪切","cut")),Be(".btn-group",He.call(this,"rect-上移","layer-group"),He.call(this,"rect-下移","layer-group"),He.call(this,"rect-置顶","layer-group"),He.call(this,"rect-置底","layer-group")),Be(".btn-group",He.call(this,"rect-锁定","lock"),He.call(this,"rect-解锁","unlock")),Be(".btn-group",ze.apply(void 0,[{"class_form-select":!0,"class_select-sm":!0,domProps_value:this.scale,on_change:function(e){t.scale=e.target.value,t._renderRule()}}].concat(Object(x["a"])([.5,.8,1,1.25,2].map((function(t){return Ee({domProps_value:t},t+"x")})))))))},$e={blue:"#5755d9",red:"#e85600",gray:"#bcc3ce",white:"#ffffff",black:"#000000"},Ke={name:"对象",top:0,left:0,width:200,height:100,angle:0,zIndex:0,text:"&nbsp;",color:$e.black,fontSize:12,fontFamily:"SourceHanSansSC",backgroundColor:$e.white,borderRadius:0,borderWidth:1,borderStyle:"solid",borderColor:$e.black,opacity:100,textAlignX:"center",textAlignY:"center",isEdit:!1,isNameEdit:!1,isOpen:!1,isSameRatio:!1,isLock:!1},Ne=Object(h["a"])({},Ke,{name:"矩形"}),Ue=Object(h["a"])({},Ke,{name:"圆形",borderRadius:"100%",width:100}),Ve=Object(h["a"])({},Ke,{name:"群组"}),Xe=Object(h["a"])({},Ke,{name:"临时群组"}),qe=Object(h["a"])({},Ke,{name:"文本",border:null,text:"双击编辑文本",width:72,height:17,isAutoSize:!0,borderWidth:0}),Ye=Object(h["a"])({},Ke,{name:"线条",backgroundColor:$e.gray,borderWidth:1,height:1,isAngleLock:!1}),Je=p.a.span,Qe=p.a.div,Ze=function(){var t=this,e=["rect","circle","text","line"].map((function(e){return Je({class_label:!0,on_mousedown:function(o){o.stopPropagation(),t.mouse.eventType="create",t.mouse.createType=e,f.$emit("windowMouseDown",o)}},i[e].name)}));return Qe({"class_proto-rect-tags":!0,class_card:!0},Qe({"class_card-header":!0},Qe({"class_card-title":!0,class_h6:!0},"组件")),Qe.apply(void 0,[{"class_card-body":!0}].concat(Object(x["a"])(e))))},to=o("5cd5"),eo=p.a.div,oo=p.a.span,io=function(t){var e,o=this,i=this,n=t.data,a=t.id===this.currRectId,r=t.id===this.hoverRectId;r=r||t.id in this.selectedRects;var c=n.isLock&&!n.isOpen,s=t.type,u=this.mouse,d=function(e){o._focusRect(t,e),e.stopPropagation()},l=Object(h["a"])({},this._getRectBaseJsxProps(t),(e={"class_proto-rect":!0,"class_proto-rect-hover":r&&!a,"class_proto-rect-focus":a,"class_proto-rect-lock":c},Object(to["a"])(e,"class_proto-".concat(s),!0),Object(to["a"])(e,"attrs_id",t.id),Object(to["a"])(e,"attrs_index",t.index),Object(to["a"])(e,"key",t.id),Object(to["a"])(e,"on_mousedown",(function(e){i._checkIsTempGroup(t)||(u.eventType="move",t.data.isEdit&&(u.eventType=""),d(e),Vt(e)?i._showContextmenu(e,"rect"):f.$emit("windowMouseDown",e))})),Object(to["a"])(e,"on_mousemove",(function(){i._hoverRect(t)})),Object(to["a"])(e,"on_mouseout",(function(){i._hoverOffRect()})),e)),_=[];return this._checkIsGroupLike(t)||(l["on_dblclick"]=function(e){i._focusRect(t,e),u.ing=!1},_=[this._renderRectInner(t)]),r&&c&&(_=[].concat(Object(x["a"])(_),[p.a.create("v-icon",{"class_proto-rect-lock-icon":!0,props_name:"lock"})])),eo.apply(void 0,[l].concat(Object(x["a"])(_)))},no=function(t){var e=this,o=this,i=t.data.isEdit,n=t.data,a="rect-line"===t.type,r={"class_proto-rect-inner":!0},c=[];if(a)r=Object(h["a"])({},r,{"style_border-top-width":n.borderWidth+"px","style_border-top-style":n.borderStyle,"style_border-top-color":n.borderColor});else{r=Object(h["a"])({},r,{"style_border-width":n.borderWidth+"px","style_border-style":n.borderStyle,"style_border-color":n.borderColor,"style_background-color":n.backgroundColor,"style_border-radius":Ut(n.borderRadius),"style_align-items":n.textAlignY,"style_justify-content":n.textAlignX,style_overflow:"hidden"});var s={"class_proto-rect-inner-text":!0,attrs_contenteditable:!1,style_color:n.color,"style_font-size":n.fontSize+"px","style_font-family":n.fontFamily};i?(s=Object(h["a"])({},s,{style_cursor:"text",ref:"defaultText",attrs_contenteditable:!0,style_transform:"rotate(-".concat(n.angle,"deg)"),on_blur:function(){o._hotkeyOn(),t.data.isEdit=!1,o._historyPush()},on_focus:function(){o._hotkeyOff(),o.$refs.defaultText.innerHTML=n.text,Et(o.$refs.defaultText),o._updateRectTempData(t)},on_input:function(e){var i=e.target.innerHTML;n.isAutoSize&&o._resizeText(t,i),t.data.text=i}}),setTimeout((function(){e.$refs.defaultText&&e.$refs.defaultText.focus()}))):s=Object(h["a"])({},s,{domProps_innerHTML:n.text}),c=[oo(s)]}return eo.apply(void 0,[r].concat(Object(x["a"])(c)))},ao=function(){var t=this;if(!this.currPage)return null;var e=[];return this._getRectsByPageDeep().forEach((function(o){t._checkIsRectLike(o)&&e.push(t._renderRect(o))})),eo({"class_proto-canvas":!0},eo.apply(void 0,[{"class_proto-zoom":!0,style_transform:"scale(".concat(this.scale,")")}].concat(e)))},ro=function(t){t.strokeStyle=$e.gray,t.font="20px SourceHanSansSC"},co=1e4,so=2*It.c,uo=function(){var t=this.$refs.middle,e=window.getComputedStyle(t);return{dom:t,scrollTop:t.scrollTop,scrollLeft:t.scrollLeft,width:parseInt(e.width),height:parseInt(e.height)}},ho=function(){var t=this.topRule,e=uo.call(this);t||(this.topRule=t=document.createElement("canvas"),t.className="proto-rule",t.style.top=It.a+"px",t.style.left=It.b+It.c+"px",e.dom.appendChild(t)),t.width=2*e.width,t.height=so,t.style.width=e.width+"px",t.style.height=so/2+"px";var o=this.scale,i=t.getContext("2d");i.clearRect(0,0,co,so),ro(i),i.beginPath();for(var n=e.scrollLeft,a=0;a<co;a+=10){var r=a%100===0,c=2*(a-n),s=a/o,u=2*(r?0:10);i.moveTo(c,u),i.lineTo(c,so),r&&i.fillText(s,c+2,16)}i.moveTo(0,so),i.lineTo(t.width,so),i.stroke()},po=function(){var t=uo.call(this),e=this.leftRule;e||(this.leftRule=e=document.createElement("canvas"),e.className="proto-rule",e.style.top=It.a+It.c+"px",e.style.left=It.b+"px",this.$refs.middle.appendChild(e)),e.width=so,e.height=2*t.height,e.style.width=so/2+"px";var o=this.scale;e.style.height=t.height+"px";var i=e.getContext("2d");i.clearRect(0,0,so,co),ro(i),i.beginPath();for(var n=t.scrollTop,a=0;a<co;a+=10){var r=a%100===0,c=2*(a-n),s=(a/o+" ").slice(0,4),u=2*(r?0:10);i.moveTo(u,c),i.lineTo(so,c),r&&(i.save(),i.textAlign="center",i.textBaseline="middle",i.translate(10,c-18),i.rotate(-90*Math.PI/180),i.fillText(s,6,0),i.restore())}i.moveTo(so,0),i.lineTo(so,e.height),i.stroke(),i.stroke()},lo=function(){ho.call(this),po.call(this)},fo=p.a.div,_o=p.a.input,mo=function(t){var e=this,o=t.id===this.hoverRectId||t.id===this.currRectId||t.id in this.selectedRects,i=16,n=t.data.isNameEdit,a={"class_proto-tree-item":!0},r={"class_proto-tree-item-inner":!0,"class_proto-tree-item-hover":o};t.groupId&&(r=Object(h["a"])({},r,{"style_padding-left":i+"px"}));var c=[];return n?(c=[_o(".form-input input-sm",{domProps_value:t.name,ref:"rectItemInput",key:"rectItemInput",on_focus:function(){e.$refs.rectItemInput.select()},on_blur:function(){t.data.isNameEdit=!1,e._historyPush()},on_change:function(){e.$refs.rectItemInput.blur()},on_input:function(e){var o=e.target.value;t.name=o},on_mousedown:function(t){t.stopPropagation()}})],setTimeout((function(){e.$refs.rectItemInput&&e.$refs.rectItemInput.focus()}))):(a=Object(h["a"])({},a,{attrs_index:t.index,on_mouseover:function(){e._updateHoverRect(t)},on_mouseout:function(){e._updateHoverRect()},on_mousedown:function(o){var i=e._getGroupByRect(t);i&&(i.data.isOpen=!0),e._focusRect(t,{shiftKey:!1}),o.stopPropagation(),f.$emit("windowMouseDown",o),Vt(o)&&e._showContextmenu(o,"rect-item")}}),c=[fo(r,t.name)]),fo.apply(void 0,[a].concat(Object(x["a"])(c)))},vo=function(){var t=this;if(!this.currPage)return null;var e=[],o=[];return this._getRectsByPageDeep().reverse().forEach((function(i){if(!t._checkIsTempGroup(i)){var n=mo.call(t,i);""===i.groupId?(e=[].concat(Object(x["a"])(e),[n],Object(x["a"])(o)),o=[]):o.push(n)}})),e=[].concat(Object(x["a"])(e),Object(x["a"])(o)),fo({"class_proto-rect-list":!0,"class_proto-tree":!0,class_card:!0},fo({"class_card-header":!0},fo({"class_card-title":!0,class_h6:!0},"元素")),fo.apply(void 0,[{"class_card-body":!0}].concat(Object(x["a"])(e))))},go=p.a.div,bo=p.a.input,yo=p.a.span,Ro=p.a.bind("v-icon"),Io=function(t,e){var o=this,i=t.data,n=this.currPage,a=this._linkedListCheckIsParent(n,t),r=n===t,c=16,s=c*e,u=i.isNameEdit,d=this.mouse.ing&&"movePage"===this.mouse.eventType&&!r&&!a,p={"class_proto-tree-item":!0,"class_proto-tree-item-drag":d},l={"class_proto-tree-item-inner":!0,"class_proto-tree-item-hover":r,"style_padding-left":s+"px"},_=[];if(u)_=[go(l,bo(".form-input input-sm",{domProps_value:t.name,ref:"pageInput",key:"pageInput",on_focus:function(){o.$refs.pageInput.select()},on_blur:function(){t.data.isNameEdit=!1,o._historyPush()},on_change:function(){o.$refs.pageInput.blur()},on_input:function(e){var o=e.target.value;t.name=o},on_mousedown:function(t){t.stopPropagation()}}))],setTimeout((function(){o.$refs.pageInput&&o.$refs.pageInput.focus()}));else{if(p=Object(h["a"])({},p,{on_mousedown:function(e){e.stopPropagation(),o._updateCurrPage(t),Vt(e)?o._showContextmenu(e,"page"):(o.mouse.ing=!0,o.mouse.eventType="movePage",f.$emit("windowMouseDown",e))}}),l=Object(h["a"])({},l,{"class_proto-tree-item-emit-hover":!this.mouse.ing}),d){var m=function(){o._linkedListRemove(o.objects[n.parentId],n,"pages")},v={style_left:s+"px",style_width:"calc(100% - ".concat(s,"px)")};_=[go(".proto-tree-item-drag-handler proto-tree-item-drag-handler-bottom",Object(h["a"])({},v,{on_mouseup:function(){m(),n.parentId=t.parentId,o._linkedListInsertAfter(o.objects[t.parentId],t,n,"pages")}}))],t.prevId||(_=[].concat(Object(x["a"])(_),[go(".proto-tree-item-drag-handler proto-tree-item-drag-handler-top",Object(h["a"])({},v,{on_mouseup:function(){m(),n.parentId=t.parentId,o._linkedListInsertBefore(o.objects[t.parentId],t,n,"pages")}}))])),l=Object(h["a"])({},l,{on_mouseup:function(){m(),n.parentId=t.parentId,o._linkedListAppend(t,n,"pages"),t.data.isExpand=!0}})}_=[].concat(Object(x["a"])(_),[go(l,t.pages.headId?Ro({props_name:i.isExpand?"caret-down":"caret-up",on_mousedown:function(){t.data.isExpand=!i.isExpand,o._historyPush()}}):null,yo(t.name))])}return go.apply(void 0,[p].concat(Object(x["a"])(_)))},ko=function(){var t=this;if(!this.currPage)return null;var e,o=this,i=[],n=this.mouse.ing&&"movePage"===this.mouse.eventType;return this._linkedListWalk(this.objects[this.currProjectId],"pages",(function(e,o){i.push(Io.call(t,e,o))})),n&&(i=[].concat(Object(x["a"])(i),[go(".proto-tree-scroll-handler proto-tree-scroll-handler-top",{on_mouseover:function(){e=setInterval((function(){o.$refs.pageList.scrollTop--}))},on_mouseout:function(){clearInterval(e)}}),go(".proto-tree-scroll-handler proto-tree-scroll-handler-bottom",{on_mouseover:function(){e=setInterval((function(){o.$refs.pageList.scrollTop++}))},on_mouseout:function(){clearInterval(e)}})])),go(".proto-page-list proto-tree card",go(".card-header",go(".card-title h6","页面")),go.apply(void 0,[".card-body proto-tree-body",{ref:"pageList"}].concat(Object(x["a"])(i))))},jo=p.a.div,xo=function(){var t=this._getCircleSize(),e=t.left,o=t.top,i=t.width,n=t.height;return jo(".proto-circle",{style_left:e+"px",style_top:o+"px",style_width:i+"px",style_height:n+"px"})},Oo=p.a.div,wo={data:function(){return{topRule:null,leftRule:null}},methods:{_renderSetting:Ge,_renderHandler:Te,_renderGuideShow:Se,_renderTools:We,_renderRects:ao,_renderRect:io,_renderRectInner:no,_renderRectNav:Ze,_renderRule:lo,_renderRectList:vo,_renderPageList:ko,_renderCircle:xo,_renderLoading:function(){return Oo("loading")},_renderMain:function(t){p.a.h=t;var e=this,o=this.mouse.ing&&"circle"===this.mouse.eventType;return Oo({class_proto:!0},Oo({"class_proto-top":!0,style_height:It.a+"px",on_mousedown:function(t){t.stopPropagation()}},this._renderTools()),Oo({"class_proto-left":!0,style_top:It.a+"px",style_width:It.b+"px",style_height:"calc(100% - ".concat(It.a,"px)")},Oo(".proto-height-half",this._renderPageList()),Oo(".proto-height-half",this._renderRectNav())),Oo({"class_proto-middle":!0,style_top:It.a+It.c+"px",style_left:It.b+It.c+"px",style_right:It.d+"px",style_height:"calc(100% - ".concat(It.a,"px - ").concat(It.c,"px)"),ref:"middle",on_mousedown:function(t){t.stopPropagation(),e._blurRect(),Vt(t)?e._showContextmenu(t,"canvas"):(e.mouse.eventType="circle",f.$emit("windowMouseDown",t))}},this._renderRects(),this._renderGuideShow(),this._renderHandler(),o?this._renderCircle():null),Oo({"class_proto-right":!0,style_top:It.a+"px",style_width:It.d+"px",style_height:"calc(100% - ".concat(It.a,"px)")},Oo(".proto-height-half",this._renderSetting(t)),Oo(".proto-height-half",this._renderRectList())))}},mounted:function(){this._renderRule()}},Po=(o("9110"),o("6fe7"),o("575d"),o("f29e"),{data:function(){return{currProjectId:"",currPageId:"",currRectId:"",hoverRectId:"",tempGroupId:"",selectedRects:{},objects:{},handler:{show:!0,timer:null},rectConfig:Object(h["a"])({},i),clipboard:{count:0,data:[]},renderHook:1}},computed:{scale:{get:function(){return this.renderHook,this.currProject?parseFloat(this.currProject.data.scale):1},set:function(t){this.currProject.scale=t}},currProject:{get:function(){return this.objects[this.currProjectId]}},currPage:{get:function(){return this.objects[this.currPageId]}},currRect:{get:function(){return this.objects[this.currRectId]}},tempGroup:{get:function(){return this.renderHook,this.objects[this.tempGroupId]}}},methods:{_parseLongProp:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$data,o=this,i=t.split("."),n=e,a=i.slice(-1)[0];return i.slice(0,-1).forEach((function(t){n=n[t]})),{get:function(){return n[a]},set:function(t){var e=null===t||void 0===t;e?delete n[a]:(n[a]=t,o.renderHook++)}}},_safeObject:function(t){return"string"===typeof t&&(t=this.objects[t]),t},_createProjectBase:function(){return{id:zt(),name:"项目",type:"project",count:1,pages:{headId:"",tailId:""},data:{scale:1}}},_createProject:function(){var t=this._createProjectBase();return this.objects[t.id]=t,t},_createPageBase:function(t){return{id:zt(),name:"页面",type:"page",count:1,parentId:t,projectId:t,prevId:"",nextId:"",pages:{headId:"",tailId:""},rects:{headId:"",tailId:""},data:{isNameEdit:!1,isExpand:!0}}},_createPage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currProjectId,e=this._createPageBase(t);return e=Object(h["a"])({},e,{name:"页面"+this.currProject.count,projectId:this.currProjectId}),this.currProject.count=this.currProject.count+1,this.objects[e.id]=e,this._linkedListAppend(this.objects[t],e,"pages"),e},_removePage:function(){var t=this,e=this.currPage,o=function(e){t._deleteObject(e.id)};this._linkedListRemove(this.objects[e.parentId],e,"pages"),this._linkedListWalk(e,"pages",o),o(e);var i=this.objects[this.currProjectId].pages.headId;this._updateCurrPage(this.objects[i])},_createRect:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rect",e=this.rectConfig[t];if(e)return t="rect-"+t,this._createRectByConfig({type:t,data:e})},_createRectByConfig:function(t){var e=this,o=t.data;if(Array.isArray(o)){var i=this._createRectBase(o[0].type,o[0].data),n=o.slice(1).map((function(t){return e._createRectBase(t.type,t.data)}));return this._bindGroup(i,n),i}return this._createRectBase(t.type,o)},_createRectBase:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rect",e=arguments.length>1?arguments[1]:void 0;e=Object(h["a"])({},e);var o=this.currPage.count;this.currPage.count=this.currPage.count+1;var i={id:zt(),parentId:this.currPage.id,pageId:this.currPage.id,groupId:"",tempGroupId:"",data:e,tempData:null,type:t,name:e.name+o,prevId:"",nextId:"",tempIndex:o};return this._checkIsGroup(i)&&(i=Object(h["a"])({},i,{rects:{headId:"",tailId:""}})),this.objects[i.id]=i,this._checkIsTempGroup(i)||this._linkedListAppend(this.currPage,i),this.objects[i.id]},_cloneRectDeep:function(t){t=this._safeObject(t);var e=function(t){return{type:t.type,data:Object(h["a"])({},t.data)}};if(this._checkIsGroup(t)){var o=[e(t)];return this._getRectsByGroup(t).forEach((function(t){o.push(e(t))})),{type:"rect-group",data:o}}return e(t)},_getObjectsByParentId:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"groupId",o=[];for(var i in this.objects){var n=this.objects[i];n&&n[e]===t&&o.push(n)}return o},_getRectsByPageDeep:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currPage.id,e=this._linkedListGetObjects(this.objects[t]);return this.tempGroup&&e.push(this.tempGroup),e},_getRectsByGroup:function(t){t=this._safeObject(t);var e=[];return e=this._checkIsTempGroup(t)?this._getObjectsByParentId(t.id,"tempGroupId"):this._checkIsGroup(t)?this._getObjectsByParentId(t.id):[t],e},_getGroupByRect:function(t){t=this._safeObject(t);var e=this.objects[t.groupId];return e},_getTempGroupByRect:function(t){if(t=this._safeObject(t),t.tempGroupId)return this.objects[t.tempGroupId];var e=this._getGroupByRect(t);return e&&e.tempGroupId?this.objects[e.tempGroupId]:null},_bindGroup:function(t,e){var o=this;t=this._safeObject(t);var i=new Set,n=new Set;e.forEach((function(t){if(t=o._safeObject(t),!o._checkIsTempGroup(t))if(o._checkIsGroup(t))i.add(t);else{if(t.groupId){var e=o.objects[t.groupId];return n.add(e),void i.add(e)}i.add(t)}}));var a=Array.from(i).sort((function(t,e){return e.tempIndex-t.tempIndex}))[0],r=this.currPage;this._linkedListRemove(r,t),this._linkedListInsertAfter(r,a,t),e.sort((function(t,e){return t.tempIndex-e.tempIndex})).forEach((function(e){e=o._safeObject(e),o._checkIsTempGroup(e)||(o._checkIsGroup(e)?o._removeRectById(e.id):(e.groupId?o._getGroupByRect(e)&&o._linkedListRemove(o.objects[e.groupId],e):o._linkedListRemove(r,e),o._linkedListAppend(t,e),e.tempGroupId="",e.groupId=t.id,e.parentId=t.id))})),Array.from(n).forEach((function(t){if(t.id in o.objects){var e=o._getRectsByGroup(t);e.length<=1?o._unbindGroup(t):(t.isOpen=!1,o._updateGroupSize(t))}})),this._updateGroupSize(t)},_unbindGroup:function(t){var e=this;t=this._safeObject(t),this._getRectsByGroup(t).forEach((function(o){o.groupId="",o.parentId=e.currPageId,e._linkedListRemove(t,o),e._linkedListInsertBefore(e.currPage,t,o)})),this._removeRectById(t.id)},_bindTempGroup:function(t){var e=this;this.tempGroup||(this.tempGroupId=this._createRect("tempGroup").id);var o=this.tempGroup;return t.forEach((function(t){t=e._safeObject(t),t.tempGroupId=o.id})),this._updateRectTempData(o),this._updateGroupSize(o),o},_unbindTempGroup:function(){var t=this;this.tempGroupId&&(this._getRectsByGroup(this.tempGroupId).forEach((function(e){e.tempGroupId="";var o=t._getGroupByRect(e);o&&(o.isOpen=!1)})),this._deleteObject(this.tempGroupId),this.tempGroupId="")},_unbindTempGroupSome:function(t){if(this.tempGroupId){t.forEach((function(t){t.tempGroupId=""}));var e=this._getRectsByGroup(this.currRectId);e.length<=1?this._unbindTempGroup():this._updateGroupSize(this.currRectId)}},_getRectById:function(t){return this.objects[t]},_getTempGroup:function(){return this.objects[this.tempGroupId]},_deleteObject:function(t){this.objects[t]=null},_removeRectById:function(t){var e=this.objects[t],o=this._getGroupByRect(t);if(this._checkIsTempGroup(e)||(e.groupId?o&&this._linkedListRemove(o,this.objects[t]):this._linkedListRemove(this.currPage,this.objects[t])),this._deleteObject(e.id),o){var i=this._getRectsByGroup(o);1===i.length?this._unbindGroup(o):this._updateGroupSize(o)}},_updateGroupSize:function(t){t=this._safeObject(t);var e=this._getGroupSize(t);return this._updateRectData(t,e,!1),e},_getGroupSize:function(t){t=this._safeObject(t);var e=this._getRectsByGroup(t);return Ft(e,t.data.angle)},_checkIsPage:function(t){return"page"===t.type},_checkIsRectLike:function(t){return 0===t.type.indexOf("rect-")},_checkIsGroupLike:function(t){return"rect-group"===t.type||"rect-tempGroup"===t.type},_checkIsTempGroup:function(t){return t=this._safeObject(t),t&&"rect-tempGroup"===t.type},_checkIsGroup:function(t){return"rect-group"===t.type},_updateAllRectsTempData:function(){this._getRectsByPageDeep().forEach((function(t){t.tempData=At(t.data)}))},_updateRectTempData:function(t){t=this._safeObject(t),this._getRectsByRectDeep(t).forEach((function(t){t.tempData=At(t.data)}))},_getRectsByRectDeep:function(t){var e=this;if(!this._checkIsGroupLike(t))return[t];if(this._checkIsGroup(t))return[t].concat(Object(x["a"])(this._getRectsByGroup(t)));if(this._checkIsTempGroup(t)){var o=[t];return this._getRectsByGroup(t).forEach((function(t){o=[].concat(Object(x["a"])(o),[t]),e._checkIsGroup(t)&&(o=[].concat(Object(x["a"])(o),Object(x["a"])(e._getRectsByGroup(t))))})),o}},_updateRectData:function(t,e){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i="rect-line"===t.type;if(i&&"height"in e){var n=Math.max(e.height,1);e["borderWidth"]=e["height"]=n}for(var a in e){var r=e[a];"number"===typeof r&&(r=Pt(r)),t.data[a]=r}if(o){var c=this._getGroupByRect(t);c&&this._updateGroupSize(c);var s=this._getTempGroupByRect(t);s&&this._updateGroupSize(s)}this.renderHook++},_updateGroupState:function(t,e){var o=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=new Set;this._getRectsByRectDeep(t).forEach((function(t){var i=t.id;o._checkIsGroup(t)?n.add(i):(t.groupId&&n.add(t.groupId),e(i))})),Object(x["a"])(n).forEach((function(t){i?e(t):o._updateGroupSize(o._getRectById(t))}))},_addSelectedRect:function(t){this._checkIsTempGroup(t)||(this.selectedRects[t.id]=1)},_removeSelectedRect:function(t){delete this.selectedRects[t.id],this._unbindTempGroupSome([t])},_clearSelectedRects:function(){this.selectedRects={},this._unbindTempGroup()},_updateCurrRectBySelected:function(){this.tempGroupId="",this.currRectId="";var t=this._getUnLockRectsBySelected(),e=t.length;if(e<=1)this._unbindTempGroup(),this._updateCurrRect(this.objects[t[0]]);else{var o=this._bindTempGroup(t);this._updateCurrRect(o)}this._updateAllRectsTempData(),this._updateGuide(),this.mouse.e={}},_getLockRectsBySelected:function(){var t=this;return Object.keys(this.selectedRects).filter((function(e){var o=t.objects[e];return o&&t.objects[e].data.isLock}))},_getUnLockRectsBySelected:function(){var t=this;return Object.keys(this.selectedRects).filter((function(e){var o=t.objects[e];return o&&!t.objects[e].data.isLock}))},_getSelectedRects:function(){return Object.keys(this.selectedRects)},_focusRect:function(t){var e=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shiftKey:!0},i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t=this._safeObject(t);var n="dblclick"===o.type,a=o.shiftKey,r=this._getGroupByRect(t),c=this._getTempGroupByRect(t),s=this.objects[this.currRectId],u=this.mouse;u.e=o;var h=function(){if(t!==s||a){if(!a||!n){if(n){e._blurRect();var o=r.data.isOpen;return r&&!o&&(r.data.isOpen=!0),(!r||r&&o)&&(t.data.isEdit=!0),void e._addSelectedRect(t)}if(a){if(a){if(e._checkIsGroup(t)&&t.data.isOpen)return;r&&!r.data.isOpen&&(t=r),t.id in e.selectedRects?e._removeSelectedRect(t):e._addSelectedRect(t)}}else{if(!r&&!c)return e._blurRect(),e._addSelectedRect(t),void(e._checkIsGroup(t)&&(t.data.isOpen=!1));if(c)return void e._addSelectedRect(c);if(r){var i=r.data.isOpen;e._blurRect(),i?(e._addSelectedRect(t),r.data.isOpen=!0):e._addSelectedRect(r)}}}}else n&&(t.data.isEdit=!0)};h(),i&&this._updateCurrRectBySelected()},_blurRect:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.selectedRects={},this._hoverOffRect();var e=this.objects[this.currRectId];if(e&&(this.currRectId="",this._checkIsTempGroup(e)?this._unbindTempGroup(e):e.data.isEdit=!1,t)){var o=this._getGroupByRect(e);o&&(o.data.isOpen=!1)}},_hoverRect:function(t){if(t=this._safeObject(t),!this.mouse.ing){var e=t,o=this._getGroupByRect(t);o&&!o.data.isOpen&&(e=o),this._checkIsGroup(t)&&t.data.isOpen&&(e=null),this.hoverRectId=e?e.id:""}},_hoverOffRect:function(){this.hoverRectId=""},_getMousePoint:function(t){var e=document.querySelector(".proto-middle");return{left:t.clientX+e.scrollLeft-Kt,top:t.clientY+e.scrollTop-Nt}},_getRectBaseJsxProps:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;t=this._safeObject(t);var o=t.data,i=o.opacity/100;if(t.groupId){var n=this.objects[t.groupId].data.opacity/100;i*=n}return i=Pt(i,2),{style_left:Pt(o.left*e,0)+"px",style_top:Pt(o.top*e,0)+"px",style_width:Pt(o.width*e,0)+"px",style_height:Pt(o.height*e,0)+"px","style_z-index":o.zIndex,style_transform:"rotate(".concat(o.angle,"deg)"),style_opacity:i}},_updateCurrPage:function(t){t=this._safeObject(t),this.currPageId=t.id,this.currProject.currPageId=t.id,this._updateCurrRect()},_updateCurrRect:function(t){t=this._safeObject(t),this.currRectId=t?t.id:"",t&&t.groupId&&(this._safeObject(t.groupId).data.isOpen=!0)},_updateHoverRect:function(t){t=this._safeObject(t),this.hoverRectId=t?t.id:""},_flashHandler:function(){var t=this;this.handler.show=!1,clearTimeout(this.handler.timer),this.handler.timer=setTimeout((function(){t.handler.show=!0}),1e3)},_getCircleSize:function(){var t=this.mouse,e=Math.min(t.startLeft,t.currLeft),o=Math.min(t.startTop,t.currTop),i=Math.abs(t.currLeft-t.startLeft),n=Math.abs(t.currTop-t.startTop);return{left:e,top:o,width:i,height:n,right:e+i,bottom:o+n,angle:0}},_walkCurrPageRects:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._linkedListWalk(this.currPage,"rects",t,e)},_focusRectWhenCircle:function(){var t=this;if(this.currPage){var e=this._getCircleSize();e=At(Object(h["a"])({},e,{angle:0})),this._walkCurrPageRects((function(o){wt(At(o.data,t.scale),e)&&t._focusRect(o,{shiftKey:!0},!1)})),this._updateCurrRectBySelected()}},_showContextmenu:function(t,e){var o=this,i=0,n=[],a=[];"rect-item"===e?(i=310,n=["rect-重命名","rect-剪切","rect-复制","rect-删除",null,"rect-锁定","rect-解锁",null,"rect-置顶","rect-置底"]):"rect"===e?(i=340,n=["rect-剪切","rect-复制","rect-粘贴","rect-删除",null,"rect-锁定","rect-解锁",null,"rect-组合","rect-打散",null,"rect-置顶","rect-置底"]):"page"===e?(i=200,n=["page-重命名","page-新建子页面","page-删除"]):"canvas"===e&&(i=40,n=["rect-粘贴"]),a=n.map((function(t){return t?Object(h["a"])({},o._actionGet(t),{context:o}):t})),this.$contextmenu(t,i,a)},_updateCurrRectOpacity:function(t){this._checkIsTempGroup(this.currRect)&&this._getRectsByGroup(this.currRect).forEach((function(e){e.data.opacity=t})),this.currRect.data.opacity=t}}}),Go=o("6dd6"),Mo={data:function(){return{guide:{line:{top:new Set,left:new Set},show:{top:new Set,left:new Set}}}},methods:{_updateGuide:function(){var t=this,e=this.currRectId,o=this.currRect;this._clearGuideLine(),this._getRectsByPageDeep().forEach((function(i){var n=i.id,a=i.groupId,r=i.tempGroupId;if(n!==e&&a!==e&&r!==e&&(!t._checkIsGroup(i)||!t._getRectsByGroup(i).includes(o))&&(!a||t._getRectById(a).tempGroupId!==e)){var c=i.tempData;t.guide.line.left.add(c.rotateLeftTop.left).add(c.rotateRightTop.left).add(c.rotateRightBottom.left).add(c.rotateLeftBottom.left).add(c.center.left),t.guide.line.top.add(c.rotateLeftTop.top).add(c.rotateRightTop.top).add(c.rotateRightBottom.top).add(c.rotateLeftBottom.top).add(c.center.top)}}))},_checkRectPointGuide:function(t,e,o,i){var n=5,a=this.guide.line.left,r=this.guide.line.top,c=this.guide.show.left,s=this.guide.show.top,u=t.tempData,h=At(t.data),d=h[e.name],p=u[e.name],l=!1,f={left:Pt(p.left+o),top:Pt(p.top+i)},_=function(t,e){var o,i=Object(Go["a"])(t);try{for(i.s();!(o=i.n()).done;){var n=o.value;if(Math.abs(n-e)<1)return{isIn:!0,value:n-e}}}catch(a){i.e(a)}finally{i.f()}return{isIn:!1,value:0}};if(e.left){var m=_(a,d.left);m.isIn&&(Math.abs(f.left-d.left)<=n&&(o=d.left-p.left+m.value,l=!0),c.add(d.left+m.value))}if(e.top){var v=_(r,d.top);v.isIn&&(Math.abs(f.top-d.top)<=n&&(i=d.top-p.top+v.value,l=!0),s.add(d.top+v.value))}return[o,i,l]},_checkGuideOnMove:function(t,e,o){var i=this;return this._clearGuideShow(),["rotateLeftTop","rotateRightTop","rotateRightBottom","rotateLeftBottom","center"].forEach((function(n){var a={name:n,top:!0,left:!0},r=i._checkRectPointGuide(t,a,e,o),c=Object(mt["a"])(r,2);e=c[0],o=c[1]})),[e,o]},_checkGuideOnResize:function(t,e,o,i){this._clearGuideShow();var n=t.data.angle;if(0===n){var a={a:{name:"rotateLeftTop",left:!0,top:!0},b:{name:"rotateRightTop",left:!0,top:!0},c:{name:"rotateRightBottom",left:!0,top:!0},d:{name:"rotateLeftBottom",left:!0,top:!0},ab:{name:"rotateLeftTop",left:!1,top:!0},bc:{name:"rotateRightTop",left:!0,top:!1},cd:{name:"rotateRightBottom",left:!1,top:!0},ad:{name:"rotateLeftBottom",left:!0,top:!1}}[e],r=this._checkRectPointGuide(t,a,o,i),c=Object(mt["a"])(r,2);o=c[0],i=c[1]}return[o,i]},_checkGuideOnRotate:function(t,e,o,i){var n=5;return e%90===0&&(Math.abs(o-e)<=n&&(i=e-t),0===e&&Math.abs(o-360)<=n&&(i=e-t)),i},_clearGuideLine:function(){this.guide.line.left=new Set,this.guide.line.top=new Set},_clearGuideShow:function(){this.guide.show.left=new Set,this.guide.show.top=new Set}}},To={data:function(){var t=this,e=this;return{actionMap:{"rect-重命名":{checkF:"_actionCanCurrRect",doF:function(){t.currRect.data.isNameEdit=!0,t.renderHook++}},"rect-全选":{doF:"_actionRectSelectAll",hotkey:"command + a, ctrl + a"},"rect-剪切":{checkF:"_actionCanCurrRect",doF:"_actionRectCut",hotkey:"command + x, ctrl + x"},"rect-复制":{checkF:"_actionCanCurrRect",doF:"_actionRectCopy",hotkey:"command + c, ctrl + c"},"rect-粘贴":{checkF:"_actionCanRectPaste",doF:"_actionRectPaste",hotkey:"command + v, ctrl + v"},"rect-删除":{checkF:"_actionCanCurrRect",doF:"_actionRectDelete",hotkey:"backspace"},"rect-锁定":{checkF:"_actionCanRectLock",doF:"_actionRectLock",hotkey:"command + l, ctrl + l"},"rect-解锁":{checkF:"_actionCanRectUnLock",doF:"_actionRectUnLock",hotkey:"command + shift + l, ctrl + shift + l"},"rect-组合":{checkF:"_actionCanGroup",doF:"_actionGroup",hotkey:"command + g, ctrl + g"},"rect-打散":{checkF:"_actionCanUnGroup",doF:"_actionUnGroup",hotkey:"command + shift + g, ctrl + shift + g"},"rect-上移":{checkF:"_actionCanCurrRect",doF:"_actionRectMoveUp",hotkey:"command + alt + up, ctrl + alt + up"},"rect-下移":{checkF:"_actionCanCurrRect",doF:"_actionRectMoveDown",hotkey:"command + alt + down, ctrl + alt + down"},"rect-置顶":{checkF:"_actionCanCurrRect",doF:"_actionRectMoveTop",hotkey:"command + shift + up, ctrl + shift + up"},"rect-置底":{checkF:"_actionCanCurrRect",doF:"_actionRectMoveBottom",hotkey:"command + shift + down, ctrl + shfit + down"},"rect-keyupMove":{checkF:"_actionCanCurrRect",doF:"_actionRectKeyupMove",hotkey:"up"},"rect-keydownMove":{checkF:"_actionCanCurrRect",doF:"_actionRectKeydownMove",hotkey:"down"},"rect-keyleftMove":{checkF:"_actionCanCurrRect",doF:"_actionRectKeyleftMove",hotkey:"left"},"rect-keyrightMove":{checkF:"_actionCanCurrRect",doF:"_actionRectKeyrightMove",hotkey:"right"},"page-重命名":{checkF:"",doF:function(){e.currPage.data.isNameEdit=!0,t.renderHook++}},"page-新建子页面":{checkF:"",doF:function(){e._actionPageCreate(e.currPage.id)}},"page-删除":{checkF:"_actionCanPageDelete",doF:"_actionPageDelete"},"sys-撤销":{checkF:function(){return!e.mouse.ing&&e._historyCanBack()},doF:"_historyBack",hotkey:"command + z, ctrl + z"},"sys-重做":{checkF:function(){return!e.mouse.ing&&e._historyCanGo()},doF:"_historyGo",hotkey:"command + shift + z, ctrl + shift + z"}}}},methods:{_actionGetInfo:function(){var t=this.objects[this.currRectId],e=t&&this._checkIsTempGroup(t),o=t&&this._checkIsGroup(t);return{rect:t,isTempGroup:e,isGroup:o}},_actionPageCreate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currProjectId,e=this._createPage(t);e.data.isNameEdit=!0,this._updateCurrPage(e),this._historyPush()},_actionCanPageDelete:function(){var t=this.currPage.parentId===this.currProject.id&&!this.currProject.pages.tailId;return!t},_actionPageDelete:function(){this._removePage(),this._historyPush()},_actionRectKeyupMove:function(){this._updateRectTempData(this.currRectId),this._move(this.currRectId,0,-1,!1),this._historyPush()},_actionRectKeydownMove:function(){this._updateRectTempData(this.currRectId),this._move(this.currRectId,0,1,!1),this._historyPush()},_actionRectKeyleftMove:function(){this._updateRectTempData(this.currRectId),this._move(this.currRectId,-1,0,!1),this._historyPush()},_actionRectKeyrightMove:function(){this._updateRectTempData(this.currRectId),this._move(this.currRectId,1,0,!1),this._historyPush()},_actionRectSelectAll:function(){var t=this;this._blurRect(),this._walkCurrPageRects((function(e){t._focusRect(e,{shiftKey:!0},!1)})),this._updateCurrRectBySelected()},_actionCanGroup:function(){return this._actionGetInfo().isTempGroup},_actionGroup:function(){var t=this,e=this.objects[this.currRectId],o=this._createRect("group"),i=this._getRectsByRectDeep(e);this._bindGroup(o,i),i.forEach((function(e){t._removeSelectedRect(e)})),this._addSelectedRect(o),this._updateCurrRectBySelected(),this._historyPush()},_actionCanUnGroup:function(){return this._actionGetInfo().isGroup},_actionUnGroup:function(){var t=this,e=this.objects[this.currRectId],o=this._getRectsByRectDeep(e);this._unbindGroup(e),o.forEach((function(e){t._addSelectedRect(e)})),this._removeSelectedRect(e),this._updateCurrRectBySelected(),this._historyPush()},_actionRectDelete:function(){var t=this,e=this.objects[this.currRectId];this._getRectsByRectDeep(e).forEach((function(e){t._removeRectById(e.id)})),this._updateCurrRect(),this._historyPush()},_actionRectCopy:function(){var t=this;this.clipboard.count=0,this.clipboard.data=this._getUnLockRectsBySelected().map((function(e){return t._cloneRectDeep(e)}))},_actionRectCut:function(){this._actionRectCopy(),this._actionRectDelete()},_actionCanRectPaste:function(){return this.clipboard.data.length>0},_actionRectPaste:function(){var t=this,e=++this.clipboard.count,o=20*e;this._clearSelectedRects(),this.clipboard.data.map((function(e){var o=t._createRectByConfig(e);return t._addSelectedRect(o),o})),this._updateCurrRectBySelected(),this._updateRectTempData(this.currRectId),this._move(this.currRectId,o,o),this._clearGuideShow(),this._historyPush()},_actionCanCurrRect:function(){return this.currRectId},_actionRectMoveUp:function(){var t=this,e=[];e=this.tempGroupId?this._getRectsByGroup(this.currRectId):[this.objects[this.currRectId]],e.forEach((function(e){var o=t.objects[e.parentId];t._linkedListMoveUp(o,e)})),this._historyPush()},_actionRectMoveDown:function(){var t=this,e=[];e=this.tempGroupId?this._getRectsByGroup(this.currRectId):[this.objects[this.currRectId]],e.forEach((function(e){var o=t.objects[e.parentId];t._linkedListMoveDown(o,e)})),this._historyPush()},_actionRectMoveTop:function(){var t=this,e=[];e=this.tempGroupId?this._getRectsByGroup(this.currRectId):[this.objects[this.currRectId]],e.forEach((function(e){var o=t.objects[e.parentId];t._linkedListMoveTop(o,e)})),this._historyPush()},_actionRectMoveBottom:function(){var t=this,e=[];e=this.tempGroupId?this._getRectsByGroup(this.currRectId):[this.objects[this.currRectId]],e.forEach((function(e){var o=t.objects[e.parentId];t._linkedListMoveBottom(o,e)})),this._historyPush()},_actionCanRectLock:function(){return this._getUnLockRectsBySelected().length},_actionCanRectUnLock:function(){return this._getLockRectsBySelected().length},_actionRectLock:function(){for(var t in this.selectedRects)t=this._safeObject(t),t.data.isLock=!0;this._updateCurrRectBySelected(),this._historyPush()},_actionRectUnLock:function(){for(var t in this.selectedRects)t=this._safeObject(t),t.data.isLock=!1;this._updateCurrRectBySelected(),this._historyPush()},_actionCanRectAlign:function(){return this._actionGetInfo().isTempGroup},_actionRectAlignLeft:function(){var t=this;this._updateRectTempData(this.currRect);var e=this.currRect.tempData.left;this._getRectsByGroup(this.currRect).forEach((function(o){var i=e-o.tempData.minRotateLeft;t._move(o,i,0,!1)})),this._updateGroupSize(this.currRect)},_actionRectAlignLeftRight:function(){var t=this;this._updateRectTempData(this.currRect);var e=this.currRect.tempData.center.left;this._getRectsByGroup(this.currRect).forEach((function(o){var i=e-o.tempData.center.left;t._move(o,i,0,!1)})),this._updateGroupSize(this.currRect)},_actionRectAlignRight:function(){var t=this;this._updateRectTempData(this.currRect);var e=this.currRect.tempData.right;this._getRectsByGroup(this.currRect).forEach((function(o){var i=e-o.tempData.maxRotateLeft;t._move(o,i,0,!1)})),this._updateGroupSize(this.currRect)},_actionRectAlignTop:function(){var t=this;this._updateRectTempData(this.currRect);var e=this.currRect.tempData.top;this._getRectsByGroup(this.currRect).forEach((function(o){var i=e-o.tempData.minRotateTop;t._move(o,0,i,!1)})),this._updateGroupSize(this.currRect)},_actionRectAlignTopBottom:function(){var t=this;this._updateRectTempData(this.currRect);var e=this.currRect.tempData.center.top;this._getRectsByGroup(this.currRect).forEach((function(o){var i=e-o.tempData.center.top;t._move(o,0,i,!1)})),this._updateGroupSize(this.currRect)},_actionRectAlignBottom:function(){var t=this;this._updateRectTempData(this.currRect);var e=this.currRect.tempData.bottom;this._getRectsByGroup(this.currRect).forEach((function(o){var i=e-o.tempData.maxRotateTop;t._move(o,0,i,!1)})),this._updateGroupSize(this.currRect)},_actionCanRectEqualSpace:function(){var t=this._actionGetInfo().isTempGroup;if(!t)return!1;var e=this._getRectsByGroup(this.currRect);return e.length>2},_actionRectEqualSpaceX:function(){var t=this;this._updateRectTempData(this.currRect);var e=this.currRect.data.width,o=this._getRectsByGroup(this.currRect),i=0;o.forEach((function(t){i+=t.tempData.maxRotateLeft-t.tempData.minRotateLeft}));var n=(e-i)/(o.length-1),a=o.sort((function(t,e){return t.tempData.minRotateLeft-e.tempData.minRotateLeft}));a.slice(0).forEach((function(e,o){if(0!==o){var i=a[o-1].tempData.maxRotateLeft+n-e.tempData.minRotateLeft;t._move(e,i,0,!1),t._updateRectTempData(e)}})),this._updateGroupSize(this.currRect)},_actionRectEqualSpaceY:function(){var t=this;this._updateRectTempData(this.currRect);var e=this.currRect.data.height,o=this._getRectsByGroup(this.currRect),i=0;o.forEach((function(t){i+=t.tempData.maxRotateTop-t.tempData.minRotateTop}));var n=(e-i)/(o.length-1),a=o.sort((function(t,e){return t.tempData.minRotateTop-e.tempData.minRotateTop}));a.slice(0).forEach((function(e,o){if(0!==o){var i=a[o-1].tempData.maxRotateTop+n-e.tempData.minRotateTop;t._move(e,0,i,!1),t._updateRectTempData(e)}})),this._updateGroupSize(this.currRect)},_actionGet:function(t){var e=this.actionMap[t],o=e.checkF||function(){return!0};"string"===typeof o&&(o=this[o]);var i=e.doF||function(){};"string"===typeof i&&(i=this[i]);var n=t.split("-")[1]||"unknow";return Object(h["a"])({},e,{doF:i,checkF:o,text:n})},_actionSetHotKey:function(){var t=this,e=function(e){var o=t._actionGet(e),i=o.checkF,n=o.doF,a=o.hotkey;a&&a.split(",").forEach((function(e){t._hotkey(e,(function(e){i.call(t)&&(e.preventDefault(),n.call(t))}))}))};for(var o in this.actionMap)e(o)}},mounted:function(){this._actionSetHotKey()}},Lo={data:function(){return{mouse:{ing:!1,realIng:!1,startLeft:0,startTop:0,currLeft:0,currTop:0,eventType:"",resizerDir:"",createType:"",e:{}}}},methods:{},created:function(){var t=this,e=this,o=this.mouse,i=function(t){f.$emit("windowMouseDown",t)},n=function(i){var n=t.objects[t.currRectId];if(o.ing){o.realIng=!0,o.e=i;var a=t.scale,r=t._getMousePoint(i),c=o.currLeft=r.left,s=o.currTop=r.top,u=o.eventType,h=(c-o.startLeft)/a,d=(s-o.startTop)/a;if("resize"===u)e._resize(h,d);else if("rotate"===u){var p={left:o.currLeft,top:o.currTop};e._rotate(p)}else if("move"===u)e._move(n,h,d);else if("create"===u&&i.clientX>Kt&&i.clientY>Nt){var l=o.createType,f=t.rectConfig[l],_=t._createRect(l);t._updateRectTempData(_),t._moveTo(_,Pt(c-f.width/2),Pt(s-f.height/2)),o.eventType="move",o.startLeft=c,o.startTop=s,e._focusRect(_,i)}}},a=function(){o.ing&&("circle"===o.eventType&&t._focusRectWhenCircle(),o.ing=!1,o.eventType="",o.e={},t._clearGuideShow(),o.realIng&&t._historyPush(),o.realIng=!1)};this.windowEventAdd("mousedown",i),this.windowEventAdd("mousemove",n),this.windowEventAdd("mouseup",a),this.windowEventAdd("contextmenu",(function(t){t.preventDefault()})),f.$on("windowMouseDown",(function(e){var i=t._getMousePoint(e);o.startLeft=o.currLeft=i.left,o.startTop=o.currTop=i.top,t.currRectId||"move"!==t.mouse.eventType?o.ing=!0:o.ing=!1}))},mounted:function(){var t=this,e=this.$refs.middle;e.addEventListener("scroll",(function(){t._renderRule()}))}},So=(o("cc6e"),"undefined"!==typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0),Bo={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,"⇪":20,",":188,".":190,"/":191,"`":192,"-":So?173:189,"=":So?61:187,";":So?59:186,"'":222,"[":219,"]":221,"\\":220},Co={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},Do=function(t){return"number"===typeof t?t:(t=t.trim(),Bo[t.toLowerCase()]||Co[t.toLowerCase()]||t.toUpperCase().charCodeAt(0))},zo={data:function(){return{hotkey:{data:{},disabled:!1}}},methods:{_hotkey:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this.hotkey.data[this._hotkeyCode(t.split("+"))]={hotkey:t,keydown:e,keyup:o}},_hotkeyOff:function(){this.hotkey.disabled=!0},_hotkeyOn:function(){this.hotkey.disabled=!1},_hotkeyCode:function(t){return t.map((function(t){return Do(t)})).sort().join("+")},_hotkeyEvent:function(t){if("input"!==t.target.tagName.toLowerCase()&&!this.hotkey.disabled){var e={ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey,command:t.metaKey},o=[];for(var i in e)e[i]&&o.push(i);var n=t.type,a=this._hotkeyCode([t.keyCode].concat(o));if(a in this.hotkey.data){var r=this.hotkey.data[a];r[n](t)}}}},mounted:function(){var t=this;this.windowEventAdd("keydown",(function(e){t._hotkeyEvent(e)}))}},Eo={methods:{_onPageShow:function(){},_onPageHide:function(){}},watch:{$route:function(t,e){t.path===e.path?this._onPageShow():this._onPageHide()}},mounted:function(){this._onPageShow()},beforeDestroy:function(){this._onPageHide()}},Ao={name:"design",mixins:[_t,ge,be,ye,wo,Po,Mo,To,st,ut,Lo,zo,Eo,Y],created:function(){},methods:{},render:function(t){return this.renderHook,this._renderMain(t)}},Fo=Ao,Ho=(o("9a8d"),Object(I["a"])(Fo,qt,Yt,!1,null,null,null)),Wo=Ho.exports;s["a"].use(F),s["a"].use(u["a"]),s["a"].component("v-icon",H["a"]),s["a"].config.productionTip=!1;var $o=[{path:"/",component:Wo,name:"design"}],Ko=new u["a"]({routes:$o});new s["a"]({router:Ko}).$mount("#app")},"7eba":function(t,e,o){},"8ef3":function(t,e,o){},"9a8d":function(t,e,o){"use strict";var i=o("8ef3"),n=o.n(i);n.a},ec8e:function(t,e,o){}});
//# sourceMappingURL=app.e1e8587f.js.map