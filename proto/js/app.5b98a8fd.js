(function(t){function e(e){for(var a,r,c=e[0],s=e[1],h=e[2],p=0,u=[];p<c.length;p++)r=c[p],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&u.push(i[r][0]),i[r]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a]);d&&d(e);while(u.length)u.shift()();return n.push.apply(n,h||[]),o()}function o(){for(var t,e=0;e<n.length;e++){for(var o=n[e],a=!0,c=1;c<o.length;c++){var s=o[c];0!==i[s]&&(a=!1)}a&&(n.splice(e--,1),t=r(r.s=o[0]))}return t}var a={},i={app:0},n=[];function r(e){if(a[e])return a[e].exports;var o=a[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=a,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(o,a,function(e){return t[e]}.bind(null,a));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/proto/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=e,c=c.slice();for(var h=0;h<c.length;h++)e(c[h]);var d=s;n.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d76")},"113d":function(t,e,o){"use strict";var a=o("7eba"),i=o.n(a);i.a},2199:function(t,e,o){"use strict";var a=o("ec8e"),i=o.n(a);i.a},"56d76":function(t,e,o){"use strict";o.r(e);var a={};o.r(a),o.d(a,"rect",(function(){return ze})),o.d(a,"circle",(function(){return Ue})),o.d(a,"text",(function(){return Fe})),o.d(a,"group",(function(){return Ee})),o.d(a,"tempGroup",(function(){return Ae})),o.d(a,"line",(function(){return We}));o("81f2"),o("c9ae"),o("fe22"),o("f8b3");var i,n,r,c,s=o("e42f"),h=o("f0ce"),d=(o("7c49"),o("83d7"),o("5515"),o("83ad")),p=o("a016"),u=o.n(p),l=o("30bc"),f=new s["a"],_=u.a.div,m=u.a.a,v={components:{"sketch-picker":l["Sketch"]},data:function(){return{value:"#ffffff",isOpen:!1,left:0,top:0,onChange:function(){}}},methods:{open:function(t,e,o){this.value=t,this.onChange=o,this.left=e.left,this.top=e.top,this.isOpen=!0},close:function(){this.isOpen=!1}},created:function(){var t=this;f.$on("windowMouseDown",(function(){t.close()}))},render:function(t){u.a.h=t;var e=this,o={"class_sp-color-alert":!0,class_card:!0,style_left:this.left-260+"px",style_top:this.top+"px",on_click:function(t){t.stopPropagation()},on_mousedown:function(t){t.stopPropagation()}};this.isOpen||(o=Object(d["a"])({},o,{style_display:"none"}));var a=_(o,_(".card-header",m(".btn btn-clear float-right",{"attrs_aria-label":"Close",on_click:function(t){e.close(),t.stopPropagation()}}),_(".card-title","颜色设置")),_({"class_card-body":!0},u.a.bind("sketch-picker")({props_value:this.value,on_input:function(t){e.onChange(t)}})));return a}},g=function(t,e,o){if(!i){var a=s["a"].extend(v);i=new a,i.$mount(document.createElement("div")),document.body.appendChild(i.$el)}i.open(t,e,o)},b={name:"SpColor",props:{value:String,disabled:{type:Boolean,default:!1}},render:function(t){u.a.h=t;var e=this,o={"class_sp-color":!0,"style_background-color":this.value};return this.disabled||(o=Object(d["a"])({},o,{on_click:function(t){t.stopPropagation();var o=e.$el.getClientRects()[0];g(e.value,{left:o.x,top:o.y},(function(t){e.$emit("change",t)}))}})),_(o)}},R=b,y=R,j=(o("113d"),o("2d70")),I=Object(j["a"])(y,n,r,!1,null,null,null),P=I.exports,k=(o("11bc"),o("963d"),o("7787")),O=u.a.div,x=u.a.li,w=u.a.a,G={name:"SpContextMenu",props:{},data:function(){return{isOpen:!1,actions:[],e:{},height:0}},methods:{open:function(t,e,o){this.isOpen=!0,this.e=t,this.height=e,this.actions=o},close:function(){this.isOpen=!1},_renderDivider:function(){return x(".divider")},_renderItem:function(t){if(!t)return this._renderDivider();var e=t.checkF,o=t.doF,a=t.text,i=t.context,n={};return n=e.call(i)?{on_click:function(){o.call(i)}}:{"class_contextmenu-item-disalbed":!0},x(".menu-item",n,w({attrs_href:"javascript:;"},a))},_renderMain:function(){var t=this,e=this,o=window.innerWidth,a=window.innerHeight,i=180,n=this.height,r=this.e,c=r.clientX,s=r.clientY;c=Math.min(c,o-i-10),s=Math.min(s,a-n-10);var h=this.actions.map((function(e){return t._renderItem(e)})),p={style_left:c+"px",style_top:s+"px",key:"contextmenu",on_mousedown:function(t){t.stopPropagation()},on_click:function(){e.close()}};return this.isOpen||(p=Object(d["a"])({},p,{style_display:"none"})),O.apply(void 0,[".contextmenu menu",p].concat(Object(k["a"])(h)))}},created:function(){var t=this;f.$on("windowMouseDown",(function(){t.close()}))},render:function(t){return u.a.h=t,this._renderMain()}};s["a"].prototype.$contextmenu=function(){var t;if(!c){var e=s["a"].extend(G);c=new e,c.$mount(document.createElement("div")),document.body.appendChild(c.$el)}(t=c).open.apply(t,arguments)};var M,T,D,L,S=G,B=S,C=(o("2199"),Object(j["a"])(B,M,T,!1,null,null,null)),z=C.exports,U=[P,z],E=function(t){U.forEach((function(e){t.component(e.name,e)}))},A={install:E},F=(o("bcd0"),o("d0e5")),W=(o("eca2"),o("4b47"),o("9b90"),o("481e"),o("c0b6"),o("ef52"),o("878e")),H={data:function(){return{history:{diff:[],list:[],cursor:-1}}},methods:{_historyInit:function(){this.history.diff=[],this.history.list=[],this.cursor=-1},_historyIsSameValue:function(t,e){return JSON.stringify(t)===JSON.stringify(e)},_historyDiffAdd:function(t,e,o){if(!["hoverRectId"].includes(t)&&!this._historyIsSameValue(e,o)){var a=Object(W["cloneDeep"])(e),i=Object(W["cloneDeep"])(o),n=this.history,r=n.diff.findIndex((function(e){return e.longProp===t})),c=-1!==r;if(c){var s=n.diff[r];s["newValue"]=i,n.diff.splice(r,1),this._historyIsSameValue(i,s.oldValue)||n.diff.push(s)}else this.history.diff.push({longProp:t,oldValue:a,newValue:i})}},_historyPush:function(){if(this.history.diff.length){this._historyCanGo()&&(this.history.list=this.history.list.slice(0,this.history.cursor+1));var t=this.history.diff;this.history.list.push(t),this.history.diff=[],this.history.cursor++,this._historyCommitChange(t)}},_historyBack:function(){var t=this;if(this._historyCanBack()){var e=this.history.list[this.history.cursor--];Object(W["forEachRight"])(e,(function(e){var o=e.longProp,a=e.oldValue;t._parseLongProp(o).set(Object(W["cloneDeep"])(a))})),this._historyCommitChange(e,"left")}},_historyGo:function(){var t=this;if(this._historyCanGo()){var e=this.history.list[++this.history.cursor];Object(W["forEach"])(e,(function(e){var o=e.longProp,a=e.newValue;t._parseLongProp(o).set(Object(W["cloneDeep"])(a))})),this._historyCommitChange(e)}},_historyCanGo:function(){return this.history.cursor<this.history.list.length-1},_historyCanBack:function(){return this.history.cursor>-1},_historyCommitChange:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"right";t=Object(W["cloneDeep"])(t);var o={},a="right"===e,i=a?W["forEach"]:W["forEachRight"];i(t,(function(t){var e=t.longProp,i=t.oldValue,n=t.newValue,r=e.split("."),c=r[0];if(["objects"].includes(c)){var s=o,h=r.slice(-1)[0];r.slice(1,-1).forEach((function(t){t in s||(s[t]={}),s=s[t]})),s[h]=a?n:i}})),this._dbSave(o)}}},$={methods:{_command:function(t,e){var o=this._parseLongProp(t),a=o.get();o.set(e),this._historyDiffAdd(t,a,e)},_commandRectAdd:function(t){t=this._safeObject(t);var e="objects.".concat(t.id);this._command(e,t)},_commandRectDelete:function(t){t=this._safeObject(t),this._commandObjectDelete(t)},_commandRectPropUpdate:function(t,e,o){t=this._safeObject(t),this._commandObjectPropUpdate(t,e,o)},_commandRectDataPropUpdate:function(t,e,o){t=this._safeObject(t),this._commandObjectDataPropUpdate(t,e,o)},_commandPropUpdate:function(t,e){var o="".concat(t);this._command(o,e)},_commandPageAdd:function(t){t=this._safeObject(t);var e="objects.".concat(t.id);this._command(e,t)},_commandObjectDelete:function(t){t=this._safeObject(t);var e="objects.".concat(t.id,".isDelete");this._command(e,!0)},_commandProjectAdd:function(t){t=this._safeObject(t);var e="objects.".concat(t.id);this._command(e,t)},_commandObjectPropUpdate:function(t,e,o){t=this._safeObject(t);var a="objects.".concat(t.id,".").concat(e);this._command(a,o)},_commandObjectDataPropUpdate:function(t,e,o){t=this._safeObject(t);var a="objects.".concat(t.id,".data.").concat(e);this._command(a,o)}}},K=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rects",a=t[o];if(a.headId){if(!a.tailId){this._commandObjectPropUpdate(t,"".concat(o,".tailId"),e.id);var i=this.objects[a.headId],n=this.objects[a.tailId];return this._commandObjectPropUpdate(i,"nextId",n.id),void this._commandObjectPropUpdate(n,"prevId",i.id)}var r=this.objects[a.tailId];this._commandObjectPropUpdate(t,"".concat(o,".tailId"),e.id),this._commandObjectPropUpdate(r,"nextId",e.id),this._commandObjectPropUpdate(e,"prevId",r.id)}else this._commandObjectPropUpdate(t,"".concat(o,".headId"),e.id)},N=function(t,e,o){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rects",i=e.prevId,n=this.objects[i],r=t[a];i?(this._commandObjectPropUpdate(o,"prevId",i),this._commandObjectPropUpdate(n,"nextId",o.id)):(this._commandObjectPropUpdate(t,"".concat(a,".headId"),o.id),r.tailId||this._commandObjectPropUpdate(t,"".concat(a,".tailId"),e.id)),this._commandObjectPropUpdate(o,"nextId",e.id),this._commandObjectPropUpdate(e,"prevId",o.id)},X=function(t,e,o){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rects",i=e.nextId,n=this.objects[i];i?(this._commandObjectPropUpdate(o,"nextId",i),this._commandObjectPropUpdate(n,"prevId",o.id)):this._commandObjectPropUpdate(t,"".concat(a,".tailId"),o.id),this._commandObjectPropUpdate(o,"prevId",e.id),this._commandObjectPropUpdate(e,"nextId",o.id)},q=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rects",a=t[o],i=e.prevId,n=e.nextId;if(this._commandObjectPropUpdate(e,"nextId",""),this._commandObjectPropUpdate(e,"prevId",""),i){var r=this.objects[i];this._commandObjectPropUpdate(r,"nextId",n)}else this._commandObjectPropUpdate(t,"".concat(o,".headId"),n);if(n){var c=this.objects[n];this._commandObjectPropUpdate(c,"prevId",i)}else this._commandObjectPropUpdate(t,"".concat(o,".tailId"),i);a.tailId===a.headId&&this._commandObjectPropUpdate(t,"".concat(o,".tailId"),"")},V=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rects",a=e.nextId;if(a){var i=this.objects[a];this._linkedListRemove(t,e,o),this._linkedListInsertAfter(t,i,e,o)}},Y=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rects",a=e.prevId;if(a){var i=this.objects[a];this._linkedListRemove(t,e,o),this._linkedListInsertBefore(t,i,e,o)}},J=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rects",a=t[o],i=a.tailId;if(i&&i!==e.id){var n=this.objects[i];this._linkedListRemove(t,e,o),this._linkedListInsertAfter(t,n,e,o)}},Q=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rects",a=t[o],i=a.headId;if(i!==e.id){var n=this.objects[i];this._linkedListRemove(t,e,o),this._linkedListInsertBefore(t,n,e,o)}},Z=function(t){var e=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rects",a=arguments.length>2?arguments[2]:void 0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=e.objects[n[o].headId];while(c){a(c,r);var s=!1===c.data.isExpand;i&&!s&&c[o]&&c[o]["headId"]&&t(c,r+1),c=e.objects[c.nextId]}};n(t)},tt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rects",o=[],a=0;return this._linkedListWalk(t,e,(function(t){t.tempIndex=a++,o.push(t)})),o},et=function(t,e){var o=t.id,a=e.parentId;while(a){if(a===o)return!0;a=this.objects[a].parentId}return!1},ot={methods:{_linkedListInsertBefore:N,_linkedListInsertAfter:X,_linkedListRemove:q,_linkedListAppend:K,_linkedListGetObjects:tt,_linkedListMoveUp:V,_linkedListMoveDown:Y,_linkedListMoveTop:J,_linkedListMoveBottom:Q,_linkedListWalk:Z,_linkedListCheckIsParent:et}},at={data:function(){return{windowEventListener:{}}},methods:{windowEventAdd:function(t,e){window.addEventListener(t,e),t in this.windowEventListener||(this.windowEventListener[t]=[]),this.windowEventListener[t].push(e)}},beforeDestroy:function(){var t=this,e=function(e){t.windowEventListener[e].forEach((function(t){window.removeEventListener(e,t)}))};for(var o in this.windowEventListener)e(o)}},it=(o("b4fc"),o("0b4e"),o("56d7"),o("3191")),nt=o("9e4d"),rt=o.n(nt),ct=o("b875"),st=o.n(ct),ht={computed:{},methods:{_dbInit:function(){var t=this;return Object(it["a"])(regeneratorRuntime.mark((function e(){var o,a,i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!D){e.next=2;break}return e.abrupt("return");case 2:return o=st()(),D=o.promise,L=rt.a.createInstance({name:"proto-design",storeName:"object"}),e.next=7,L.ready();case 7:return e.next=9,L.keys();case 9:if(a=e.sent,a.length){e.next=21;break}return console.log("database init"),i=t._createProjectBase(),n=t._createPageBase(i.id),i.pages.headId=n.id,i.currPageId=n.id,e.next=18,t._dbSaveItem(i.id,i);case 18:return e.next=20,t._dbSaveItem(n.id,n);case 20:console.log("database init over");case 21:o.resolve();case 22:case"end":return e.stop()}}),e)})))()},_dbSaveItem:function(t,e){return Object(it["a"])(regeneratorRuntime.mark((function o(){var a,i;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(e=Object(W["cloneDeep"])(e),!e){o.next=7;break}if("rect-tempGroup"!==e.type){o.next=5;break}return console.log("不存储临时组"),o.abrupt("return");case 5:e["tempGroupId"]&&(e["tempGroupId"]=""),e.data&&e.data.isOpen&&(e.data.isOpen=!1);case 7:return o.next=9,L.ready();case 9:if(e){o.next=14;break}return o.next=12,L.removeItem(t);case 12:o.next=24;break;case 14:return o.next=16,L.getItem(t);case 16:if(o.t0=o.sent,o.t0){o.next=19;break}o.t0={};case 19:if(a=o.t0,i=Object(W["merge"])(a,e),!i.type){o.next=24;break}return o.next=24,L.setItem(t,i);case 24:case"end":return o.stop()}}),o)})))()},_dbSave:function(t){var e=this;return Object(it["a"])(regeneratorRuntime.mark((function o(){var a;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:console.log("dbSave",t),o.t0=regeneratorRuntime.keys(t);case 2:if((o.t1=o.t0()).done){o.next=8;break}return a=o.t1.value,o.next=6,e._dbSaveItem(a,t[a]);case 6:o.next=2;break;case 8:case"end":return o.stop()}}),o)})))()},_dbAll:function(){var t=this;return Object(it["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("加载所有数据..."),e.next=3,D;case 3:return e.next=5,L.iterate((function(e,o){t.objects[o]=e,"project"===e.type&&(t.currProjectId=e.id)}));case 5:t.currPageId=t.currProject.currPageId,console.log("加载所有数据完毕");case 7:case"end":return e.stop()}}),e)})))()}},created:function(){this._dbInit(),this._dbAll()},mounted:function(){return Object(it["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))()}},dt=o("ca5c"),pt=(o("4b08"),o("999e"),o("5c9e"),o("367d")),ut=54,lt=200,ft=16,_t=200,mt={a:ut,b:lt,c:ft,d:_t},vt=window.getComputedStyle(document.body).font,gt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vt,o=bt.span;if(!o){o=bt.span=document.createElement("div"),o.style.display="inline-block";var a=document.createElement("div");a.style.display="block",a.style.position="absolute",a.style.top="-10000px",a.style.left="200px",a.style.width="100000px",a.appendChild(o),document.body.appendChild(a)}o.style.font=e,o.innerHTML=t;var i=window.getComputedStyle(o);return{width:Math.ceil(parseFloat(i.width)),height:Math.ceil(parseFloat(i.height))}},bt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vt;return gt(t,e).width},Rt=function(t,e){var o=[],a=t.ra,i=t.rb,n=t.rc,r=t.rd;[a,i,n,r].forEach((function(t){var a=xt(t,e).xp;o.push(a)}));var c=Math.min.apply(null,o),s=Math.max.apply(null,o);return{start:c,end:s,length:s-c}},yt=function(t,e){var o=!0,a=[t.angle,t.angle+90,e.angle,e.angle+90];return a.some((function(a){var i=Rt(t,a),n=Rt(e,a);if(Math.max(i.end,n.end)-Math.min(i.start,n.start)>i.length+n.length)return o=!1,!0})),o},jt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,o=Math.pow(10,e);return Math.round(t*o)/o},It=function(t){return t*(Math.PI/180)},Pt=function(t){return t/Math.PI*180},kt=function(t,e,o){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];o=parseInt(o),a||(o=360-o);var i=It(o),n=e.left-t.left,r=t.top-e.top,c=Math.cos(i)*n+Math.sin(i)*r,s=Math.cos(i)*r-Math.sin(i)*n;return{left:jt(c+t.left),top:jt(t.top-s)}},Ot=function(t,e,o){if(o%180===0)return{left:t.left,top:e.top};var a=It(o),i=It(90-o),n=t.left+Math.tan(a)*t.top,r=e.left-Math.tan(i)*e.top,c=r+Math.cos(a)*Math.cos(a)*(n-r),s=Math.sin(a)*Math.cos(a)*(n-r);return{left:jt(c),top:jt(s)}},xt=function(t,e){var o=It(e);return{xp:t.left+Math.tan(o)*t.top,yp:t.top-Math.tan(o)*t.left}},wt=function(t,e){var o,a,i,n,r=Number.MAX_VALUE,c=r,s=-r,h=-c;return t.forEach((function(t){var d=xt(t,e),p=d.xp,u=d.yp;p<r&&(r=p,o=t),p>=s&&(s=p,i=t),u<c&&(c=u,a=t),u>=h&&(h=u,n=t)})),{a:o,b:a,a2:i,b2:n}},Gt=function(t,e){var o=Math.abs(jt(t.left)-jt(e.left)),a=Math.abs(jt(e.top)-jt(t.top)),i=Pt(Math.atan(o/a)),n=t.left,r=t.top,c=e.left,s=e.top;return n>c&&r<=s||(n>=c&&r>s?i=180-i:n<c&&r>=s?i+=180:i=360-i),i%360},Mt=function(t){return t%360},Tt=function(){return Object(pt["a"])()},Dt=function(t){var e=window.getSelection(),o=document.createRange();o.selectNodeContents(t),e.removeAllRanges(),e.addRange(o)},Lt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=t.left,a=t.top,i=t.width,n=t.height,r=t.angle;o*=e,a*=e,i*=e,n*=e;var c=o+i,s=a+n,h={left:jt(o+i/2),top:jt(a+n/2)},p={left:o,top:a},u=p,l={left:o,top:s},f=l,_={left:c,top:a},m=_,v={left:c,top:s},g=v,b={left:o,top:h.top},R={left:o+i,top:h.top},y=kt(h,p,r),j=y,I=kt(h,l,r),P=I,k=kt(h,_,r),O=k,x=kt(h,v,r),w=x,G=kt(h,b,r),M=kt(h,R,r),T=[j.left,O.left,w.left,P.left],D=[j.top,O.top,w.top,P.top],L=Math.min.apply(null,T),S=Math.max.apply(null,T),B=Math.min.apply(null,D),C=Math.max.apply(null,D);return Object(d["a"])({},t,{center:h,leftTop:p,leftBottom:l,rightTop:_,rightBottom:v,rotateRightTop:k,rotateLeftTop:y,rotateLeftBottom:I,rotateRightBottom:x,a:u,b:m,c:g,d:f,ra:j,rb:O,rc:w,rd:P,rad:G,rbc:M,right:c,bottom:s,left:o,top:a,width:i,height:n,minRotateLeft:L,maxRotateLeft:S,minRotateTop:B,maxRotateTop:C})},St=function(t,e){var o=[];t.forEach((function(t){var e=Lt(t.data);o=[].concat(Object(k["a"])(o),[e.rotateLeftTop,e.rotateRightTop,e.rotateLeftBottom,e.rotateRightBottom])}));var a=wt(o,e),i=Ot(a.a,a.b,e),n=Ot(a.a2,a.b2,e),r={left:i.left+(n.left-i.left)/2,top:n.top-(n.top-i.top)/2},c=kt(r,e>90&&e<=270?n:i,e,!1),s=2*Math.abs(r.left-c.left),h=2*Math.abs(r.top-c.top);return{left:jt(c.left),top:jt(c.top),width:jt(s),height:jt(h)}},Bt=function(t,e,o){return{left:(e.left-t.left)*o+t.left,top:(e.top-t.top)*o+t.top}},Ct=function(t,e){return{left:jt(t.left+(e.left-t.left)/2),top:jt(t.top+(e.top-t.top)/2)}},zt=function(t,e){return{width:2*Math.abs(e.left-t.left),height:2*Math.abs(e.top-t.top)}},Ut=mt.b+mt.c,Et=mt.a+mt.c,At=function(t){return t+="",t.includes("%")||(t+="px"),t},Ft=function(t){return 3===t.which},Wt=function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return JSON.stringify(e)};["min","max","cos","sin","tan","atan","abs","ceil","pow","round"].forEach((function(t){Math[t]=Object(W["memoize"])(Math[t],Wt)})),gt=Object(W["memoize"])(gt,Wt),Rt=Object(W["memoize"])(Rt,Wt),yt=Object(W["memoize"])(yt,Wt),jt=Object(W["memoize"])(jt,Wt),It=Object(W["memoize"])(It,Wt),Pt=Object(W["memoize"])(Pt,Wt),kt=Object(W["memoize"])(kt,Wt),Ot=Object(W["memoize"])(Ot,Wt),xt=Object(W["memoize"])(xt,Wt),wt=Object(W["memoize"])(wt,Wt),Gt=Object(W["memoize"])(Gt,Wt),Mt=Object(W["memoize"])(Mt,Wt),Lt=Object(W["memoize"])(Lt,Wt),St=Object(W["memoize"])(St,Wt),Bt=Object(W["memoize"])(Bt,Wt),Ct=Object(W["memoize"])(Ct,Wt),zt=Object(W["memoize"])(zt,Wt),At=Object(W["memoize"])(At,Wt);var Ht,$t,Kt=10,Nt=function(t,e){return t/e},Xt=function(t){var e=t.data,o=t.tempData,a=o.angle,i=It(a),n=o.width,r=o.height;return{data:e,tempInfo:o,angle:a,radian:i,tempWidth:n,tempHeight:r}},qt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Xt(t),i=a.tempInfo,n=a.angle,r=a.tempWidth,c=a.radian,s=-Math.cos(c)*e-Math.sin(c)*o,h=Math.max(s+r,Kt),d=Nt(h,r),p=i.rotateLeftTop,u=i.rotateRightBottom,l=Bt(u,p,d),f=Ct(l,u),_=kt(f,l,n,!1),m=zt(_,f);return{size:{left:_.left,top:_.top,width:m.width,height:m.height},scale:d,fixedPoint:u}},Vt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Xt(t),i=a.tempInfo,n=a.angle,r=a.tempWidth,c=a.radian,s=Math.cos(c)*e+Math.sin(c)*o,h=Math.max(s+r,Kt),d=Nt(h,r),p=i.rotateRightTop,u=i.rotateLeftBottom,l=Bt(u,p,d),f=Ct(u,l),_=kt(f,l,n,!1),m=zt(_,f),v={left:_.left-m.width,top:_.top};return{size:{left:v.left,top:v.top,width:m.width,height:m.height},scale:d,fixedPoint:u}},Yt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Xt(t),i=a.tempInfo,n=a.angle,r=a.tempWidth,c=a.radian,s=Math.cos(c)*e+Math.sin(c)*o,h=Math.max(s+r,Kt),d=Nt(h,r),p=i.rotateLeftTop,u=i.rotateRightBottom,l=Bt(p,u,d),f=Ct(p,l),_=kt(f,p,n,!1),m=zt(_,f);return{size:{left:_.left,top:_.top,width:m.width,height:m.height},scale:d,fixedPoint:p}},Jt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Xt(t),i=a.tempInfo,n=a.angle,r=a.tempWidth,c=a.radian,s=-Math.cos(c)*e-Math.sin(c)*o,h=Math.max(s+r,Kt),d=Nt(h,r),p=i.rotateRightTop,u=i.rotateLeftBottom,l=Bt(p,u,d),f=Ct(p,l),_=kt(f,p,n,!1),m=zt(_,f),v={left:_.left-m.width,top:_.top};return{size:{left:v.left,top:v.top,width:m.width,height:m.height},scale:d,fixedPoint:p}},Qt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Xt(t),i=a.tempInfo,n=a.angle,r=a.tempWidth,c=a.tempHeight,s=a.radian,h=i.rotateRightBottom,d=-Math.cos(s)*e-Math.sin(s)*o,p=Math.sin(s)*e-Math.cos(s)*o,u=Math.max(d+r,Kt),l=Math.max(p+c,Kt),f={left:0,top:0};f=0===n?{left:h.left-u,top:h.top-l}:90===n?{left:h.left+l,top:h.top-u}:180===n?{left:h.left+u,top:h.top+l}:270===n?{left:h.left-l,top:h.top+u}:{left:h.left-Math.cos(s)*(u-Math.tan(s)*l),top:h.top-(l/Math.cos(s)+Math.sin(s)*(u-Math.tan(s)*l))};var _=Ct(f,h),m=kt(_,f,n,!1);return{size:{left:m.left,top:m.top,width:u,height:l},fixedPoint:h}},Zt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Xt(t),i=a.tempInfo,n=a.angle,r=a.tempHeight,c=a.radian,s=Math.sin(c)*e-Math.cos(c)*o,h=Math.max(r+s,Kt);s=h-r;var d=i.rotateLeftTop,p=i.rotateRightBottom,u={left:d.left+Math.sin(c)*s,top:d.top-Math.cos(c)*s},l=Ct(u,p),f=kt(l,u,n,!1);return{size:{left:f.left,top:f.top,height:h},fixedPoint:p,scaleH:h/r}},te=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Xt(t),i=a.tempInfo,n=a.angle,r=a.tempWidth,c=a.tempHeight,s=a.radian,h=i.rotateLeftBottom,d=Math.cos(s)*e+Math.sin(s)*o,p=Math.sin(s)*e-Math.cos(s)*o,u=Math.max(d+r,Kt),l=Math.max(p+c,Kt),f={left:0,top:0};f=0===n?{left:h.left+u,top:h.top-l}:90===n?{left:h.left+l,top:h.top+u}:180===n?{left:h.left-u,top:h.top+l}:270===n?{left:h.left-l,top:h.top-u}:{left:h.left+u/Math.cos(s)+Math.sin(s)*(l-Math.tan(s)*u),top:h.top-Math.cos(s)*(l-Math.tan(s)*u)};var _=Ct(f,h),m=kt(_,f,n,!1);return{size:{left:m.left-u,top:m.top,width:u,height:l},fixedPoint:h}},ee=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Xt(t),i=a.tempWidth,n=a.radian,r=Math.cos(n)*e+Math.sin(n)*o,c=Math.max(i+r,Kt);return ae(t,c)},oe=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Xt(t),i=a.tempInfo,n=a.angle,r=a.tempWidth,c=a.tempHeight,s=a.radian,h=i.rotateLeftTop,d=Math.cos(s)*e+Math.sin(s)*o,p=-Math.sin(s)*e+Math.cos(s)*o,u=Math.max(d+r,Kt),l=Math.max(p+c,Kt),f={left:0,top:0};f=0===n?{left:h.left+u,top:h.top+l}:90===n?{left:h.left-l,top:h.top+u}:180===n?{left:h.left-u,top:h.top-l}:270===n?{left:h.left+l,top:h.top-u}:{left:h.left+Math.cos(s)*(u-Math.tan(s)*l),top:h.top+l/Math.cos(s)+Math.sin(s)*(u-Math.tan(s)*l)};var _=Ct(f,h),m=kt(_,h,n,!1);return{size:{left:m.left,top:m.top,width:u,height:l},fixedPoint:h}},ae=function(t,e){var o=Xt(t),a=o.data,i=o.tempInfo,n=o.angle,r=o.tempWidth,c=o.tempHeight,s=o.radian,h=e-r,d=c,p=i.rotateLeftTop,u=i.rotateRightBottom,l={left:u.left+Math.cos(s)*h,top:u.top+Math.sin(s)*h},f=a.isSameRatio;if(f){var _=c/r*h;d+=_,l={left:l.left-Math.sin(s)*_,top:l.top+Math.cos(s)*_}}var m=Ct(p,l),v=kt(m,p,n,!1);return{size:{left:v.left,top:v.top,width:e,height:d},fixedPoint:p,scaleW:e/r}},ie=function(t,e){var o=Xt(t),a=o.tempInfo,i=o.angle,n=o.tempHeight,r=o.radian,c=e-n,s=a.rotateLeftTop,h=a.rotateRightBottom,d={left:h.left-Math.sin(r)*c,top:h.top+Math.cos(r)*c},p=Ct(s,d),u=kt(p,s,i,!1);return{size:{left:u.left,top:u.top,height:e},fixedPoint:s,scaleW:e/n}},ne=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Xt(t),i=a.tempHeight,n=a.radian,r=-Math.sin(n)*e+Math.cos(n)*o,c=Math.max(i+r,Kt);return ie(t,c)},re=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Xt(t),i=a.tempInfo,n=a.angle,r=a.tempWidth,c=a.tempHeight,s=a.radian,h=i.rotateRightTop,d=-Math.cos(s)*e-Math.sin(s)*o,p=-Math.sin(s)*e+Math.cos(s)*o,u=Math.max(d+r,Kt),l=Math.max(p+c,Kt),f={left:0,top:0};f=0===n?{left:h.left-u,top:h.top+l}:90===n?{left:h.left-l,top:h.top-u}:180===n?{left:h.left+u,top:h.top-l}:270===n?{left:h.left+l,top:h.top+u}:{left:h.left-(u/Math.cos(s)+Math.sin(s)*(l-Math.tan(s)*u)),top:h.top+Math.cos(s)*(l-Math.tan(s)*u)};var _=Ct(f,h),m=kt(_,h,n,!1);return{size:{left:m.left-u,top:m.top,height:l,width:u},fixedPoint:h}},ce=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Xt(t),i=a.tempInfo,n=a.angle,r=a.tempWidth,c=a.radian,s=-Math.cos(c)*e-Math.sin(c)*o,h=Math.max(r+s,Kt);s=h-r;var d=i.rotateLeftTop,p=i.rotateRightBottom,u={left:d.left-Math.cos(c)*s,top:d.top-Math.sin(c)*s},l=Ct(p,u),f=kt(l,u,n,!1);return{size:{left:f.left,top:f.top,width:h},fixedPoint:p,scaleW:h/r}},se=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=t.tempData,i=a.height,n=a.width,r=a.rbc,c=a.rad,s={left:c.left+e,top:c.top+o},h=Ct(s,r),p=parseInt(Gt(s,h)+90)%360,u=kt(h,s,p,!1),l=kt(h,r,p,!1),f=l.left-u.left,_={left:u.left,top:u.top-i/2};return{size:Object(d["a"])({},_,{width:f}),angle:p,fixedPoint:r,scaleW:f/n}},he=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=t.tempData,i=a.height,n=a.width,r=a.rbc,c=a.rad,s={left:r.left+e,top:r.top+o},h=Ct(c,s),p=parseInt(Gt(c,h)+90)%360,u=kt(h,c,p,!1),l=kt(h,s,p,!1),f=l.left-u.left,_={left:u.left,top:u.top-i/2};return{size:Object(d["a"])({},_,{width:f}),angle:p,fixedPoint:c,scaleW:f/n}},de=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Xt(t),i=a.tempInfo,n=a.angle,r=a.radian,c=a.tempWidth,s=a.tempHeight,h=i.rbc,p=i.rad,u=-Math.cos(r)*e-Math.sin(r)*o,l=Math.max(u+c,Kt),f=Nt(l,c),_=Bt(h,p,f),m=Ct(h,_),v=kt(m,_,n,!1),g={left:v.left,top:v.top-s/2};return{size:Object(d["a"])({},g,{width:l}),angle:n,fixedPoint:p,scale:f}},pe=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Xt(t),i=a.tempInfo,n=a.angle,r=a.radian,c=a.tempWidth,s=a.tempHeight,h=i.rbc,p=i.rad,u=Math.cos(r)*e+Math.sin(r)*o,l=Math.max(u+c,Kt),f=Nt(l,c),_=Bt(p,h,f),m=Ct(p,_),v=kt(m,p,n,!1),g={left:v.left,top:v.top-s/2};return{size:Object(d["a"])({},g,{width:l}),angle:n,fixedPoint:p,scale:f}},ue={methods:{_resize:function(t,e){var o=this.objects[this.currRectId],a=this.mouse.resizerDir,i="rect-line"===o.type,n=this._checkGuideOnResize(o,a,t,e),r=Object(dt["a"])(n,2);t=r[0],e=r[1],this._checkIsGroupLike(o)?this._resizeGroup(o,a,t,e):i?this._resizeLine(o,a,t,e):this._resizeRect(o,a,t,e)},_resizeText:function(t,e){var o=t.data;e=e||o.text;var a="".concat(o.fontSize,"px ").concat(o.fontFamily),i=gt(e,a),n=i.width;this._resizeWidthTo(t,n);var r=i.height;this._resizeHeightTo(t,r)},_resizeLine:function(t,e,o,a){var i={ad:se,bc:he}[e];t.data.isAngleLock&&(i={ad:de,bc:pe}[e]);var n=i(t,o,a);this._commandRectDataPropUpdate(t,"angle",n.angle),this._updateRectData(t,n.size)},_scaleGroupRectR:function(t,e,o){var a=t.data,i=t.tempData,n=i.rotateLeftTop,r=i.rotateRightBottom,c=Bt(e,n,o),s=Bt(e,r,o),h=Ct(c,s),d=kt(h,c,a.angle,!1),p=zt(d,h);this._updateRectData(t,{left:d.left,top:d.top,width:p.width,height:p.height},!1)},_scaleGroupRectWOrH:function(t,e,o,a){var i,n=t.data,r=t.tempData,c=n.angle,s=e.data,h=e.tempData,d=s.angle,p=It(c),u="left";"bc"===a?i=r.left:"ad"===a?i=r.left+r.width:"cd"===a?(i=r.top,u="top"):(i=r.top+r.height,u="top");var l=Math.abs(d-c),f=180===l,_=90===l,m=270===l,v=h.rotateLeftTop,g=h.rotateRightTop,b=h.rotateRightBottom,R=h.rotateLeftBottom;if(_)v=R,b=g;else if(f){var y=[b,v];v=y[0],b=y[1]}else m&&(v=g,b=R);var j=kt(r.center,v,c,!1),I=j[u]-i,P=I*(o-1),k={left:v.left,top:v.top};"left"===u?(k.left+=Math.cos(p)*P,k.top+=Math.sin(p)*P):(k.left-=Math.sin(p)*P,k.top+=Math.cos(p)*P);var O=kt(r.center,b,c,!1),x=O[u]-i,w=x*(o-1),G={left:b.left,top:b.top};"left"===u?(G.left+=Math.cos(p)*w,G.top+=Math.sin(p)*w):(G.left-=Math.sin(p)*w,G.top+=Math.cos(p)*w);var M=Ct(k,G),T=kt(M,k,d,!1),D=zt(T,M),L={left:T.left,top:T.top,width:D.width,height:D.height};f?(L.left=s.left-L.width,L.top=s.top-L.height):_?L.top=s.top-L.height:m&&(L.left=s.left-L.width),this._updateRectData(e,L,!1)},_scaleGroupR:function(t,e,o){var a=this,i=function(t){var i=a._getRectById(t);a._scaleGroupRectR(i,e,o)};this._updateGroupState(t,i)},_resizeGroupWithRes:function(t,e,o){var a=this,i=e.fixedPoint,n=e.scaleW||e.scaleH,r=t.data,c=r.angle,s=function(e){var s=a._getRectById(e),h=s.data,d=h.angle,p=r.isSameRatio||h.isSameRatio,u=(d-c)%90!==0;p||u?a._scaleGroupRectR(s,i,n):a._scaleGroupRectWOrH(t,s,n,o)};return this._updateGroupState(t,s),this._getGroupSize(t)},_resizeGroup:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"c",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i={a:qt,b:Vt,c:Yt,d:Jt,ab:Zt,bc:ee,cd:ne,ad:ce}[e],n=i(t,o,a),r={};if(["a","b","c","d"].includes(e)){var c=n.scale,s=n.fixedPoint;this._scaleGroupR(t,s,c),r=n.size}else r=this._resizeGroupWithRes(t,n,e);this._updateRectData(t,r)},_resizeRect:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bc",o=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,i={a:Qt,b:te,c:oe,d:re,ab:Zt,bc:ee,cd:ne,ad:ce}[e],n=this.mouse.e.shiftKey,r=t.data.isSameRatio;(n||r)&&(i={a:qt,b:Vt,c:Yt,d:Jt}[e]);var c=i(t,o,a);this._updateRectData(t,c.size)},_resizeTo:function(t){var e,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=this._checkIsGroupLike(t);if(null!==a&&(e=ae(t,a),o="bc"),null!==i&&(e=ie(t,i),o="cd"),n){var r=this._resizeGroupWithRes(t,e,o);this._updateRectData(t,r)}else this._updateRectData(t,e.size)},_resizeWidthTo:function(t,e){this._resizeTo(t,e)},_resizeHeightTo:function(t,e){this._resizeTo(t,null,e)}}},le={methods:{_rotate:function(t){var e=this.objects[this.currRectId],o=Lt(e.data),a=e.tempData,i=a.angle,n=o.angle,r=this.scale,c=parseInt(Gt(t,{left:o.center.left*r,top:o.center.top*r})),s=c-i;s=this._checkGuideOnRotate(i,n,c,s),this._checkIsGroupLike(e)?this._rotateGroup(e,s):this._rotateRect(e,s)},_rotateTo:function(t,e){var o=t.tempData,a=e-o.angle;this._checkIsGroupLike(t)?this._rotateGroup(t,a):this._rotateRect(t,a)},_rotateRect:function(t,e){if(this._commandRectDataPropUpdate(t,"angle",Mt(t.tempData.angle+e)),t.groupId){var o=this._getRectById(t.groupId);this._updateGroupSize(o)}},_rotateGroup:function(t,e){var o=this,a=t.tempData,i=a.center,n=function(t){var a=o._getRectById(t),n=a.tempData,r=kt(i,n.center,e),c=r.left-n.width/2,s=r.top-n.height/2;o._commandRectDataPropUpdate(a,"left",jt(c)),o._commandRectDataPropUpdate(a,"top",jt(s)),o._commandRectDataPropUpdate(a,"angle",Mt(n.angle+e))};this._updateGroupState(t,n,!0)}}},fe={methods:{_move:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t=this._safeObject(t),a){var i=this._checkGuideOnMove(t,e,o),n=Object(dt["a"])(i,2);e=n[0],o=n[1]}var r=this.mouse.e.shiftKey;r&&(Math.abs(e)>Math.abs(o)?o=0:e=0),this._checkIsGroupLike(t)?this._moveGroup(t,e,o):this._moveRect(t,e,o)},_moveTo:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=t.tempData,i=0,n=0;null!==e&&(i=e-a.left),null!==o&&(n=o-a.top),this._move(t,i,n,!1)},_moveLeftTo:function(t,e){this._moveTo(t,e)},_moveTopTo:function(t,e){this._moveTo(t,null,e)},_moveRect:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=t.tempData;if(this._updateRectData(t,{left:a.left+e,top:a.top+o},!1),t.groupId){var i=this._getRectById(t.groupId);this._updateGroupSize(i)}},_moveGroup:function(t){var e=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=function(t){var i=e._getRectById(t),n=i.tempData;e._updateRectData(i,{left:n.left+o,top:n.top+a},!1)};this._updateGroupState(t,i)}}},_e=u.a.div,me=u.a.span,ve=u.a.input,ge=u.a.select,be=u.a.option,Re=u.a.label,ye=u.a.i,je=u.a.bind("sp-color"),Ie=function(){var t=this,e={"class_proto-setting":!0},o=this._safeObject(this.currRectId||this._getSelectedRects()[0]),a=[];if(o){var i=o.data,n=this._checkIsGroupLike(o),r=this._checkIsTempGroup(o),c="rect-line"===o.type,s="rect-text"===o.type,h=i.isAutoSize,p=i.isSameRatio,u=i.isLock,l=function(e){var a=i[e];"number"===typeof a&&(a=jt(a,0));var n={"class_form-input":!0,"class_input-sm":!0,domProps_value:a,domProps_type:"number",props_value:a,domProps_disabled:u,props_disabled:u,key:e,on_blur:function(){},on_focus:function(){t._updateRectTempData(o)},on_change:function(a){var i=a.target.value;t._commandRectDataPropUpdate(o,e,i),t._historyPush(),["borderStyle"].includes(e)&&t._flashHandler()}};return["borderColor","color","backgroundColor"].includes(e)&&(n=Object(d["a"])({},n,{on_change:function(a){var i=a.hex8;t._commandRectDataPropUpdate(o,e,i),t._historyPush(),["borderColor"].includes(e)&&t._flashHandler()}})),n};if(r){var f=_e({"class_proto-setting-box-item":!0},me("对齐"),ge({"class_form-select":!0,"class_select-sm":!0,domProps_value:"",on_change:function(e){var o=e.target.value,a={left:t._actionRectAlignLeft,leftRight:t._actionRectAlignLeftRight,right:t._actionRectAlignRight,top:t._actionRectAlignTop,topBottom:t._actionRectAlignTopBottom,bottom:t._actionRectAlignBottom,equalSpaceX:t._actionRectEqualSpaceX,equalSpaceY:t._actionRectEqualSpaceY}[o];a(),t._historyPush(),t.renderHook++}},be({domProps_value:""},"选择对齐方式"),be({domProps_value:"left"},"左对齐"),be({domProps_value:"leftRight"},"左右居中"),be({domProps_value:"right"},"右对齐"),be({domProps_value:"top"},"上对齐"),be({domProps_value:"topBottom"},"上下居中"),be({domProps_value:"bottom"},"下对齐"),be({domProps_disabled:!t._actionCanRectEqualSpace(),domProps_value:"equalSpaceX"},"水平等间距"),be({domProps_disabled:!t._actionCanRectEqualSpace(),domProps_value:"equalSpaceY"},"垂直等间距")));a=[].concat(Object(k["a"])(a),[f])}var _=_e({"class_proto-setting-box-item":!0},me("X轴坐标"),ve(Object(d["a"])({},l("left"),{on_change:function(e){var a=e.target.value,i=parseInt(a);t._moveLeftTo(o,i),t._historyPush()}})));a=[].concat(Object(k["a"])(a),[_]);var m=_e({"class_proto-setting-box-item":!0},me("Y轴坐标"),ve(Object(d["a"])({},l("top"),{on_change:function(e){var a=e.target.value,i=parseInt(a);t._moveTopTo(o,i),t._historyPush()}})));a=[].concat(Object(k["a"])(a),[m]);var v=_e({"class_proto-setting-box-item":!0},me("宽度"),ve(Object(d["a"])({domProps_disabled:h},l("width"),{on_change:function(e){var a=e.target.value,i=Math.max(10,parseInt(a));t._resizeWidthTo(o,i),t._historyPush()}})));a=[].concat(Object(k["a"])(a),[v]);var g=_e({"class_proto-setting-box-item":!0},me("高度"),ve(Object(d["a"])({domProps_disabled:h||c||p},l("height"),{on_change:function(e){var a=e.target.value,i=Math.max(10,parseInt(a));t._resizeHeightTo(o,i),t._historyPush()}})));if(a=[].concat(Object(k["a"])(a),[g]),!r){var b=_e({"class_proto-setting-box-item":!0},me("角度"),ve(Object(d["a"])({},l("angle"),{on_change:function(e){var a=e.target.value,i=parseInt(a)%360;i<0&&(i+=360),t._rotateTo(o,i)}})));a=[].concat(Object(k["a"])(a),[b])}if(!c){var R=_e({"class_proto-setting-box-item":!0},me("等比缩放"),Re({"class_form-switch":!0},ve(Object(d["a"])({},l(),{key:"isSameRatio",domProps_type:"checkbox",domProps_checked:i["isSameRatio"],on_change:function(){var e=!i["isSameRatio"];t._commandRectDataPropUpdate(o,"isSameRatio",e),t._historyPush()}})),ye({"class_form-icon":!0})));a=[].concat(Object(k["a"])(a),[R])}if(c){var y=_e({"class_proto-setting-box-item":!0},me("锁定角度"),Re({"class_form-switch":!0},ve(Object(d["a"])({},l(),{key:"isAngleLock",domProps_type:"checkbox",domProps_checked:i["isAngleLock"],on_change:function(){var e=!i["isAngleLock"];t._commandRectDataPropUpdate(o,"isAngleLock",e),t._historyPush()}})),ye({"class_form-icon":!0})));a=[].concat(Object(k["a"])(a),[y])}if(!n){if(!s){var j=_e({"class_proto-setting-box-item":!0},me("边框宽度"),ve(Object(d["a"])({},l("borderWidth"),{on_change:function(e){var a=e.target.value,i=Math.max(0,parseInt(a));t._commandRectDataPropUpdate(o,"borderWidth",i),c&&t._commandRectDataPropUpdate(o,"height",i)}})));a=[].concat(Object(k["a"])(a),[j]);var I=_e({"class_proto-setting-box-item":!0},me("边框样式"),ge(Object(d["a"])({},l("borderStyle"),{"class_form-select":!0,"class_select-sm":!0}),be({domProps_value:"solid"},"solid"),be({domProps_value:"dashed"},"dashed"),be({domProps_value:"dotted"},"dotted")));a=[].concat(Object(k["a"])(a),[I]);var P=_e({"class_proto-setting-box-item":!0},me("边框颜色"),je(Object(d["a"])({},l("borderColor"))));a=[].concat(Object(k["a"])(a),[P])}if(!c){var O=_e({"class_proto-setting-box-item":!0},me("背景颜色"),je(Object(d["a"])({},l("backgroundColor"))));a=[].concat(Object(k["a"])(a),[O])}if(!c){var x=_e({"class_proto-setting-box-item":!0},me("文本颜色"),je(Object(d["a"])({},l("color"))));a=[].concat(Object(k["a"])(a),[x])}if(s){var w=_e({"class_proto-setting-box-item":!0},me("自适应尺寸"),Re({"class_form-switch":!0},ve(Object(d["a"])({},l(),{key:"isAutoSize",domProps_checked:i["isAutoSize"],domProps_type:"checkbox",on_change:function(){var e=!i["isAutoSize"];t._updateRectTempData(o),t._commandRectDataPropUpdate(o,"isAutoSize",e),t._resizeText(o),t._historyPush()}})),ye({"class_form-icon":!0})));a=[].concat(Object(k["a"])(a),[w])}var G=_e({"class_proto-setting-box-item":!0},me("文本大小"),ve(Object(d["a"])({},l("fontSize"),{domProps_min:12,on_change:function(e){var a=e.target.value;a=parseInt(a),t._commandRectDataPropUpdate(o,"fontSize",a),t._commandPropUpdate("setting.value",a),i.isAutoSize&&t._resizeText(o)}})));a=[].concat(Object(k["a"])(a),[G]);var M=_e({"class_proto-setting-box-item":!0},me("文本X轴对齐"),ge(Object(d["a"])({},l("textAlignX"),{"class_form-select":!0,"class_select-sm":!0}),be({domProps_value:"flex-start"},"左对齐"),be({domProps_value:"center"},"居中对齐"),be({domProps_value:"flex-end"},"右对齐")));a=[].concat(Object(k["a"])(a),[M]);var T=_e({"class_proto-setting-box-item":!0},me("文本Y轴对齐"),ge(Object(d["a"])({},l("textAlignY"),{"class_form-select":!0,"class_select-sm":!0}),be({domProps_value:"flex-start"},"上对齐"),be({domProps_value:"center"},"居中对齐"),be({domProps_value:"flex-end"},"下对齐")));a=[].concat(Object(k["a"])(a),[T])}var D=_e({"class_proto-setting-box-item":!0},me("不透明度"),ve(Object(d["a"])({},l("opacity"),{domProps_min:0,domProps_max:100,on_change:function(e){var o=e.target.value;o=parseInt(o),t._updateCurrRectOpacity(o),t._historyPush()}})),"%");a=[].concat(Object(k["a"])(a),[D])}return _e(Object(d["a"])({class_card:!0},e),_e(".card-header",_e(".card-title h6","样式")),_e.apply(void 0,[".card-body"].concat(Object(k["a"])(a))))},Pe=u.a.div,ke=function(){var t=this,e=this.objects[this.currRectId];if(e){var o=e.data,a=o.isLock,i=this._checkIsTempGroup(e),n=this.mouse,r=function(o){t._updateRectTempData(e),o.stopPropagation(),f.$emit("windowMouseDown",o)},c={"class_proto-rect-resizer":!0},s=5,h="calc(50% - ".concat(s,"px)"),p=Pe(Object(d["a"])({},c,{style_left:-s+"px",style_top:-s+"px",on_mousedown:function(t){n.resizerDir="a",n.eventType="resize",r(t)}})),u=Pe(Object(d["a"])({},c,{style_left:h,style_top:-s+"px",on_mousedown:function(t){n.resizerDir="ab",n.eventType="resize",r(t)}})),l=Pe(Object(d["a"])({},c,{style_right:-s+"px",style_top:-s+"px",on_mousedown:function(t){n.resizerDir="b",n.eventType="resize",r(t)}})),_=Pe(Object(d["a"])({},c,{style_right:-s+"px",style_top:h,on_mousedown:function(t){n.resizerDir="bc",n.eventType="resize",r(t)}})),m=Pe(Object(d["a"])({},c,{style_right:-s+"px",style_bottom:-s+"px",on_mousedown:function(t){n.resizerDir="c",n.eventType="resize",r(t)}})),v=Pe(Object(d["a"])({},c,{style_left:h,style_bottom:-s+"px",on_mousedown:function(t){n.resizerDir="cd",n.eventType="resize",r(t)}})),g=Pe(Object(d["a"])({},c,{style_left:-s+"px",style_bottom:-s+"px",on_mousedown:function(t){n.resizerDir="d",n.eventType="resize",r(t)}})),b=Pe(Object(d["a"])({},c,{style_left:-s+"px",style_bottom:h,on_mousedown:function(t){n.resizerDir="ad",n.eventType="resize",r(t)}})),R=[],y="rect-line"===e.type,j=e.data.isSameRatio;y?R=[b,_]:(R=[p,l,m,g],j||(R=[].concat(Object(k["a"])(R),[u,_,v,b])));var I=Pe({"class_proto-rect-rotater":!0,style_left:h,style_top:"-15px",on_mousedown:function(t){n.eventType="rotate",r(t)}}),P=Object(d["a"])({},this._getRectBaseJsxProps(e,this.scale),{"class_proto-rect-handler":!0,"class_proto-rect-handler-lock":a});this.handler.show||(P=Object(d["a"])({},P,{style_display:"none"}));var O=[];return i||(O=[I]),e.data.isAutoSize||(O=[].concat(Object(k["a"])(O),Object(k["a"])(R))),Pe.apply(void 0,[P].concat(Object(k["a"])(O)))}},Oe=(o("6c3c"),o("1481"),u.a.div),xe=function(){var t=this.scale;return[].concat(Object(k["a"])(Array.from(this.guide.show.top).map((function(e){return Oe({"class_proto-guide":!0,"class_proto-guide-top":!0,style_top:e*t+"px"})}))),Object(k["a"])(Array.from(this.guide.show.left).map((function(e){return Oe({"class_proto-guide":!0,"class_proto-guide-left":!0,style_left:e*t+"px"})}))))},we=u.a.div,Ge=u.a.button,Me=u.a.select,Te=u.a.option,De={class_btn:!0,"class_btn-sm":!0,"class_btn-primary":!0},Le=function(t){var e=this,o=this._actionGet(t),a=o.checkF,i=o.doF,n=o.text;return Ge(Object(d["a"])({},De,{domProps_disabled:!a.call(this),on_click:function(){i.call(e)}}),n)},Se=function(){var t=this;return we(".proto-tools",we(".btn-group",Le.call(this,"sys-撤销"),Le.call(this,"sys-重做")),we(".btn-group",Le.call(this,"rect-组合"),Le.call(this,"rect-打散")),we(".btn-group",Le.call(this,"rect-复制"),Le.call(this,"rect-粘贴"),Le.call(this,"rect-删除"),Le.call(this,"rect-剪切")),we(".btn-group",Le.call(this,"rect-上移"),Le.call(this,"rect-下移"),Le.call(this,"rect-置顶"),Le.call(this,"rect-置底")),we(".btn-group",Le.call(this,"rect-锁定"),Le.call(this,"rect-解锁")),we(".btn-group",Me.apply(void 0,[{"class_form-select":!0,"class_select-sm":!0,domProps_value:this.scale,on_change:function(e){t.scale=e.target.value,t._renderRule()}}].concat(Object(k["a"])([.5,.8,1,1.25,2].map((function(t){return Te({domProps_value:t},t+"x")})))))))},Be={blue:"#5755d9",red:"#e85600",gray:"#bcc3ce",white:"#ffffff",black:"#000000"},Ce={name:"对象",top:0,left:0,width:200,height:100,angle:0,zIndex:0,text:"&nbsp;",color:Be.black,fontSize:12,fontFamily:"SourceHanSansSC",backgroundColor:Be.white,borderRadius:0,borderWidth:1,borderStyle:"solid",borderColor:Be.black,opacity:100,textAlignX:"center",textAlignY:"center",isEdit:!1,isNameEdit:!1,isOpen:!1,isSameRatio:!1,isLock:!1},ze=Object(d["a"])({},Ce,{name:"矩形"}),Ue=Object(d["a"])({},Ce,{name:"圆形",borderRadius:"100%",width:100}),Ee=Object(d["a"])({},Ce,{name:"群组"}),Ae=Object(d["a"])({},Ce,{name:"临时群组"}),Fe=Object(d["a"])({},Ce,{name:"文本",border:null,text:"双击编辑文本",width:72,height:17,isAutoSize:!0,borderWidth:0}),We=Object(d["a"])({},Ce,{name:"线条",backgroundColor:Be.gray,borderWidth:1,height:1,isAngleLock:!1}),He=u.a.span,$e=u.a.div,Ke=function(){var t=this,e=["rect","circle","text","line"].map((function(e){return He({class_label:!0,on_mousedown:function(o){o.stopPropagation(),t.mouse.eventType="create",t.mouse.createType=e,f.$emit("windowMouseDown",o)}},a[e].name)}));return $e({"class_proto-rect-tags":!0,class_card:!0},$e({"class_card-header":!0},$e({"class_card-title":!0,class_h6:!0},"组件")),$e.apply(void 0,[{"class_card-body":!0}].concat(Object(k["a"])(e))))},Ne=o("5cd5"),Xe=u.a.div,qe=u.a.span,Ve=function(t){var e,o=this,a=this,i=t.data,n=t.id===this.currRectId,r=t.id===this.hoverRectId;r=r||t.id in this.selectedRects;var c=i.isLock&&!i.isOpen,s=t.type,h=this.mouse,p=function(e){o._focusRect(t,e),e.stopPropagation()},l=Object(d["a"])({},this._getRectBaseJsxProps(t),(e={"class_proto-rect":!0,"class_proto-rect-hover":r&&!n,"class_proto-rect-focus":n,"class_proto-rect-lock":c},Object(Ne["a"])(e,"class_proto-".concat(s),!0),Object(Ne["a"])(e,"attrs_id",t.id),Object(Ne["a"])(e,"attrs_index",t.index),Object(Ne["a"])(e,"on_mousedown",(function(e){a._checkIsTempGroup(t)||(h.eventType="move",t.data.isEdit&&(h.eventType=""),p(e),Ft(e)?a._showContextmenu(e,"rect"):f.$emit("windowMouseDown",e))})),Object(Ne["a"])(e,"on_mousemove",(function(){a._hoverRect(t)})),Object(Ne["a"])(e,"on_mouseout",(function(){a._hoverOffRect()})),e)),_=[];return this._checkIsGroupLike(t)||(l["on_dblclick"]=function(e){a._focusRect(t,e),h.ing=!1},_=[this._renderRectInner(t)]),r&&c&&(_=[].concat(Object(k["a"])(_),[u.a.create("v-icon",{"class_proto-rect-lock-icon":!0,props_name:"lock"})])),Xe.apply(void 0,[l].concat(Object(k["a"])(_)))},Ye=function(t){var e=this,o=this,a=t.data.isEdit,i=t.data,n="rect-line"===t.type,r={"class_proto-rect-inner":!0},c=[];if(n)r=Object(d["a"])({},r,{"style_border-top-width":i.borderWidth+"px","style_border-top-style":i.borderStyle,"style_border-top-color":i.borderColor});else{r=Object(d["a"])({},r,{"style_border-width":i.borderWidth+"px","style_border-style":i.borderStyle,"style_border-color":i.borderColor,"style_background-color":i.backgroundColor,"style_border-radius":At(i.borderRadius),"style_align-items":i.textAlignY,"style_justify-content":i.textAlignX,style_overflow:"hidden"});var s={"class_proto-rect-inner-text":!0,attrs_contenteditable:!1,style_color:i.color,"style_font-size":i.fontSize+"px","style_font-family":i.fontFamily};a?(s=Object(d["a"])({},s,{style_cursor:"text",ref:"defaultText",attrs_contenteditable:!0,style_transform:"rotate(-".concat(i.angle,"deg)"),on_blur:function(){o._hotkeyOn(),o._commandRectDataPropUpdate(t,"isEdit",!1),o._historyPush()},on_focus:function(){o._hotkeyOff(),o.$refs.defaultText.innerHTML=i.text,Dt(o.$refs.defaultText),o._updateRectTempData(t)},on_input:function(e){var a=e.target.innerHTML;i.isAutoSize&&o._resizeText(t,a),o._commandRectDataPropUpdate(t,"text",a)}}),setTimeout((function(){e.$refs.defaultText&&e.$refs.defaultText.focus()}))):s=Object(d["a"])({},s,{domProps_innerHTML:i.text}),c=[qe(s)]}return Xe.apply(void 0,[r].concat(Object(k["a"])(c)))},Je=function(){var t=this;if(!this.currPage)return null;var e=[];return this._getRectsByPageDeep().forEach((function(o){t._checkIsRectLike(o)&&e.push(t._renderRect(o))})),Xe({"class_proto-canvas":!0},Xe.apply(void 0,[{"class_proto-zoom":!0,style_transform:"scale(".concat(this.scale,")")}].concat(e)))},Qe=function(t){t.strokeStyle=Be.gray,t.font="20px SourceHanSansSC"},Ze=1e4,to=2*mt.c,eo=function(){var t=this.$refs.middle,e=window.getComputedStyle(t);return{dom:t,scrollTop:t.scrollTop,scrollLeft:t.scrollLeft,width:parseInt(e.width),height:parseInt(e.height)}},oo=function(){var t=this.topRule,e=eo.call(this);t||(this.topRule=t=document.createElement("canvas"),t.className="proto-rule",t.style.top=mt.a+"px",t.style.left=mt.b+mt.c+"px",e.dom.appendChild(t)),t.width=2*e.width,t.height=to,t.style.width=e.width+"px",t.style.height=to/2+"px";var o=this.scale,a=t.getContext("2d");a.clearRect(0,0,Ze,to),Qe(a),a.beginPath();for(var i=e.scrollLeft,n=0;n<Ze;n+=10){var r=n%100===0,c=2*(n-i),s=n/o,h=2*(r?0:10);a.moveTo(c,h),a.lineTo(c,to),r&&a.fillText(s,c+2,16)}a.moveTo(0,to),a.lineTo(t.width,to),a.stroke()},ao=function(){var t=eo.call(this),e=this.leftRule;e||(this.leftRule=e=document.createElement("canvas"),e.className="proto-rule",e.style.top=mt.a+mt.c+"px",e.style.left=mt.b+"px",this.$refs.middle.appendChild(e)),e.width=to,e.height=2*t.height,e.style.width=to/2+"px";var o=this.scale;e.style.height=t.height+"px";var a=e.getContext("2d");a.clearRect(0,0,to,Ze),Qe(a),a.beginPath();for(var i=t.scrollTop,n=0;n<Ze;n+=10){var r=n%100===0,c=2*(n-i),s=(n/o+" ").slice(0,4),h=2*(r?0:10);a.moveTo(h,c),a.lineTo(to,c),r&&(a.save(),a.textAlign="center",a.textBaseline="middle",a.translate(10,c-18),a.rotate(-90*Math.PI/180),a.fillText(s,6,0),a.restore())}a.moveTo(to,0),a.lineTo(to,e.height),a.stroke(),a.stroke()},io=function(){oo.call(this),ao.call(this)},no=u.a.div,ro=u.a.input,co=function(t){var e=this,o=t.id===this.hoverRectId||t.id===this.currRectId||t.id in this.selectedRects,a=16,i=t.data.isNameEdit,n={"class_proto-tree-item":!0},r={"class_proto-tree-item-inner":!0,"class_proto-tree-item-hover":o};t.groupId&&(r=Object(d["a"])({},r,{"style_padding-left":a+"px"}));var c=[];return i?(c=[ro(".form-input input-sm",{domProps_value:t.name,ref:"rectItemInput",key:"rectItemInput",on_focus:function(){e.$refs.rectItemInput.select()},on_blur:function(){e._commandRectDataPropUpdate(t,"isNameEdit",!1),e._historyPush()},on_change:function(){e.$refs.rectItemInput.blur()},on_input:function(o){var a=o.target.value;e._commandRectPropUpdate(t,"name",a)}})],setTimeout((function(){e.$refs.rectItemInput&&e.$refs.rectItemInput.focus()}))):(n=Object(d["a"])({},n,{attrs_index:t.index,on_mouseover:function(){e._updateHoverRect(t)},on_mouseout:function(){e._updateHoverRect()},on_mousedown:function(o){var a=e._getGroupByRect(t);a&&e._commandRectDataPropUpdate(a,"isOpen",!0),e._focusRect(t,{shiftKey:!1}),o.stopPropagation(),f.$emit("windowMouseDown",o),Ft(o)&&e._showContextmenu(o,"rect-item")}}),c=[no(r,t.name)]),no.apply(void 0,[n].concat(Object(k["a"])(c)))},so=function(){var t=this;if(!this.currPage)return null;var e=[],o=[];return this._getRectsByPageDeep().reverse().forEach((function(a){if(!t._checkIsTempGroup(a)){var i=co.call(t,a);""===a.groupId?(e=[].concat(Object(k["a"])(e),[i],Object(k["a"])(o)),o=[]):o.push(i)}})),e=[].concat(Object(k["a"])(e),Object(k["a"])(o)),no({"class_proto-rect-list":!0,"class_proto-tree":!0,class_card:!0},no({"class_card-header":!0},no({"class_card-title":!0,class_h6:!0},"元素")),no.apply(void 0,[{"class_card-body":!0}].concat(Object(k["a"])(e))))},ho=u.a.div,po=u.a.input,uo=u.a.span,lo=u.a.bind("v-icon"),fo=function(t,e){var o=this,a=t.data,i=this.currPage,n=this._linkedListCheckIsParent(i,t),r=i===t,c=16,s=c*e,h=a.isNameEdit,p=this.mouse.ing&&"movePage"===this.mouse.eventType&&!r&&!n,u={"class_proto-tree-item":!0,"class_proto-tree-item-drag":p},l={"class_proto-tree-item-inner":!0,"class_proto-tree-item-hover":r,"style_padding-left":s+"px"},_=[];if(h)_=[ho(l,po(".form-input input-sm",{domProps_value:t.name,ref:"pageInput",key:"pageInput",on_focus:function(){o.$refs.pageInput.select()},on_blur:function(){o._commandObjectDataPropUpdate(t,"isNameEdit",!1),o._historyPush()},on_change:function(){o.$refs.pageInput.blur()},on_input:function(e){var a=e.target.value;o._commandObjectPropUpdate(t,"name",a)}}))],setTimeout((function(){o.$refs.pageInput&&o.$refs.pageInput.focus()}));else{if(u=Object(d["a"])({},u,{on_mousedown:function(e){e.stopPropagation(),o._updateCurrPage(t),Ft(e)?o._showContextmenu(e,"page"):(o.mouse.ing=!0,o.mouse.eventType="movePage",f.$emit("windowMouseDown",e))}}),l=Object(d["a"])({},l,{"class_proto-tree-item-emit-hover":!this.mouse.ing}),p){var m=function(){o._linkedListRemove(o.objects[i.parentId],i,"pages")},v={style_left:s+"px",style_width:"calc(100% - ".concat(s,"px)")};_=[ho(".proto-tree-item-drag-handler proto-tree-item-drag-handler-bottom",Object(d["a"])({},v,{on_mouseup:function(){m(),o._commandObjectPropUpdate(i,"parentId",t.parentId),o._linkedListInsertAfter(o.objects[t.parentId],t,i,"pages")}}))],t.prevId||(_=[].concat(Object(k["a"])(_),[ho(".proto-tree-item-drag-handler proto-tree-item-drag-handler-top",Object(d["a"])({},v,{on_mouseup:function(){m(),o._commandObjectPropUpdate(i,"parentId",t.parentId),o._linkedListInsertBefore(o.objects[t.parentId],t,i,"pages")}}))])),l=Object(d["a"])({},l,{on_mouseup:function(){m(),o._commandObjectPropUpdate(i,"parentId",t.parentId),o._linkedListAppend(t,i,"pages"),o._commandObjectDataPropUpdate(t,"isExpand",!0)}})}_=[].concat(Object(k["a"])(_),[ho(l,t.pages.headId?lo({props_name:a.isExpand?"caret-down":"caret-up",on_mousedown:function(){o._commandObjectDataPropUpdate(t,"isExpand",!a.isExpand),o._historyPush()}}):null,uo(t.name))])}return ho.apply(void 0,[u].concat(Object(k["a"])(_)))},_o=function(){var t=this;if(!this.currPage)return null;var e,o=this,a=[],i=this.mouse.ing&&"movePage"===this.mouse.eventType;return this._linkedListWalk(this.objects[this.currProjectId],"pages",(function(e,o){a.push(fo.call(t,e,o))})),i&&(a=[].concat(Object(k["a"])(a),[ho(".proto-tree-scroll-handler proto-tree-scroll-handler-top",{on_mouseover:function(){e=setInterval((function(){o.$refs.pageList.scrollTop--}))},on_mouseout:function(){clearInterval(e)}}),ho(".proto-tree-scroll-handler proto-tree-scroll-handler-bottom",{on_mouseover:function(){e=setInterval((function(){o.$refs.pageList.scrollTop++}))},on_mouseout:function(){clearInterval(e)}})])),ho(".proto-page-list proto-tree card",ho(".card-header",ho(".card-title h6","页面")),ho.apply(void 0,[".card-body proto-tree-body",{ref:"pageList"}].concat(Object(k["a"])(a))))},mo=u.a.div,vo=function(){var t=this._getCircleSize(),e=t.left,o=t.top,a=t.width,i=t.height;return mo(".proto-circle",{style_left:e+"px",style_top:o+"px",style_width:a+"px",style_height:i+"px"})},go=u.a.div,bo={data:function(){return{topRule:null,leftRule:null}},methods:{_renderSetting:Ie,_renderHandler:ke,_renderGuideShow:xe,_renderTools:Se,_renderRects:Je,_renderRect:Ve,_renderRectInner:Ye,_renderRectNav:Ke,_renderRule:io,_renderRectList:so,_renderPageList:_o,_renderCircle:vo,_renderLoading:function(){return go("loading")},_renderMain:function(t){u.a.h=t;var e=this,o=this.mouse.ing&&"circle"===this.mouse.eventType;return go({class_proto:!0},go({"class_proto-top":!0,style_height:mt.a+"px",on_mousedown:function(t){t.stopPropagation()}},this._renderTools()),go({"class_proto-left":!0,style_top:mt.a+"px",style_width:mt.b+"px",style_height:"calc(100% - ".concat(mt.a,"px)")},go(".proto-height-half",this._renderPageList()),go(".proto-height-half",this._renderRectNav())),go({"class_proto-middle":!0,style_top:mt.a+mt.c+"px",style_left:mt.b+mt.c+"px",style_right:mt.d+"px",style_height:"calc(100% - ".concat(mt.a,"px - ").concat(mt.c,"px)"),ref:"middle",on_mousedown:function(t){t.stopPropagation(),e._blurRect(),Ft(t)?e._showContextmenu(t,"canvas"):(e.mouse.eventType="circle",f.$emit("windowMouseDown",t))}},this._renderRects(),this._renderGuideShow(),this._renderHandler(),o?this._renderCircle():null),go({"class_proto-right":!0,style_top:mt.a+"px",style_width:mt.d+"px",style_height:"calc(100% - ".concat(mt.a,"px)")},go(".proto-height-half",this._renderSetting(t)),go(".proto-height-half",this._renderRectList())))}},mounted:function(){this._renderRule()}},Ro=(o("9110"),o("6fe7"),o("575d"),o("f29e"),{data:function(){return{currProjectId:"",currPageId:"",currRectId:"",hoverRectId:"",tempGroupId:"",selectedRects:{},objects:{},mouse:{ing:!1,startLeft:0,startTop:0,currLeft:0,currTop:0,eventType:"",resizerDir:"",createType:"",e:{}},handler:{show:!0,timer:null},rectConfig:Object(d["a"])({},a),clipboard:{count:0,data:[]},renderHook:1}},computed:{scale:{get:function(){return this.renderHook,this.currProject?parseFloat(this.currProject.data.scale):1},set:function(t){this._commandObjectDataPropUpdate(this.currProject,"scale",t)}},currProject:{get:function(){return this.objects[this.currProjectId]}},currPage:{get:function(){return this.objects[this.currPageId]}},currRect:{get:function(){return this.objects[this.currRectId]}}},methods:{_parseLongProp:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$data,o=this,a=t.split("."),i=e,n=a.slice(-1)[0];return a.slice(0,-1).forEach((function(t){i=i[t]})),{get:function(){return i[n]},set:function(t){var e=null===t||void 0===t;e?delete i[n]:(i[n]=t,o.renderHook++)}}},_safeObject:function(t){return"string"===typeof t&&(t=this.objects[t]),t},_createProjectBase:function(){return{id:Tt(),name:"项目",type:"project",count:1,pages:{headId:"",tailId:""},data:{scale:1},isDelete:!1}},_createProject:function(){var t=this._createProjectBase();return this._commandProjectAdd(t),t},_createPageBase:function(t){return{id:Tt(),name:"页面",type:"page",count:1,parentId:t,projectId:t,prevId:"",nextId:"",pages:{headId:"",tailId:""},rects:{headId:"",tailId:""},data:{isNameEdit:!1,isExpand:!0},isDelete:!1}},_createPage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currProjectId,e=this._createPageBase(t);return e=Object(d["a"])({},e,{name:"页面"+this.currProject.count,projectId:this.currProjectId}),this._commandObjectPropUpdate(this.currProject,"count",this.currProject.count+1),this._commandPageAdd(e),this._linkedListAppend(this.objects[t],e,"pages"),e},_removePage:function(){var t=this,e=this.currPage,o=function(e){t._commandObjectDelete(e.id)};this._linkedListRemove(this.objects[e.parentId],e,"pages"),this._linkedListWalk(e,"pages",o),o(e);var a=this.objects[this.currProjectId].pages.headId;this._updateCurrPage(this.objects[a])},_createRect:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rect",e=this.rectConfig[t];if(e)return t="rect-"+t,this._createRectByConfig({type:t,data:e})},_createRectByConfig:function(t){var e=this,o=t.data;if(Array.isArray(o)){var a=this._createRectBase(o[0].type,o[0].data),i=o.slice(1).map((function(t){return e._createRectBase(t.type,t.data)}));return this._bindGroup(a,i),a}return this._createRectBase(t.type,o)},_createRectBase:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rect",e=arguments.length>1?arguments[1]:void 0;e=Object(d["a"])({},e);var o=this.currPage.count;this._commandObjectPropUpdate(this.currPage,"count",this.currPage.count+1);var a={id:Tt(),parentId:this.currPage.id,pageId:this.currPage.id,groupId:"",tempGroupId:"",data:e,tempData:null,type:t,name:e.name+o,prevId:"",nextId:"",tempIndex:o,isDelete:!1};return this._checkIsGroup(a)&&(a=Object(d["a"])({},a,{rects:{headId:"",tailId:""}})),this._commandRectAdd(a),this._checkIsTempGroup(a)||this._linkedListAppend(this.currPage,a),a},_cloneRectDeep:function(t){t=this._safeObject(t);var e=function(t){return{type:t.type,data:Object(d["a"])({},t.data)}};if(this._checkIsGroup(t)){var o=[e(t)];return this._getRectsByGroup(t).forEach((function(t){o.push(e(t))})),{type:"rect-group",data:o}}return e(t)},_getObjectsByParentId:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"groupId",o=[];for(var a in this.objects){var i=this.objects[a];i.isDelete||i[e]!==t||o.push(i)}return o},_getRectsByPageDeep:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currPage.id,e=this._linkedListGetObjects(this.objects[t]);return this.tempGroupId&&e.push(this.objects[this.tempGroupId]),e},_getRectsByGroup:function(t){t=this._safeObject(t);var e=[];return e=this._checkIsTempGroup(t)?this._getObjectsByParentId(t.id,"tempGroupId"):this._checkIsGroup(t)?this._getObjectsByParentId(t.id):[t],e},_getGroupByRect:function(t){t=this._safeObject(t);var e=this.objects[t.groupId];return e&&!e.isDelete?e:null},_getTempGroupByRect:function(t){if(t=this._safeObject(t),t.tempGroupId)return this.objects[t.tempGroupId];var e=this._getGroupByRect(t);return e&&e.tempGroupId?this.objects[e.tempGroupId]:null},_bindGroup:function(t,e){var o=this;t=this._safeObject(t);var a=new Set,i=new Set;e.forEach((function(t){if(t=o._safeObject(t),!o._checkIsTempGroup(t))if(o._checkIsGroup(t))a.add(t);else{if(t.groupId){var e=o.objects[t.groupId];return i.add(e),void a.add(e)}a.add(t)}}));var n=Array.from(a).sort((function(t,e){return e.tempIndex-t.tempIndex}))[0],r=this.currPage;this._linkedListRemove(r,t),this._linkedListInsertAfter(r,n,t),e.sort((function(t,e){return t.tempIndex-e.tempIndex})).forEach((function(e){e=o._safeObject(e),o._checkIsTempGroup(e)||(o._checkIsGroup(e)?o._removeRectById(e.id):(e.groupId?o._getGroupByRect(e)&&o._linkedListRemove(o.objects[e.groupId],e):o._linkedListRemove(r,e),o._linkedListAppend(t,e),o._commandRectPropUpdate(e,"tempGroupId",""),o._commandRectPropUpdate(e,"groupId",t.id),o._commandRectPropUpdate(e,"parentId",t.id)))})),Array.from(i).forEach((function(t){if(t.id in o.objects&&!o.objects[t.id].isDelete){var e=o._getRectsByGroup(t);e.length<=1?o._unbindGroup(t):(o._commandRectDataPropUpdate(t,"isOpen",!1),o._updateGroupSize(t))}})),this._updateGroupSize(t)},_unbindGroup:function(t){var e=this;t=this._safeObject(t),this._getRectsByGroup(t).forEach((function(o){e._commandRectPropUpdate(o,"groupId",""),e._commandRectPropUpdate(o,"parentId",e.currPageId),e._linkedListRemove(t,o),e._linkedListInsertBefore(e.currPage,t,o)})),this._removeRectById(t.id)},_bindTempGroup:function(t){var e=this;this.tempGroupId||this._commandPropUpdate("tempGroupId",this._createRect("tempGroup").id);var o=this.objects[this.tempGroupId];return t.forEach((function(t){t=e._safeObject(t),e._commandRectPropUpdate(t,"tempGroupId",o.id)})),this._updateRectTempData(o),this._updateGroupSize(o),o},_unbindTempGroup:function(){var t=this;this.tempGroupId&&(this._getRectsByGroup(this.tempGroupId).forEach((function(e){t._commandRectPropUpdate(e,"tempGroupId","");var o=t._getGroupByRect(e);o&&t._commandRectDataPropUpdate(o,"isOpen",!1)})),this._commandRectDelete(this.tempGroupId),this._commandPropUpdate("tempGroupId",""))},_unbindTempGroupSome:function(t){var e=this;if(this.tempGroupId){t.forEach((function(t){e._commandRectPropUpdate(t,"tempGroupId","")}));var o=this._getRectsByGroup(this.currRectId);o.length<=1?this._unbindTempGroup():this._updateGroupSize(this.currRectId)}},_getRectById:function(t){return this.objects[t]},_getTempGroup:function(){return this.objects[this.tempGroupId]},_removeRectById:function(t){var e=this.objects[t],o=this._getGroupByRect(t);if(this._checkIsTempGroup(e)||(e.groupId?o&&this._linkedListRemove(o,this.objects[t]):this._linkedListRemove(this.currPage,this.objects[t])),this._commandRectDelete(t),o){var a=this._getRectsByGroup(o);1===a.length?this._unbindGroup(o):this._updateGroupSize(o)}},_updateGroupSize:function(t){t=this._safeObject(t);var e=this._getGroupSize(t);return this._updateRectData(t,e,!1),e},_getGroupSize:function(t){t=this._safeObject(t);var e=this._getRectsByGroup(t);return St(e,t.data.angle)},_checkIsPage:function(t){return"page"===t.type},_checkIsRectLike:function(t){return 0===t.type.indexOf("rect-")},_checkIsGroupLike:function(t){return"rect-group"===t.type||"rect-tempGroup"===t.type},_checkIsTempGroup:function(t){return"rect-tempGroup"===t.type},_checkIsGroup:function(t){return"rect-group"===t.type},_updateAllRectsTempData:function(){this._getRectsByPageDeep().forEach((function(t){t.tempData=Lt(t.data)}))},_updateRectTempData:function(t){t=this._safeObject(t),this._getRectsByRectDeep(t).forEach((function(t){t.tempData=Lt(t.data)}))},_getRectsByRectDeep:function(t){var e=this;if(!this._checkIsGroupLike(t))return[t];if(this._checkIsGroup(t))return[t].concat(Object(k["a"])(this._getRectsByGroup(t)));if(this._checkIsTempGroup(t)){var o=[t];return this._getRectsByGroup(t).forEach((function(t){o=[].concat(Object(k["a"])(o),[t]),e._checkIsGroup(t)&&(o=[].concat(Object(k["a"])(o),Object(k["a"])(e._getRectsByGroup(t))))})),o}},_updateRectData:function(t,e){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a="rect-line"===t.type;if(a&&"height"in e){var i=Math.max(e.height,1);e["borderWidth"]=e["height"]=i}for(var n in e){var r=e[n];"number"===typeof r&&(r=jt(r)),this._commandRectDataPropUpdate(t,n,r)}if(o){var c=this._getGroupByRect(t);c&&this._updateGroupSize(c);var s=this._getTempGroupByRect(t);s&&this._updateGroupSize(s)}},_updateGroupState:function(t,e){var o=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[];this._getRectsByRectDeep(t).forEach((function(t){var a=t.id;o._checkIsGroup(t)?i.push(a):(t.groupId&&i.push(t.groupId),e(a))})),i.forEach((function(t){a?e(t):o._updateGroupSize(o._getRectById(t))}))},_addSelectedRect:function(t){if(!this._checkIsTempGroup(t)){var e="selectedRects."+t.id;this._commandPropUpdate(e,1)}},_removeSelectedRect:function(t){var e="selectedRects."+t.id;this._commandPropUpdate(e,null),this._unbindTempGroupSome([t])},_clearSelectedRects:function(){this._commandPropUpdate("selectedRects",{}),this._unbindTempGroup()},_updateCurrRectBySelected:function(){var t=this._getUnLockRectsBySelected(),e=t.length;if(e<=1)this._unbindTempGroup(),this._updateCurrRect(this.objects[t[0]]);else{var o=this._bindTempGroup(t);this._updateCurrRect(o)}this._updateAllRectsTempData(),this._updateGuide(),this.mouse.e={}},_getLockRectsBySelected:function(){var t=this;return Object.keys(this.selectedRects).filter((function(e){return t.objects[e].data.isLock}))},_getUnLockRectsBySelected:function(){var t=this;return Object.keys(this.selectedRects).filter((function(e){return!t.objects[e].data.isLock}))},_getSelectedRects:function(){return Object.keys(this.selectedRects)},_focusRect:function(t){var e=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shiftKey:!0},a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i="dblclick"===o.type,n=o.shiftKey,r=this._getGroupByRect(t),c=this._getTempGroupByRect(t),s=this.objects[this.currRectId],h=this.mouse;h.e=o;var d=function(){if(t!==s||n){if(!n||!i){if(i){e._blurRect();var o=r.data.isOpen;return r&&!o&&e._commandRectDataPropUpdate(r,"isOpen",!0),(!r||r&&o)&&e._commandRectDataPropUpdate(t,"isEdit",!0),void e._addSelectedRect(t)}if(n){if(n){if(e._checkIsGroup(t)&&t.data.isOpen)return;r&&!r.data.isOpen&&(t=r),t.id in e.selectedRects?e._removeSelectedRect(t):e._addSelectedRect(t)}}else{if(!r&&!c)return e._blurRect(),e._addSelectedRect(t),void(e._checkIsGroup(t)&&e._commandRectDataPropUpdate(t,"isOpen",!1));if(c)return void e._addSelectedRect(c);if(r){var a=r.data.isOpen;e._blurRect(),a?(e._addSelectedRect(t),e._commandRectDataPropUpdate(r,"isOpen",!0)):e._addSelectedRect(r)}}}}else i&&e._commandRectDataPropUpdate(t,"isEdit",!0)};d(),a&&this._updateCurrRectBySelected()},_blurRect:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._commandPropUpdate("selectedRects",{}),this._hoverOffRect();var e=this.objects[this.currRectId];if(e&&(this._commandPropUpdate("currRectId",""),this._checkIsTempGroup(e)?this._unbindTempGroup(e):this._commandRectDataPropUpdate(e,"isEdit",!1),t)){var o=this._getGroupByRect(e);o&&this._commandRectDataPropUpdate(o,"isOpen",!1)}},_hoverRect:function(t){if(t=this._safeObject(t),!this.mouse.ing){var e=t,o=this._getGroupByRect(t);o&&!o.data.isOpen&&(e=o),this._checkIsGroup(t)&&t.data.isOpen&&(e=null),this._commandPropUpdate("hoverRectId",e?e.id:"")}},_hoverOffRect:function(){this._commandPropUpdate("hoverRectId","")},_getMousePoint:function(t){var e=document.querySelector(".proto-middle");return{left:t.clientX+e.scrollLeft-Ut,top:t.clientY+e.scrollTop-Et}},_getRectBaseJsxProps:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;t=this._safeObject(t);var o=t.data,a=o.opacity/100;if(t.groupId){var i=this.objects[t.groupId].data.opacity/100;a*=i}return a=jt(a,2),{style_left:jt(o.left*e,0)+"px",style_top:jt(o.top*e,0)+"px",style_width:jt(o.width*e,0)+"px",style_height:jt(o.height*e,0)+"px","style_z-index":o.zIndex,style_transform:"rotate(".concat(o.angle,"deg)"),style_opacity:a}},_updateCurrPage:function(t){t=this._safeObject(t),this._commandPropUpdate("currPageId",t.id),this._commandObjectPropUpdate(this.currProject,"currPageId",t.id),this._updateCurrRect()},_updateCurrRect:function(t){t=this._safeObject(t),this._commandPropUpdate("currRectId",t?t.id:"")},_updateHoverRect:function(t){t=this._safeObject(t),this._commandPropUpdate("hoverRectId",t?t.id:"")},_flashHandler:function(){var t=this;this._commandPropUpdate("handler.show",!1),clearTimeout(this.handler.timer),this.handler.timer=setTimeout((function(){t._commandPropUpdate("handler.show",!0)}),1e3)},_getCircleSize:function(){var t=this.mouse,e=Math.min(t.startLeft,t.currLeft),o=Math.min(t.startTop,t.currTop),a=Math.abs(t.currLeft-t.startLeft),i=Math.abs(t.currTop-t.startTop);return{left:e,top:o,width:a,height:i,right:e+a,bottom:o+i,angle:0}},_walkCurrPageRects:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._linkedListWalk(this.currPage,"rects",t,e)},_focusRectWhenCircle:function(){var t=this;if(this.currPage){var e=this._getCircleSize();e=Lt(Object(d["a"])({},e,{angle:0})),this._walkCurrPageRects((function(o){yt(Lt(o.data,t.scale),e)&&t._focusRect(o,{shiftKey:!0},!1)})),this._updateCurrRectBySelected()}},_showContextmenu:function(t,e){var o=this,a=0,i=[],n=[];"rect-item"===e?(a=310,i=["rect-重命名","rect-剪切","rect-复制","rect-删除",null,"rect-锁定","rect-解锁",null,"rect-置顶","rect-置底"]):"rect"===e?(a=340,i=["rect-剪切","rect-复制","rect-粘贴","rect-删除",null,"rect-锁定","rect-解锁",null,"rect-组合","rect-打散",null,"rect-置顶","rect-置底"]):"page"===e?(a=200,i=["page-重命名","page-新建子页面","page-删除"]):"canvas"===e&&(a=40,i=["rect-粘贴"]),n=i.map((function(t){return t?Object(d["a"])({},o._actionGet(t),{context:o}):t})),this.$contextmenu(t,a,n)},_updateCurrRectOpacity:function(t){var e=this;this._checkIsTempGroup(this.currRect)&&this._getRectsByGroup(this.currRect).forEach((function(o){e._commandRectDataPropUpdate(o,"opacity",t)})),this._commandRectDataPropUpdate(this.currRect,"opacity",t)}}}),yo=o("6dd6"),jo={data:function(){return{guide:{line:{top:new Set,left:new Set},show:{top:new Set,left:new Set}}}},methods:{_updateGuide:function(){var t=this,e=this.currRectId,o=this.objects[e];this._clearGuideLine(),this._getRectsByPageDeep().forEach((function(a){var i=a.id,n=a.groupId,r=a.tempGroupId;if(i!==e&&n!==e&&r!==e&&(!t._checkIsGroup(a)||!t._getRectsByGroup(a).includes(o))&&(!n||t._getRectById(n).tempGroupId!==e)){var c=a.tempData;t.guide.line.left.add(c.rotateLeftTop.left).add(c.rotateRightTop.left).add(c.rotateRightBottom.left).add(c.rotateLeftBottom.left).add(c.center.left),t.guide.line.top.add(c.rotateLeftTop.top).add(c.rotateRightTop.top).add(c.rotateRightBottom.top).add(c.rotateLeftBottom.top).add(c.center.top)}}))},_checkRectPointGuide:function(t,e,o,a){var i=5,n=this.guide.line.left,r=this.guide.line.top,c=this.guide.show.left,s=this.guide.show.top,h=t.tempData,d=Lt(t.data),p=d[e.name],u=h[e.name],l=!1,f={left:jt(u.left+o),top:jt(u.top+a)},_=function(t,e){var o,a=Object(yo["a"])(t);try{for(a.s();!(o=a.n()).done;){var i=o.value;if(Math.abs(i-e)<=1)return{isIn:!0,value:i-e}}}catch(n){a.e(n)}finally{a.f()}return{isIn:!1,value:0}};if(e.left){var m=_(n,p.left);m.isIn&&(Math.abs(f.left-p.left)<=i&&(o=p.left-u.left+m.value,l=!0),c.add(p.left+m.value))}if(e.top){var v=_(r,p.top);v.isIn&&(Math.abs(f.top-p.top)<=i&&(a=p.top-u.top+v.value,l=!0),s.add(p.top+v.value))}return[o,a,l]},_checkGuideOnMove:function(t,e,o){var a=this;return this._clearGuideShow(),["rotateLeftTop","rotateRightTop","rotateRightBottom","rotateLeftBottom","center"].forEach((function(i){var n={name:i,top:!0,left:!0},r=a._checkRectPointGuide(t,n,e,o),c=Object(dt["a"])(r,2);e=c[0],o=c[1]})),[e,o]},_checkGuideOnResize:function(t,e,o,a){this._clearGuideShow();var i=t.data.angle;if(0===i){var n={a:{name:"rotateLeftTop",left:!0,top:!0},b:{name:"rotateRightTop",left:!0,top:!0},c:{name:"rotateRightBottom",left:!0,top:!0},d:{name:"rotateLeftBottom",left:!0,top:!0},ab:{name:"rotateLeftTop",left:!1,top:!0},bc:{name:"rotateRightTop",left:!0,top:!1},cd:{name:"rotateRightBottom",left:!1,top:!0},ad:{name:"rotateLeftBottom",left:!0,top:!1}}[e],r=this._checkRectPointGuide(t,n,o,a),c=Object(dt["a"])(r,2);o=c[0],a=c[1]}return[o,a]},_checkGuideOnRotate:function(t,e,o,a){var i=5;return e%90===0&&(Math.abs(o-e)<=i&&(a=e-t),0===e&&Math.abs(o-360)<=i&&(a=e-t)),a},_clearGuideLine:function(){this.guide.line.left=new Set,this.guide.line.top=new Set},_clearGuideShow:function(){this.guide.show.left=new Set,this.guide.show.top=new Set}}},Io={data:function(){var t=this,e=this;return{actionMap:{"rect-重命名":{checkF:"_actionCanCurrRect",doF:function(){e._commandRectDataPropUpdate(t.objects[t.currRectId],"isNameEdit",!0)}},"rect-全选":{doF:"_actionRectSelectAll",hotkey:"command + a"},"rect-剪切":{checkF:"_actionCanCurrRect",doF:"_actionRectCut",hotkey:"command + x"},"rect-复制":{checkF:"_actionCanCurrRect",doF:"_actionRectCopy",hotkey:"command + c"},"rect-粘贴":{checkF:"_actionCanRectPaste",doF:"_actionRectPaste",hotkey:"command + v"},"rect-删除":{checkF:"_actionCanCurrRect",doF:"_actionRectDelete",hotkey:"backspace"},"rect-锁定":{checkF:"_actionCanRectLock",doF:"_actionRectLock",hotkey:"command + l"},"rect-解锁":{checkF:"_actionCanRectUnLock",doF:"_actionRectUnLock",hotkey:"command + shift + l"},"rect-组合":{checkF:"_actionCanGroup",doF:"_actionGroup",hotkey:"command + g"},"rect-打散":{checkF:"_actionCanUnGroup",doF:"_actionUnGroup",hotkey:"command + shift + g"},"rect-上移":{checkF:"_actionCanCurrRect",doF:"_actionRectMoveUp",hotkey:"command + alt + up"},"rect-下移":{checkF:"_actionCanCurrRect",doF:"_actionRectMoveDown",hotkey:"command + alt + down"},"rect-置顶":{checkF:"_actionCanCurrRect",doF:"_actionRectMoveTop",hotkey:"command + shift + up"},"rect-置底":{checkF:"_actionCanCurrRect",doF:"_actionRectMoveBottom",hotkey:"command + shift + down"},"rect-keyupMove":{checkF:"_actionCanCurrRect",doF:"_actionRectKeyupMove",hotkey:"up"},"rect-keydownMove":{checkF:"_actionCanCurrRect",doF:"_actionRectKeydownMove",hotkey:"down"},"rect-keyleftMove":{checkF:"_actionCanCurrRect",doF:"_actionRectKeyleftMove",hotkey:"left"},"rect-keyrightMove":{checkF:"_actionCanCurrRect",doF:"_actionRectKeyrightMove",hotkey:"right"},"page-重命名":{checkF:"",doF:function(){e._commandObjectDataPropUpdate(e.currPage,"isNameEdit",!0)}},"page-新建子页面":{checkF:"",doF:function(){e._actionPageCreate(e.currPage.id)}},"page-删除":{checkF:"",doF:"_actionPageDelete"},"sys-撤销":{checkF:function(){return!e.mouse.ing&&e._historyCanBack()},doF:"_historyBack",hotkey:"command + z"},"sys-重做":{checkF:function(){return!e.mouse.ing&&e._historyCanGo()},doF:"_historyGo",hotkey:"command + shift + z"}}}},methods:{_actionGetInfo:function(){var t=this.objects[this.currRectId],e=t&&this._checkIsTempGroup(t),o=t&&this._checkIsGroup(t);return{rect:t,isTempGroup:e,isGroup:o}},_actionPageCreate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currProjectId,e=this._createPage(t);this._commandObjectDataPropUpdate(e,"isNameEdit",!0),this._updateCurrPage(e),this._historyPush()},_actionPageDelete:function(){this._removePage(),this._historyPush()},_actionRectKeyupMove:function(){this._updateRectTempData(this.currRectId),this._move(this.currRectId,0,-1,!1),this._historyPush()},_actionRectKeydownMove:function(){this._updateRectTempData(this.currRectId),this._move(this.currRectId,0,1,!1),this._historyPush()},_actionRectKeyleftMove:function(){this._updateRectTempData(this.currRectId),this._move(this.currRectId,-1,0,!1),this._historyPush()},_actionRectKeyrightMove:function(){this._updateRectTempData(this.currRectId),this._move(this.currRectId,1,0,!1),this._historyPush()},_actionRectSelectAll:function(){var t=this;this._blurRect(),this._walkCurrPageRects((function(e){t._focusRect(e,{shiftKey:!0},!1)})),this._updateCurrRectBySelected()},_actionCanGroup:function(){return this._actionGetInfo().isTempGroup},_actionGroup:function(){var t=this,e=this.objects[this.currRectId],o=this._createRect("group"),a=this._getRectsByRectDeep(e);this._bindGroup(o,a),a.forEach((function(e){t._removeSelectedRect(e)})),this._addSelectedRect(o),this._updateCurrRectBySelected(),this._historyPush()},_actionCanUnGroup:function(){return this._actionGetInfo().isGroup},_actionUnGroup:function(){var t=this,e=this.objects[this.currRectId],o=this._getRectsByRectDeep(e);this._unbindGroup(e),o.forEach((function(e){t._addSelectedRect(e)})),this._removeSelectedRect(e),this._updateCurrRectBySelected(),this._historyPush()},_actionRectDelete:function(){var t=this,e=this.objects[this.currRectId];this._getRectsByRectDeep(e).forEach((function(e){t._removeRectById(e.id)})),this._updateCurrRect(),this._historyPush()},_actionRectCopy:function(){var t=this;this._commandPropUpdate("clipboard.count",0),this._commandPropUpdate("clipboard.data",this._getUnLockRectsBySelected().map((function(e){return t._cloneRectDeep(e)})))},_actionRectCut:function(){this._actionRectCopy(),this._actionRectDelete()},_actionCanRectPaste:function(){return this.clipboard.data.length>0},_actionRectPaste:function(){var t=this,e=++this.clipboard.count,o=20*e;this._clearSelectedRects(),this.clipboard.data.map((function(e){var o=t._createRectByConfig(e);return t._addSelectedRect(o),o})),this._updateCurrRectBySelected(),this._updateRectTempData(this.currRectId),this._move(this.currRectId,o,o),this._clearGuideShow(),this._historyPush()},_actionCanCurrRect:function(){return this.currRectId},_actionRectMoveUp:function(){var t=this,e=[];e=this.tempGroupId?this._getRectsByGroup(this.currRectId):[this.objects[this.currRectId]],e.forEach((function(e){var o=t.objects[e.parentId];t._linkedListMoveUp(o,e)})),this._historyPush()},_actionRectMoveDown:function(){var t=this,e=[];e=this.tempGroupId?this._getRectsByGroup(this.currRectId):[this.objects[this.currRectId]],e.forEach((function(e){var o=t.objects[e.parentId];t._linkedListMoveDown(o,e)})),this._historyPush()},_actionRectMoveTop:function(){var t=this,e=[];e=this.tempGroupId?this._getRectsByGroup(this.currRectId):[this.objects[this.currRectId]],e.forEach((function(e){var o=t.objects[e.parentId];t._linkedListMoveTop(o,e)})),this._historyPush()},_actionRectMoveBottom:function(){var t=this,e=[];e=this.tempGroupId?this._getRectsByGroup(this.currRectId):[this.objects[this.currRectId]],e.forEach((function(e){var o=t.objects[e.parentId];t._linkedListMoveBottom(o,e)})),this._historyPush()},_actionCanRectLock:function(){return this._getUnLockRectsBySelected().length},_actionCanRectUnLock:function(){return this._getLockRectsBySelected().length},_actionRectLock:function(){for(var t in this.selectedRects)t=this._safeObject(t),this._commandRectDataPropUpdate(t,"isLock",!0);this._updateCurrRectBySelected(),this._historyPush()},_actionRectUnLock:function(){for(var t in this.selectedRects)t=this._safeObject(t),this._commandRectDataPropUpdate(t,"isLock",!1);this._updateCurrRectBySelected(),this._historyPush()},_actionCanRectAlign:function(){return this._actionGetInfo().isTempGroup},_actionRectAlignLeft:function(){var t=this;this._updateRectTempData(this.currRect);var e=this.currRect.tempData.left;this._getRectsByGroup(this.currRect).forEach((function(o){var a=e-o.tempData.minRotateLeft;t._move(o,a,0,!1)})),this._updateGroupSize(this.currRect)},_actionRectAlignLeftRight:function(){var t=this;this._updateRectTempData(this.currRect);var e=this.currRect.tempData.center.left;this._getRectsByGroup(this.currRect).forEach((function(o){var a=e-o.tempData.center.left;t._move(o,a,0,!1)})),this._updateGroupSize(this.currRect)},_actionRectAlignRight:function(){var t=this;this._updateRectTempData(this.currRect);var e=this.currRect.tempData.right;this._getRectsByGroup(this.currRect).forEach((function(o){var a=e-o.tempData.maxRotateLeft;t._move(o,a,0,!1)})),this._updateGroupSize(this.currRect)},_actionRectAlignTop:function(){var t=this;this._updateRectTempData(this.currRect);var e=this.currRect.tempData.top;this._getRectsByGroup(this.currRect).forEach((function(o){var a=e-o.tempData.minRotateTop;t._move(o,0,a,!1)})),this._updateGroupSize(this.currRect)},_actionRectAlignTopBottom:function(){var t=this;this._updateRectTempData(this.currRect);var e=this.currRect.tempData.center.top;this._getRectsByGroup(this.currRect).forEach((function(o){var a=e-o.tempData.center.top;t._move(o,0,a,!1)})),this._updateGroupSize(this.currRect)},_actionRectAlignBottom:function(){var t=this;this._updateRectTempData(this.currRect);var e=this.currRect.tempData.bottom;this._getRectsByGroup(this.currRect).forEach((function(o){var a=e-o.tempData.maxRotateTop;t._move(o,0,a,!1)})),this._updateGroupSize(this.currRect)},_actionCanRectEqualSpace:function(){var t=this._actionGetInfo().isTempGroup;if(!t)return!1;var e=this._getRectsByGroup(this.currRect);return e.length>2},_actionRectEqualSpaceX:function(){var t=this,e=this.currRect.data.width,o=this._getRectsByGroup(this.currRect),a=0;o.forEach((function(t){a+=t.tempData.maxRotateLeft-t.tempData.minRotateLeft}));var i=(e-a)/(o.length-1),n=o.sort((function(t,e){return t.tempData.minRotateLeft-e.tempData.minRotateLeft}));n.slice(0).forEach((function(e,o){if(0!==o){var a=n[o-1].tempData.maxRotateLeft+i-e.tempData.minRotateLeft;t._move(e,a,0,!1),t._updateRectTempData(e)}})),this._updateGroupSize(this.currRect)},_actionRectEqualSpaceY:function(){var t=this,e=this.currRect.data.height,o=this._getRectsByGroup(this.currRect),a=0;o.forEach((function(t){a+=t.tempData.maxRotateTop-t.tempData.minRotateTop}));var i=(e-a)/(o.length-1),n=o.sort((function(t,e){return t.tempData.minRotateTop-e.tempData.minRotateTop}));n.slice(0).forEach((function(e,o){if(0!==o){var a=n[o-1].tempData.maxRotateTop+i-e.tempData.minRotateTop;t._move(e,0,a,!1),t._updateRectTempData(e)}})),this._updateGroupSize(this.currRect)},_actionGet:function(t){var e=this.actionMap[t],o=e.checkF||function(){return!0};"string"===typeof o&&(o=this[o]);var a=e.doF||function(){};"string"===typeof a&&(a=this[a]);var i=t.split("-")[1]||"unknow";return Object(d["a"])({},e,{doF:a,checkF:o,text:i})},_actionSetHotKey:function(){var t=this,e=function(e){var o=t._actionGet(e),a=o.checkF,i=o.doF,n=o.hotkey;n&&t._hotkey(n,(function(e){a.call(t)&&(e.preventDefault(),i.call(t))}))};for(var o in this.actionMap)e(o)}},mounted:function(){this._actionSetHotKey()}},Po={methods:{},created:function(){var t=this,e=this,o=this.mouse,a=function(t){f.$emit("windowMouseDown",t)},i=function(a){var i=t.objects[t.currRectId];if(o.ing){o.e=a;var n=t.scale,r=t._getMousePoint(a),c=o.currLeft=r.left,s=o.currTop=r.top,h=o.eventType,d=(c-o.startLeft)/n,p=(s-o.startTop)/n;if("resize"===h)e._resize(d,p);else if("rotate"===h){var u={left:o.currLeft,top:o.currTop};e._rotate(u)}else if("move"===h)e._move(i,d,p);else if("create"===h&&a.clientX>Ut&&a.clientY>Et){var l=o.createType,f=t.rectConfig[l],_=t._createRect(l);t._updateRectTempData(_),t._moveTo(_,jt(c-f.width/2),jt(s-f.height/2)),o.eventType="move",o.startLeft=c,o.startTop=s,e._focusRect(_,a)}}},n=function(){o.ing&&("circle"===o.eventType&&t._focusRectWhenCircle(),o.ing=!1,o.eventType="",o.e={},t._clearGuideShow(),t._historyPush())};this.windowEventAdd("mousedown",a),this.windowEventAdd("mousemove",i),this.windowEventAdd("mouseup",n),this.windowEventAdd("contextmenu",(function(t){t.preventDefault()})),f.$on("windowMouseDown",(function(e){var a=t._getMousePoint(e);o.startLeft=o.currLeft=a.left,o.startTop=o.currTop=a.top,t.currRectId||"move"!==t.mouse.eventType?o.ing=!0:o.ing=!1}))},mounted:function(){var t=this,e=this.$refs.middle;e.addEventListener("scroll",(function(){t._renderRule()}))}},ko=(o("34b9"),o("cc6e"),"undefined"!==typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0),Oo={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,"⇪":20,",":188,".":190,"/":191,"`":192,"-":ko?173:189,"=":ko?61:187,";":ko?59:186,"'":222,"[":219,"]":221,"\\":220},xo={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},wo=function(t){return"number"===typeof t?t:(t=t.trim(),Oo[t.toLowerCase()]||xo[t.toLowerCase()]||t.toUpperCase().charCodeAt(0))},Go={data:function(){return{hotkey:{data:{},disabled:!1}}},methods:{_hotkey:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this.hotkey.data[this._hotkeyCode(t.split("+"))]={hotkey:t,keydown:e,keyup:o}},_hotkeyOff:function(){this.hotkey.disabled=!0},_hotkeyOn:function(){this.hotkey.disabled=!1},_hotkeyCode:function(t){return t.map((function(t){return wo(t)})).sort().join("+")},_hotkeyEvent:function(t){if("input"!==t.target.tagName.toLowerCase()&&!this.hotkey.disabled){var e={ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey,command:t.metaKey},o=[];for(var a in e)e[a]&&o.push(a);var i=t.type,n=this._hotkeyCode([t.keyCode].concat(o));if(n in this.hotkey.data){var r=this.hotkey.data[n];r[i](t)}}}},mounted:function(){var t=this;this.windowEventAdd("keydown",(function(e){t._hotkeyEvent(e)}))}},Mo={methods:{_onPageShow:function(){},_onPageHide:function(){}},watch:{$route:function(t,e){t.path===e.path?this._onPageShow():this._onPageHide()}},mounted:function(){this._onPageShow()},beforeDestroy:function(){this._onPageHide()}},To={name:"design",mixins:[ht,ue,le,fe,bo,Ro,jo,H,$,Io,ot,at,Po,Go,Mo],methods:{},render:function(t){return this.renderHook,this._renderMain(t)}},Do=To,Lo=(o("9a8d"),Object(j["a"])(Do,Ht,$t,!1,null,null,null)),So=Lo.exports;s["a"].use(A),s["a"].use(h["a"]),s["a"].component("v-icon",F["a"]),s["a"].config.productionTip=!1;var Bo=[{path:"/",component:So,name:"design"}],Co=new h["a"]({routes:Bo});new s["a"]({router:Co}).$mount("#app")},"7eba":function(t,e,o){},"8ef3":function(t,e,o){},"9a8d":function(t,e,o){"use strict";var a=o("8ef3"),i=o.n(a);i.a},ec8e:function(t,e,o){}});
//# sourceMappingURL=app.5b98a8fd.js.map